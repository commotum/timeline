                             Recurrent models typically factor computation along the symbol positions of the input and output
                             sequences. Aligning the positions to steps in computation time, they generate a sequence of hidden
                             states h , as a function of the previous hidden state h     and the input for position t. This inherently
                                     t                                              t−1
                             sequential nature precludes parallelization within training examples, which becomes critical at longer
                             sequence lengths, as memory constraints limit batching across examples. Recent work has achieved
                             signiﬁcant improvements in computational efﬁciency through factorization tricks [18] and conditional
                             computation [26], while also improving model performance in case of the latter. The fundamental
                             constraint of sequential computation, however, remains.
                             Attention mechanisms have become an integral part of compelling sequence modeling and transduc-
                             tion models in various tasks, allowing modeling of dependencies without regard to their distance in
                             the input or output sequences [2, 16]. In all but a few cases [22], however, such attention mechanisms
                             are used in conjunction with a recurrent network.
                             In this work we propose the Transformer, a model architecture eschewing recurrence and instead
                             relying entirely on an attention mechanism to draw global dependencies between input and output.
                             TheTransformer allows for signiﬁcantly more parallelization and can reach a new state of the art in
                             translation quality after being trained for as little as twelve hours on eight P100 GPUs.
                             2    Background
                             Thegoal of reducing sequential computation also forms the foundation of the Extended Neural GPU
                             [20], ByteNet [15] and ConvS2S [8], all of which use convolutional neural networks as basic building
                             block, computing hidden representations in parallel for all input and output positions. In these models,
                             the number of operations required to relate signals from two arbitrary input or output positions grows
                             in the distance between positions, linearly for ConvS2S and logarithmically for ByteNet. This makes
                             it more difﬁcult to learn dependencies between distant positions [11]. In the Transformer this is
                             reduced to a constant number of operations, albeit at the cost of reduced effective resolution due
                             to averaging attention-weighted positions, an effect we counteract with Multi-Head Attention as
                             described in section 3.2.
                             Self-attention, sometimes called intra-attention is an attention mechanism relating different positions
                             of a single sequence in order to compute a representation of the sequence. Self-attention has been
                             used successfully in a variety of tasks including reading comprehension, abstractive summarization,
                             textual entailment and learning task-independent sentence representations [4, 22, 23, 19].
                             End-to-end memory networks are based on a recurrent attention mechanism instead of sequence-
                             aligned recurrence and have been shown to perform well on simple-language question answering and
                             language modeling tasks [28].
                             To the best of our knowledge, however, the Transformer is the ﬁrst transduction model relying
                             entirely on self-attention to compute representations of its input and output without using sequence-
                             aligned RNNs or convolution. In the following sections, we will describe the Transformer, motivate
                             self-attention and discuss its advantages over models such as [14, 15] and [8].
                             3    ModelArchitecture
                             Mostcompetitive neural sequence transduction models have an encoder-decoder structure [5, 2, 29].
                             Here, the encoder maps an input sequence of symbol representations (x1,...,xn) to a sequence
                             of continuous representations z = (z ,...,z ). Given z, the decoder then generates an output
                                                                       1      n
                             sequence (y1,...,ym) of symbols one element at a time. At each step the model is auto-regressive
                             [9], consuming the previously generated symbols as additional input when generating the next.
                             TheTransformer follows this overall architecture using stacked self-attention and point-wise, fully
                             connected layers for both the encoder and decoder, shown in the left and right halves of Figure 1,
                             respectively.
                             3.1   EncoderandDecoderStacks
                             Encoder:     The encoder is composed of a stack of N = 6 identical layers. Each layer has two
                             sub-layers. The ﬁrst is a multi-head self-attention mechanism, and the second is a simple, position-
                                                                                 2
