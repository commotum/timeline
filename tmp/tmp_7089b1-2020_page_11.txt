                A
                B                                                     C
                    semicircle(r)                                         radial symmetry(n,body)
                         circle(r)
                       spiral(dθ)
                  greek spiral(n)
                       s-curve(r)
                   polygon(n,`)
                D                                      E
             Figure 4: (A): 30 (out of 160) LOGO graphics tasks. The model writes programs controlling a ‘pen’
             that draws the target picture. (B-C): Example learned library routines include both parametric routines
             for drawing families of curves (B) as well as primitives that take entire programs as input (C). Each row
             in B shows the same code executed with different parameters. Each image in C shows the same code
             executed with different parameters and a different subprogram as input. (D-E): Dreams, or programs
             sampled by randomly assembling functions from the model’s library, change dramatically over the
             course of learning reﬂecting learned expertise. Before learning (D) dreams can use only a few simple
             drawing routines and are largely unstructured; the majority are simple line segments. After twenty
             iterations of wake-sleep learning (E) dreams become more complex by recombining learned library
             concepts in ways never seen in the training tasks. Dreams are sampled from the prior learned over
             tasks solved during waking, and provide an inﬁnite stream of data for training the neural recognition
             model. Color shows the model’s drawing trajectory, from start (blue) to ﬁnish (pink). Panels (D-E)
             illustrate the most interesting dreams found across ﬁve runs, both before and after learning. Fig. S6
             shows 150 random dreams at each stage.        11
