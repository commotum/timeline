                    Pan et al.                                                                                                                                                        7
                                                                                                                                    2d       x x + y y
                                                                                                                                             jjjj
                    transform the unidirectional and one-dimensional decay                                                        D =g n m              n  m                        ð6Þ
                                                                                                                                    nm
                    observed in retention into bidirectional and 2D spatial decay
                    (shown in equation (6)). This spatial decay introduces an                           and then the RSCA can be presented as
                    explicit spatial prior linked to Manhattan distance into the                                                        
                                                                                                                                                         T       2d
                    vision backbone.                                                                                    MaSAðÞX = SoftmaxðÞQK               D V                    ð7Þ
                                                                                                        wherein, the K and V matrix are generated according to the
                        MSAdecomposition. The Manhattan attention mechanism                             ground true of nuScenes LiDAR point cloud.
                    utilizes the Manhattan distance between pixels in an image as                           Global attention mechanisms are known for their ability
                    its  guiding metric, preferentially allocating higher decay                         to capture comprehensive information across an entire data
                    weights to pixels further from a focal pixel. This approach                         set. However, this capability comes at the cost of significant
                    expands the one-dimensional sequence decay found within                             computational overhead. Research has indicated that while
                    the Retentive Network into a 2D format by applying it across                        sparse attention mechanisms attempt to mitigate this issue,
                    both the horizontal and vertical axes of the image, thereby                         they inadvertently disrupt the spatial decay matrices governed
                    creating a 2D spatial decay matrix. This matrix serves as a                         by Manhattan distances (Dong et al., 2022; Hassani et al.,
                    spatial prior, informing the query process within the self-                         2023; Wang et al., 2021a; Yang et al., 2021), thereby eliminat-
                    attention framework. Moreover, Manhattan attention facili-                          ing the utility of spatial priors. In response, our approach
                    tates the decomposition of this spatial decay matrix along the                      involves calculating the MaSA scores independently along the
                    image’s horizontal and vertical planes. This strategic decom-                       image’s vertical and horizontal axes. These scores are then
                    position enables the preservation of the receptive field’s                          integrated with bidirectional decay matrices specific to each
                    dimensions while simultaneously optimizing the computa-                             axis (i.e. one-dimensional decay matrices that quantify the
                    tional efficiency of the attention mechanism during both                            horizontal and vertical distances between tokens, represented
                    training and inference phases. The concept of bidirectional                               2d       jx x j+jy y j
                                                                                                        as D     =g n m           n  m ). As Figure 2 shows, the process is
                    2D decay, as an extension of the retentive mechanism’s one-                               nm
                                                                                                        outlined as follows
                    dimensional sequence decay, is articulated through
                                                                                                                                                   
                                                                                                                                    H                  H T          H
                                                                                                                             Attn =Softmax Q K               D
                                       BiRetentionðÞX = QKT                Bi                                                                      
                                                                      D V                                                         W                   W T          W
                                                       Bi       jjnm                           ð5Þ                           Attn    =Softmax Q K             D                   ð8Þ
                                                     D =g                                                                                       
                                                       nm                                                                                     H        W     T
                                                                                                                         MaSAðÞX =Attn Attn V
                    wherein, QKT represents the standard dot product in the self-
                    attention mechanism, where Q (Query) and K (Key) are the
                    matrices derived from the input features. The dot product                           2D-to-3D transform: RSCA. In models for 3D object detec-
                    captures the similarity between different elements within the                       tion involving inputs from multiple cameras, the scale of
                                                  Bi
                    feature space. And D            is the Hadamard product (element-                  inputs is large due to the inclusion of views from Nview cam-
                    wise multiplication) between the dot product QKT and the                            eras. Directly applying a conventional multi-head attention
                                                          Bi                    Bi
                    bidirectional decay matrix D . This matrix D                    incorporates        mechanism to model this vast global information could lead
                    the Manhattan distance-based decay, which adjusts the atten-                        to prohibitive computational costs. To mitigate this, we have
                    tion weights based on the spatial distance between pixels. The                      crafted a spatial feature aggregation module within the
                    decay matrix introduces a spatial prior that biases the atten-                      RetentiveBEV model, leveraging the principles of retentive’s
                    tion toward specific regions, depending on their distance from                      spatial decay (done by MaSA) and Manhattan attention
                    a reference point. The value matrix V in the self-attention                         decomposition. This module enables each BEV query vector
                    mechanism, which holds the actual information that will be                          to engage with the relevant section of the camera image’s
                    weighted and aggregated based on the calculated attention                           ROI, taking into account the decay weights applicable to that
                    scores. DBi represents the matrix multiplication that applies                      section. The methodology unfolds as follows:
                    the spatially decayed attention weights to the value matrix V,
                    generating the final output of the attention mechanism. The                                 Initially, the BEV query vectors are projected onto a
                              nm
                             jj
                    term g          indicates the decay factor, where jjn  m is the                             pillar-shaped region on the BEV plane. From this
                    Manhattan distance between two points, modulating the                                        region, a set number of reference points (N                3Drefer-
                    influence of one point on another in the final attention                                                                                            ref
                                                                                                                 ence points) are selected, each accumulating spatial
                    output.                                                                                      features from its vicinity. The surrounding spatial fea-
                                                                                                                 tures of each reference point are then mapped to the
                        RSCA. In scenarios where images are divided into numer-                                  image coordinate system via the camera’s intrinsic and
                    ous non-overlapping pixels, these segments undergo position                                  extrinsic matrices.
                    encoding and linear transformation to be individually con-                                  If the projection of a reference point lands within the
                    verted into vector representations, known as tokens, which                                   view of any of the Nview cameras, this particular view
                    represents our ROI. Derived from the MaSA Decomposition,                                     is designated as Vhit.
                    we assuming the location of a specific token within the image                               Upon mapping the reference points’ spatial coordi-
                    is denoted by coordinates (xn,yn), and then the bidirectional                                nates to 2D coordinates in the image coordinate sys-
                    decay factor for this token, in relation to the vector represen-                             tem, these 2D points become the reference for query
                    tations of other pixel tokens, can be described as                                           Qp. Features are extracted from the vicinity of these
