                                 10.9.  ONE  MORE  COMBINATORIAL INTERPRETATION                           335
              where the sum is taken over all pairs of disjoint subsets А, В C {1, 2, ,  n}, and d 
              is some constant factor to be chosen later.  Note that the sum also includes log \X\ 
              (obtained for A = 0 , В = {1, 2,..., n}).  All the elements of some part have equal 
              weights.
                   Let us show that for large enough d the number of parts in the minimal weight 
              partition is small.  Namely, we show that the total weight decreases when we com­
              bine two parts with almost equal parameters into one part.  “Almost equal” means 
              that the values of log mx (В | A) for the two part differ at most by 1 (for every A and 
              В).  Indeed,  the value of mx{B\A) for the combined part is at most three times 
              bigger than the same value for each of the parts, and the value of \X\ is multiplied 
              at  least  by  factor  1.5.  For  large  enough d the increase  in  |X|  will  outweigh the 
              possible decrease in all the mx(B\A).  Note that the suitable value of d depends 
              only on the number of terms in the sum  (and the latter is determined by n and 
              does not depend on the size of the set).
                   So  let  us  assume  that  d  is  chosen  in  this  way.   Now we classify  the  parts 
              according to the integer parts of \ogmx{B\A) for all A and B.  As we have seen, 
              for every tuple of integers there is at most one part,  and the number of possible 
              tuples  is  bounded  by  a polynomial  in  log|A|,  and  the  latter is  bounded  by  the 
              log-size of the set to be partitioned, so we get the desired bound for the number of 
              parts.
                   It remains to show that in minimal weight partitions, all the parts are almost 
              uniform.  To achieve this, we show that a non-uniform part can be split in such a 
              way that the total weight decreases.  While splitting some part, we do not change 
              the weights of the elements of the other parts, so we can concentrate on the weights 
              inside the non-uniform part.  Consider the formula that defines the weight, i.e.,
                                             ^T\ogmx(B\ A) - dlog|A|.
                                             а ,в
              When the part is split, for each of its points all the terms in this expression (both 
              with plus and minus signs) decrease.  We need that the decrease in the plus-part is 
              bigger that in the minus-part.  The latter can be computed easily:  If a part contains 
              m elements and is split into two parts of size pm and qm (where p + q = 1), then 
              the subtracted term (for all m elements altogether) decreases by dmh(p,q), where 
              h(p, q) — v{— logp) + <?(— logg) is the Shannon entropy of a random variable with 
              probabilities p and q,  and it does not exceed 1.  So the decrease  (per element)  in 
              the negative part is at most d.
                   If the part  (that we try to split)  is very non-uniform,  there exist sets A and 
              В such that m(A U В) significantly exceeds m(A) • m(B| A).  This means that the 
              AuB-projection has В-sections of very different sizes, and the maximal one exceeds 
              the average one by some large factor I.  We then split this projection (and therefore 
              the  entire  part)  into  two  pieces,  using  the  geometric  mean  between  the  average 
              and maximal size as a threshold.  For the piece with small sections the maximal 
              size is now y/l times smaller.  On the other hand, the large sections form at most 
              l/\//-fraction of all the sections (Chebyshev inequality), so for the other piece the 
              size of the А-projection also decreases at least by factor y/l.
                   So  the splitting reduces  at  least  one positive  term  (for  both pieces)  at  least 
              by logy/l (and other positive terms do not increase, as we have mentioned).  So if 
              I  is  large enough  (log y/l >  d),  the total weight decreases.  We conclude that the
