                             13.3.  SOME  FORMULAS  AND THEIR COMPLEXITY              405
            Ф(Х, Y,...) is bounded by a constant (depending on Ф but not on X,7,...).  More­
            over,  there exists  a string s  that  is  a solution to the problem  Ф(Х, Y,...)  for all 
            X, Y,....  This was shown essentially by Kleene by simple induction on the length of 
            the derivation of Ф(р, q...).  For example, assume that Ф (p,q...) is the IPC axiom 
           p —> (q —»■ p).  Then s is the program  “transform a given string x into a program 
           that outputs x for every input”.
                340  Complete this argument, and show that for each formula Ф(p, q...) prov­
           able in IPC there exists a string s that solves Ф(Х, Y,...) for all problems X, Y,....
               Surprisingly,  a kind of reverse statement is also true:  If a formula Ф(p, q,...) 
            without negations is not provable in IPC, then the complexity of Ф(Х, Y,...) is not 
           bounded (and grows linearly, as the following theorem states):
               Theorem  238.  Let Ф (ti,...,tk)  be a propositional formula with connectives 
           Л, V,—> (no negations and no logical constant _L ).  Assume that Ф  is not provable 
            in IPC.  Then there exists e > 0 and a sequence of finite non-empty sets X ™,..., X\? 
            (for n = 1,2,...) that contain only strings of length at most n, such that the com­
           plexity of Ф(Х^,..., X£) is at least en for all sufficiently large n.
               This is the main result of this chapter.  We will prove it modulo some result 
           about formulas that are not provable in IPC.
               Historical remark.  The first non-constant lower bound for Ф(Хр,... ,Х%) for 
           formulas that are not derivable in IPC was shown in [42].  The linear lower bound, 
           as in Theorem 238, is due to A. Chernov [38].
                           13.3.  Some formulas and their complexity
               In the proof of Theorem 238, we use as a tool some bounds for complexities 
           of problems obtained by substituting singletons in non-provable formulas.  Some of 
           these bounds are of independent interest (e.g., the bounds we already mentioned). 
           Let us start with more examples of this type.
               First, let us consider Peirce’s law,
                                         ((p   q)   p)   p.
           Peirce’s  law is  provable  in  classical  propositional  logic  (it  is  true  for  all  Boolean 
           values of its variables), but it cannot be proved in IPC. Thus, by Theorem 238, for 
           all n we can find non-empty sets X, Y of strings of length at most n such that the 
           complexity of the problem ((A —»• Y) —»• X)   X is higher than en.  However, it 
           turns out that the complexity of the problem  ((x —* y)  —* x)  —> x  (as usual,  we 
           write just x for singleton  {x})  is  O(logn)  for all strings x, y of length at most n 
           (Theorem 239 below).
               There is no contradiction here:  The complexity of ((A —»• Y)  —»• X)  —> X is 
           small  for  all  singletons  X  and  Y.  However,  it  may  be  large  for  arbitrary  finite 
           non-empty sets X and Y.
               Theorem 239.  The complexity of the problem ((x —> y) —> x) —> x is O(logn) 
           for all strings x,y of length at most n.
               PROOF.  It  is  enough  to  provide  an  algorithm that  gets  n  and  a solution  to 
           (x —> y) —> x and outputs x.  This algorithm works as follows.  Let p be a solution 
           to  (x  —>  y)  —>  x.  Let  5  denote  the  set  of all  strings  of length  at  most  n.  For 
           every total function r: 5 —*  5  (there are finitely many of them),  let us fix some
