              Figure 14: The InputDataGraph for the set of input strings in Example 1. Note that some constant string edges
              and the corresponding nodes are not shown here for brevity.
                          GenSubStrExpr(s, l, r, G)                               7.2    Learning Dag Data Structure
                        1 id = string2Id[s]                                         TheGenerateDagalgorithmforlearningtheDagdatastruc-
                           e        e
                        2 Vl = ∅, Vr = ∅                                          ture is similar to the Dag learning algorithm of FlashFill.
                        3 foreach v ∈ V(G):          e    e                       The algorithm takes as input an input row {v1,··· ,vk}, an
                        4      if (id,l) ∈ I(v):     V =V ∪{v}
                                                      l     l                     output string os, and an InputDataGraph G, and returns a
                                                     e     e
                        5      if (id,r) ∈ I(v):     Vr = Vr ∪{v}                 Dag that represents all string expressions in the language L
                                                                                                                                              s
                                e                                                 that can transform the input strings to the output string.
                        6 p˜ = V ∪{ConstantPos(l)}
                            l     l
                                 e                                                The algorithm ﬁrst creates len(os) number of nodes with
                        7 p˜ = V ∪{ConstantPos(r)}
                            r     r                                               labels η˜ = {0,··· ,len(o )}, and sets the start node ηs to
                        8 return SubStr(s,p˜,p˜ )                                                          s
                                               l  r                                                                               f
                                                                                  be the node with label 0 and the ﬁnal node η       with label
              Figure 15: The GenSubStrExpr algorithm for gener-                   len(os). It then iterates over all substrings os[i..j] of the out-
              ating a set of substring expressions given an input                 put string, and adds an edge (i,j) between the nodes with
              string s, the left and right indices l and r of the                 labels i and j. For each edge (i,j), the algorithm learns
              substring, and the InputDataGraphG.                                 the function W that maps the edge to a constant string
                                                                                  expression ConstantStr(os[i..j]) and a set of substring ex-
                                                                                  pressions obtained by calling GenSubStrExpr(v ,l,r,G) (for
                                                                                                                                  k
                                                                                  each (k,l,r) such that vk[l..(r − 1)] = os[i..j]).
              substring expressions that can generate the corresponding             The Dag data structure learnt by GenerateDag algorithm
              substring. It searches the graph G for all nodes v ∈ V(G)           for the input-output example v1 = "Mumbai, India" →
                                                                   e              os = "India" is shown in Figure 12. The algorithm ﬁrst
              such that (id,l) ∈ I(v) to create the set of nodes V corre-
                                                                    l
              sponding to the left index l of the substring. Similarly, the       creates len(os) = 6 nodes labeled η˜ = {0,··· ,5}, with the
                                                   e                              starting node ηs = 0 and ﬁnal node ηf = len(o ) = 5. The
              algorithm constructs the node set V corresponding to the                                                             s
                                                    r                             algorithm then adds an edge (i,j) between nodes i and j,
              right index r. It ﬁnally adds the constant position logics
              ConstantPos(l) and ConstantPos(r) to the respective set of          and assigns the labeling function W((i,j)) to the set of con-
              position expressions p˜ and p˜ , and returns the set of sub-        stant string expressions and substring expressions that can
                                     l       r                                    generate the substring v [i..(j − 1)].
              string expressions SubStr(s,p˜ ,p˜ ).                                                        1
                                             l  r                                   Dag Intersection: Given two dags, the intersection al-
                 An example substring extraction task from Example 1 is
              to extract the substring "India" from s = "Mumbai, India"           gorithmcomputesadagthatconsistsofexpressionscommon
              (GenSubStrExpr(s,9,14,G)), where 9 and 14 respectively de-          to both the dags. The main idea in the intersection proce-
              note the left and right index nodes of the substring "India"        dure is to compute the Cartesian product of the nodes in the
                                                                                  twodags,suchthatforanodeη1 ∈ Dag ,andaη2 ∈ Dag ,we
              in the input graph, and G denotes the InputDataGraph                                                       1                2
              shown in Figure 14. Let id denote the unique identiﬁer for          have a node (η1,η2) in the resulting dag. The set of labels on
              the input string s. For the left index 9, the GenSubStrExpr         the edges between these nodes is computed by intersecting
              algorithm adds all nodes in G to p˜ whose labeling function I       the corresponding pair of edges in the two dags. For inter-
                                                l                                 secting two sets of substring expressions, the corresponding
              contains the tuple (id,9). From the ﬁgure, we observe that
              there are 4 such nodes in G: {v2,v7,v15,v25}. It also adds          sets of left and right position expressions are intersected in-
                                                                                                                                             e
              the constant position expression ConstantPos(9) to the set.         dependently. For intersecting the position expressions V1
                                                                                       e
              Similarly, for the right index 14, the algorithm adds all nodes     and V2, the intersection algorithm selects the set of nodes v
              whoselabel contains the tuple (id,14) and ConstantPos(14)                                       e       e
                                                                                  that are common to both V1 and V2. The worst-case com-
              to the set p˜ . Finally, the algorithm returns the set of sub-      plexity of the LearnProgram algorithm is O((k|s|2)m), where
                          r
              string expression W05 as shown in Figure 12.
                                                                             823
