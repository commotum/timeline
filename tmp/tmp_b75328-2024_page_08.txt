                                distribution accuracy on 15 digit multiplication than prior work [Shen et al., 2023] and do not require
                                padding each operand to the same length with zeros. In particular, we highlight that the specific
                                problems that models trained with FIRE embeddings struggle to solve are the hardest problems in the
                                training set and Abacus Embeddings outperform them in this key area (see the lower right corner of
                                the red boxes in Figure 6).
                                4.3   ArraySorting
                                While both addition and multiplication accept
                                only two operands, we now analyze the task of            Table 1: Exact match accuracy for sorting with
                                sorting arrays of multiple variable length num- various positional embeddings. All results are per-
                                bers, a more challenging testbed for evaluat- centages of the test set and all models here are
                                ing the generalization abilities of our Abacus           standard transformers with eight layers.
                                Embeddings. We present each sorting problem
                                using alphabetical indices for each (reversed)                                      FIRE   Abacus   Abacus + FIRE
                                number in an input array where the expected               OOD(numberlength-30)      55.32   68.63           67.28
                                output is the alphabetical indices in ascending           OOD(arraylength-30)      21.35     9.67           21.11
                                order. For example, a : 64957,b : 99963,c :               All OOD(30×30)             3.73    2.65            4.48
                                10218,d : 7141,e : 05781 = d,e,b,a,c. We                  All OOD(20×20)            14.65    9.78           16.91
                                train with arrays of up to 10 numbers each hav-
                                ing up to 10 digits and then evaluate with arrays
                                of up to 30 numbers each having up to 30 digits.         Table2: Accuracyforsortingwithvariousarchitec-
                                Wegivemoredetailonthesortingdataconstruc- tures for sorting. ST denotes standard transformer,
                                tion process in Appendix A.2.                            STw/IIdenotesstandardtransformer with input
                                In this setting, we explore two axes of general-         injection, and LT denotes looped transformer mod-
                                ization. First, we increase the maximum pos- els. The standard transformer has the best exact
                                sible length of the input numbers to 30 digits           match accuracy. When measuring the accuracy
                                while maintaining the maximum array length to            on identifying only the minimum element of the
                                10 and refer to this scenario as “OOD (number            array, looped transformers outperform all others.
                                length - 30).” Second, we increase the number            All results are percentages of the test set.
                                of inputs in the array to be sorted to 30 while                                            ST   STw/II        LT
                                keeping the maximum digit length of each num-             All OOD(exact string match)    4.48       3.84    2.60
                                ber at 10 and term this scenario “OOD (array              All OOD(min. elem. only)      49.73      60.09  68.51
                                length - 30).” Finally, we consider a scenario where both axes are increased simultaneously, referred
                                to as “all OOD.”
                                In Table 1, we illustrate the performance of a standard transformer (eight layers) trained with different
                                embeddings—FIRE,Abacus,andtheircombination. Again,ourresultsdemonstratethatthecombined
                                embedding approach enhances the model’s ability to generalize, surpassing the performance of either
                                            0        Abacus                 Abacus + FIRE                         FIRE
                                                                                                                                         100
                                            5
                                          10                                                                                             50
                                          15                                                                                                     Accuracy
                                   Length ofOperand One20                                                                                0
                                             0      5    10    15     20 0       5     10    15    20 0        5     10    15    20
                                                                       Length of Operand Two
                                Figure 6: Exact match accuracy of looped transformer models trained on multiplication, with four
                                layers in the recurrent block and four recurrences. The red square denotes in distribution testing on up
                                to 15 digit operands. We see the models with Abacus Embeddings achieve near perfect in distribution
                                accuracy. Combining Abacus Embeddings with FIRE also improves in distribution accuracy on the
                                hardest in distribution problems (bottom right), comparing to the FIRE-only baseline.
                                                                                        8
