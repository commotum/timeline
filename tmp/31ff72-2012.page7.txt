                      small subset of (the rules of) that language and call it L                                            For example, f denotes the atomic expression f of the syn-
                                                                                                                 s                                 s
                      (with e being the top-level symbol).                                                                  tactic transformation language L . The expression grammar
                                 s                                                                                                                                             s
                                                                                                                            of the extended language L consistsofrulesR ‚à™R inwhich
                                           es     := Concatenate(f1,...,fn) | f                                                                                       u                             t     s
                         Atomic expr f            := ConstStr(s) | v | SubStr(v ,p ,p )                                     the following rules are modiÔ¨Åed (with modiÔ¨Åcations shown
                                                                                 i                  i    1    2             in bold), and with e as the top-level symbol.
                               Position p         := k|pos(r ,r ,c)                                                                                         s
                                                                      1    2                                                Atomic expr f               :=      ConstStr(s) | e | SubStr(e ,p ,p )
                                                                                                                                                  s                                     t                  t    s      s
                         Integer expr c           := k|k w+k                                                                                                                                                      1     2
                                                                1          2                                                    Predicate p             :=      C=s|C=e
                                                                                                                                                  t                                   s
                        Regular expr r            := |œÑ | TokenSeq(œÑ ,...,œÑ )
                                                                                     1          n                                               e       :=      Concatenate(f ,...,f ) | f
                                                                                                                                                  s                                    s           s        s
                                                                                                                                                                                        1            n
                      The formal semantics of Ls can be found in [8]. For com-                                              The top-level expression e of the extended language is ei-
                      pleteness, we brieÔ¨Çy describe some key aspects of this lan-                                                                                     s
                                                                                                                            ther an atomic expression f or a Concatenate operation
                      guage. The top-level expression e is either an atomic ex-                                                                                          s
                                                                            s                                               on a sequence of atomic expressions fs , as before. How-
                      pression f or is obtained by concatenating atomic expressions                                                                                                        i
                      f ,. . .,f   using the Concatenate constructor. Each atomic                                           ever, the atomic expression fs is updated to consist of a
                       1        n                                                                                           lookup expression et or its substring SubStr(et,p ,p ) (as
                                                                                                                                                                                                         s     s
                      expression f can either be a constant string ConstStr(s), an                                                                                                                        1      2
                      input string variable v , or a substring of some input string                                         opposed to only an input variable vi or its substring). This
                                                         i                                                                  lets the language model transformations that perform syn-
                      vi.    The substring expression SubStr(vi,p ,p ) is deÔ¨Åned
                                                                                          1    2                            tactic manipulations over table lookup outputs. The other
                      partly by two position expressions p1 and p2, each of which                                           modiÔ¨Åcation is in the predicate expression p of language
                      implicitly refers to the (subject) string v and must evaluate                                                                                                                 t
                                                                                    i                                       L , where we modify the conditional expression C = e to
                      to a position within the string v . (A string with ` char-                                               t                                                                                    t
                                                                          i                                                 C = es. This enables the language to model lookup trans-
                      acters has ` + 1 positions, numbered from 0 to ` starting                                             formations that perform syntactic manipulations on strings
                      from left.) SubStr(v ,p ,p ) is the substring of string v in
                                                     i    1    2                                             i              before performing the lookup. The updated rules have ex-
                      between positions p and p . A position expression repre-
                                                     1           2                                     th                   pected semantics and can be deÔ¨Åned in a similar fashion as
                      sented by a non-negative constant k denotes the k                                    posi-            the semantics of rules in L and L . We now illustrate the
                      tion in the string. For a negative constant k, it denotes the                                                                                    t           s
                                      th                                                                                    expressiveness of the extended language using few examples.
                      (` +1+k)            position in the string, where ` = Length(s). A                                        ThetransformationinExample1canberepresentedinL
                      position expression pos(r ,r ,c) evaluates to a position t in                                                                                                                                     u
                                                             1   2                                                          as: Concatenate(f ,ConstStr(‚Äú+0.‚Äù),f ,ConstStr(‚Äú*‚Äù),f ),
                      the subject string s such that regular expression r matches                                                                        1                               2                            3
                                                                                                   1                        f   ‚â°Select(Price,CostRec,Id = f ‚àßDate = f ),
                      some suÔ¨Éx of s[0 : t], and r matches some preÔ¨Åx of s[t : `],                                           1                                                     4                  5
                                                                2                                                           f4 ‚â° Select(Id,MarkupRec,Name = v1),
                      where ` = Length(s). Furthermore, if c is positive (nega-                                             f   ‚â°SubStr(v ,pos(SlashTok,,1),pos(EndTok,,1)),
                                                         th                                                                  5                    2
                      tive), then t is the |c|               such match starting from the left                              f   ‚â°SubStr2(f ,NumTok,1), f ‚â° SubStr2(f ,DecNumTok,1),
                      side (right side). We use the expression s[t : t ] to denote                                           2                     6                      3                     1
                                                                                          1     2                           f6 ‚â° Select(Markup,MarkupRec,Name = v1).
                      the substring of s between positions t1 and t2. We use no-                                                The expression f looks up the Id of the item in v from
                                                                                                                th                                        4                                                    1
                      tation SubStr2(vi,r,c) as an abbreviation to denote the c                                             the MarkupRec table and expression f generates a substring
                      occurrence of r in v , i.e., SubStr(v ,pos(,r,c),pos(r,,c)).                                                                                                  5
                                                    i                       i                                               of the date in v2, which are then used to look up the Price of
                         Aregularexpressionriseither a token œÑ, a token sequence                                            theitemfromtheCostRectable(f ). Theexpressionf looks
                      TokenSeq(œÑ ,...,œÑ ) or  (which matches the empty string).                                                                                                 1                             6
                                       1          n                                                                         up the Markup percentage of the item from the MarkupRec
                      The tokens œÑ range over some Ô¨Ånite (but easily extensible)                                            table and f generates a substring of this lookup value by ex-
                      set and typically correspond to character classes and spe-                                                             2
                      cial characters. For example, tokens UpperTok, NumTok, and                                            tracting the Ô¨Årst numeric token (thus removing the % sign).
                      AlphTok match a nonempty sequence of uppercase alpha-                                                 Similarly, the expression f3 generates a substring of f1, re-
                      betic characters, numeric digits, and alphanumeric charac-                                            moving the $ sign. Finally, the top-level expression concate-
                                                                                                                            nates f , f , and f with constant strings ‚Äú+0.‚Äù and ‚Äú*‚Äù.
                      ters respectively. DecNumTok matches a nonempty sequence                                                         1    2           3
                      of numeric digits and/or decimal point. SlashTok matches                                                  Example 5. Indexing with concatenated strings:
                      the slash character. Special tokens StartTok and EndTok                                               Abike merchant maintained an inventory of BikePrices ta-
                      match the beginning and end of a string respectively.                                                 ble, and wanted to compute the price quote table by perform-
                         Example 4. An Excel user wanted to transform names                                                 ing lookup of bike Price after concatenating the bike name
                      to a format where the last name is followed by the initial                                            (v1) and the engine cc value (v2) as shown in Figure 6.
                      letter of the Ô¨Årst name, e.g., ‚ÄúAlan Turing‚Äù ‚Üí ‚ÄúTuring
                      A‚Äù. An expression in L that can perform this transfor-
                                                             s                                                                                                                            BikePrices
                      mation is: Concatenate(f ,ConstStr(‚Äú ‚Äù),f ) where f                                       ‚â°
                                                               1                            2                1                Input v          Input v           Output            Bike               Price
                      SubStr2(v1,AlphTok,2) and f2 ‚â° SubStr2(v1,UpperTok,1).                                                             1                2                        Ducati100          10,000
                      This expression constructs the output sting by concatenating                                            Honda            125               11,500            Ducati125          12,500
                             nd                                                                                               Ducati           100               10,000
                      the 2       word of input string, the constant string whitespace,                                                                                            Ducati250          18,000
                      and the 1st capital letter in input string.                                                             Honda            250               19,000            Honda125           11,500
                         For more details on the syntactic transformation language                                            Ducati           250               18,000            Honda250           19,000
                      Ls, see [8]. Now we present the extended language Lu.                                                                                                        ¬∑ ¬∑ ¬∑              ¬∑ ¬∑ ¬∑
                      5.1       Semantic Transformation Language L                                                          Figure 6: A lookup transformation that requires
                                                                                                            u               concatenating input strings before performing selec-
                         Let R and R denote the set of grammar rules of lan-
                                   t            s                                                                           tion from a table.
                      guages L and L respectively.                          We subscript each non-
                                    t             s
                      terminal in the two languages with t and s for disambiguat-                                               The desired transformation can be expressed in the ex-
                      ing the names of non-terminals in the extended language.                                              tended language as: Select(Price,BikePrices,Bike = es)
                                                                                                                     746
