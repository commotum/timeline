                 Article
                                                                                                                                   55.   Ritt, J. F. Differential Algebra (Colloquium Publications, 1950).
                 Code availability                                                                                                 56.  Chou, S. C. Proving Elementary Geometry Theorems Using Wu’s Algorithm. Doctoral 
                 Our code and model checkpoint is available at https://github.com/                                                       dissertation, Univ. Texas at Austin (1985).
                                                                                                                                   57.   Nevins, A. J. Plane geometry theorem proving using forward chaining. Artif. Intell. 6, 1–23 
                 google-deepmind/alphageometry.                                                                                          (1975).
                                                                                                                                   58.  Coelho, H. & Pereira, L. M. Automated reasoning in geometry theorem proving with Prolog. 
                 31.   de Moura, L. & Ullrich, S. in Proc. 28th International Conference on Automated Deduction,                         J. Autom. Reason. 2, 329–390 (1986).
                       CADE 28 (eds Platzer, A. & Sutcliffe, G.) 625–635 (Springer, 2021).                                         59.  Quaife, A. Automated development of Tarski’s geometry. J. Autom. Reason. 5, 97–118 
                 32.  Krueger, R., Han, J. M. & Selsam, D. in Proc. 28th International Conference on Automated                           (1989).
                       Deduction, CADE 28 (eds Platzer, A. & Sutcliffe, G.) 577–588 (Springer, 2021).                              60.  McCharen, J. D., Overbeek, R. A. & Lawrence, T. in The Collected Works of Larry Wos 166–196 
                 33.  de Moura, L. & Bjørner, N. in Proc. 14th International Conference on Tools and Algorithms                          (2000).
                       for the Construction and Analysis of Systems, TACAS 2008 (eds Ramakrishnan, C. R. &                         61.   Chou, S. C., Gao, X. S. & Zhang, J. Machine Proofs in Geometry: Automated Production of 
                       Rehof, J.) 337–340 (Springer, 2008).                                                                              Readable Proofs for Geometry Theorems (World Scientific, 1994).
                 34.  Todd, P. A method for the automated discovery of angle theorems. EPTCS 352, 148–155                          62.  Paulson, L. C. (ed.) Isabelle: A Generic Theorem Prover (Springer, 1994).
                       (2021).                                                                                                     63.  Wu, Y., Jiang, A. Q., Ba, J. & Grosse, R. INT: an inequality benchmark for evaluating 
                 35.  Hutchins, D., Rabe, M., Wu, Y., Schlag, I. & Staats, C. Meliad. Github https://github.com/                         generalization in theorem proving. Preprint at https://doi.org/10.48550/arXiv.2007.02924 
                       google-research/meliad (2022).                                                                                    (2021).
                 36.  Kudo, T. & Richardson, J. SentencePiece: a simple and language independent subword                           64.  Zombori, Z., Csiszárik, A., Michalewski, H., Kaliszyk, C. & Urban, J. in Proc. 30th International 
                       tokenizer and detokenizer for neural text processing. Preprint at https://arxiv.org/abs/                          Conference on Automated Reasoning with Analytic Tableaux and Related Methods (eds  
                       1808.06226 (2018).                                                                                                Das, A. & Negri, S.) 167–186 (Springer, 2021).
                 37.   Raffel, C. et al. Exploring the limits of transfer learning with a unified text-to-text transformer.        65.  Fawzi, A., Malinowski, M., Fawzi, H., Fawzi, O. Learning dynamic polynomial proofs. Adv. 
                       J. Mach. Learn. Res. 21, 5485–5551 (2020).                                                                        Neural Inf. Process. Syst. https://doi.org/10.48550/arXiv.1906.01681 (2019).
                 38.  Kosec, M., Fu, S. & Krell, M. M. Packing: towards 2x NLP BERT acceleration. Preprint at                      66.  Wang, M. & Deng, J. Learning to prove theorems by learning to generate theorems. Adv. 
                       https://openreview.net/forum?id=3_MUAtqR0aA (2021).                                                               Neural Inf. Process. Syst. 33, 18146–18157 (2020).
                 39.  Krell, M. M., Kosec, M., Perez, S. P. & Iyer, M., Fitzgibbon A. W. Efficient sequence packing                67.   Aygün, E. et al. in Proc. 39th International Conference on Machine Learning 1198–1210 
                       without cross-contamination: accelerating large language models without impacting                                 (PMLR, 2022).
                       performance. Preprint at https://arxiv.org/abs/2107.02027 (2022).                                           68.  Andrychowicz, M. et al. Hindsight experience replay. Adv. Neural Inf. Process. Syst. 
                 40.  Srivastava, N., Hinton, G., Krizhevsky, A., Sutskever, I. & Salakhutdinov, R. Dropout: a simple                    https://doi.org/10.48550/arXiv.1707.01495 (2017).
                       way to prevent neural networks from overfitting. J. Mach. Learn. Res. 15, 1929–1958 (2014).                 69.  Firoiu, V. et al. Training a first-order theorem prover from synthetic data. Preprint at 
                 41.   Norrie, T. et al. The design process for Google’s training chips: TPUv2 and TPUv3. IEEE                           https://doi.org/10.48550/arXiv.2103.03798 (2021).
                       Micro. 41, 56–63 (2021) Feb 9.
                 42.  Gilmore, P. C. A proof method for quantification theory: its justification and realization.                  Acknowledgements This project is a collaboration between the Google Brain team and the 
                       IBM J. Res. Dev. 4, 28–35 (1960).                                                                           Computer Science Department of New York University. We thank R. A. Saurous, D. Zhou,  
                 43.  Davis, M. & Putnam, H. A computing procedure for quantification theory. J. ACM. 7, 201–215                   C. Szegedy, D. Hutchins, T. Kipf, H. Pham, P. Veličković, E. Lockhart, D. Dwibedi, K. Cho,  
                       (1960).                                                                                                     L. Pinto, A. Canziani, T. Wies, H. He’s research group, E. Chen (the USA’s IMO team coach),  
                 44.  Schulz, S. E – a brainiac theorem prover. AI Commun. 15, 111–126 (2002).                                     M. Olsak and P. Bak.
                 45.  Riazanov, A. & Voronkov, A. in Proc. First International Joint Conference on Automated 
                       Reasoning, IJCAR 2001 (eds Goré, R., Leitsch, A. & Nipkow, T.) 376–380 (Springer, 2001).                    Author contributions T.H.T. conceived the project, built the codebase, carried out experiments, 
                 46.  Irving, G. et al. DeepMath - deep sequence models for premise selection. Adv. Neural Inf.                    requested manual evaluation from experts and drafted the manuscript. Y.W. advocated for the 
                       Process. Syst. https://doi.org/10.48550/arXiv.1606.04442 (2016).                                            neuro-symbolic setting and advised on data/training/codebase choices. Q.V.L. advised on 
                 47.   Wang, M., Tang, Y., Wang, J. & Deng, J. Premise selection for theorem proving by deep graph                 scientific methodology and revised the manuscript. H.H. advised on scientific methodology, 
                       embedding. Adv. Neural Inf. Process. Syst. https://doi.org/10.48550/arXiv.1709.09994                        experimental set-ups and the manuscript. T.L. is the PI of the project, advised on model 
                       (2017).                                                                                                     designs/implementations/experiments and helped with manuscript structure and writing.
                 48.  Loos, S., Irving, G., Szegedy, C. & Kaliszyk, C. Deep network guided proof search. Preprint 
                       at https://arxiv.org/abs/1701.06972 (2017).                                                                 Competing interests The following US patent is related to this work: “Training language model 
                 49.  Bansal, K., Loos, S., Rabe, M., Szegedy, C. & Wilcox S. in Proc. 36th International                          neural networks using synthetic reasoning data”, filed in the United States Patent and Trademark 
                       Conference on Machine Learning 454–463 (PMLR, 2019).                                                        Office (USPTO) on 1 May 2023 as application no. 63/499,469.
                 50.  Selsam, D. et al. Learning a SAT solver from single-bit supervision. Preprint at https://doi.
                       org/10.48550/arXiv.1802.03685 (2019).
                 51.   Saxton, D., Grefenstette, E., Hill, F. & Kohli, P. Analysing mathematical reasoning abilities               Additional information
                       of neural models. Preprint at https://doi.org/10.48550/arXiv.1904.01557 (2019).                             Supplementary information The online version contains supplementary material available at 
                 52.  Lample, G. & Charton F. Deep learning for symbolic mathematics. Preprint at https://doi.                     https://doi.org/10.1038/s41586-023-06747-5.
                       org/10.48550/arXiv.1912.01412 (2019).                                                                       Correspondence and requests for materials should be addressed to Trieu H. Trinh  
                 53.  Charton, F., Hayat, A. & Lample, G. Learning advanced mathematical computations from                         or Thang Luong.
                       examples. Preprint at https://doi.org/10.48550/arXiv.2006.06462 (2021).                                     Peer review information Nature thanks the anonymous reviewers for their contribution to the 
                 54.  Collins, G. E. in Proc. 2nd GI Conference on Automata Theory and Formal Languages                            peer review of this work.
                       (ed. Barkhage, H.) 134–183 (Springer, 1975).                                                                Reprints and permissions information is available at http://www.nature.com/reprints.
