                                                             © 1999 Nature America Inc. • http://neurosci.nature.com
                                                                                                                                                articles
                   Predictive coding in the visual cortex: 
                   a functional interpretation of some
                   extra-classical receptive-field effects
                                       1                           2
                   Rajesh P. N. Rao and Dana H. Ballard
                   1 The Salk Institute, Sloan Center for Theoretical Neurobiology and Computational Neurobiology Laboratory, 10010 N. Torrey Pines Road, 
                     La Jolla, California 92037, USA
                   2 Department of Computer Science, University of Rochester, Rochester, New York 14627-0226, USA
                     Correspondence should be addressed to R.P.N.R. (rao@salk.edu)
                   We describe a model of visual processing in which feedback connections from a higher- to a lower-
                   order visual cortical area carry predictions of lower-level neural activities, whereas the feedforward
                   connections carry the residual errors between the predictions and the actual lower-level activities.
                   When exposed to natural images, a hierarchical network of model neurons implementing such a
                   model developed simple-cell-like receptive fields. A subset of neurons responsible for carrying the
                   residual errors showed endstopping and other extra-classical receptive-field effects. These results
                   suggest that rather than being exclusively feedforward phenomena, nonclassical surround effects in
                   the visual cortex may also result from cortico-cortical feedback as a consequence of the visual system
         http://neurosci.nature.comusing an efficient hierarchical strategy for encoding natural images.
        •
                   Neurons that respond optimally to line segments of a partic-           redundant, components of the input signal. Roots of this idea
                   ular length were first reported in early studies of the cat and        can be found in early information-theoretic approaches to sen-
                                          1,2                                                             14–16
                   monkey visual cortex      . These neurons, which are especially        sory processing      . More recently, it has been used to explain
                   abundant in cortical layers 2 and 3, have the curious property         the spatiotemporal response properties of cells in the reti-
                                                                                             17–19                                           20,21
                   of endstopping (or end-inhibition): a vigorous response to an          na      and lateral geniculate nucleus (LGN)           . Because
                   optimally oriented line segment is reduced or eliminated when          neighboring pixel intensities in natural images tend to be cor-
        1999 Nature America Inc. the same stimulus extends beyond the neuron’s classical recep-related, values near the image center can often be predicted
         
        ©          tive field (RF). Such ‘extra-classical’ RF effects occur in sever-     from surrounding values. Thus, the raw image-intensity value
                   al visual cortical areas, including V1 (area 17; refs 2, 3), V2        at each pixel can be replaced by the difference between a cen-
                   (area 18; refs 1, 4), V4 (ref. 5) and MT6. In most of these cases,     ter pixel value and its spatial prediction from a linear weight-
                   neural responses are suppressed when stimulus properties at            ed sum of the surrounding values. This decorrelates (or
                   the center, such as orientation, velocity or direction of motion,      whitens) the inputs17,19 and reduces output redundancy, pro-
                   match those in the surrounding extra-classical RF.                     viding a functional explanation for center–surround receptive
                      Why should a neuron that responds to a stimulus stop                fields in the retina and LGN. The values of a given pixel also
                   responding when the same stimulus extends beyond the clas-             tend to correlate over time. A retinal/LGN cell’s phasic response
                   sical RF? Some studies have postulated a role for ‘hypercom-           can thus be interpreted as the difference between the actual
                   plex’ endstopped neurons in the detection of visual                    input and its temporal prediction based on a linear weighted
                              1,7                                                                                   19–21
                   curvature     . Others have suggested a role for these cells in        sum of past input values       . Similarly, the responses of reti-
                                                              8            9
                   detecting corners and line terminations , occlusion , percep-          nal photoreceptors sensitive to different wavelengths are often
                                  10                        11
                   tual grouping    and illusory contours . However, a straight-          correlated because their spectral sensitivities overlap. Thus,
                   forward extension of these arguments to extra-classical RF             the L-cone (long-wavelength or ‘red’ receptor) response may
                   effects in different cortical areas has been difficult. We have        predict the M-cone (medium-wavelength or ‘green’ receptor)
                   previously shown that a model12 based on the principle of              response, and the L- and M-cone responses together may pre-
                   Kalman filtering can account for certain visual cortical respons-      dict the S-cone (short-wavelength or ‘blue’ receptor) response.
                   es in a monkey freely viewing natural images13. It was conjec-         Thus, the color-opponent (red – green) and blue – (red +
                   tured that a similar model might also account for endstopping          green) channels in the retina might reflect predictive coding
                   and other extra-classical effects.                                     in the chromatic domain similar to that of the spatial and tem-
                      Here we show simulations suggesting that extra-classical RF         poral domains18.
                   effects may result directly from predictive coding of natural             Using a hierarchical model of predictive coding, we show
                   images. The approach postulates that neural networks learn             that visual cortical neurons with extra-classical RF properties
                   the statistical regularities of the natural world, signaling devi-     can be interpreted as residual error detectors, signaling the dif-
                   ations from such regularities to higher processing centers. This       ference between an input signal and its statistical prediction
                   reduces redundancy by removing the predictable, and hence              based on an efficient internal model of natural images.
                   nature neuroscience  •  volume 2  no 1  •  january 1999                                                                               79
                                                              © 1999 Nature America Inc. • http://neurosci.nature.com
                   articles
                     a                                                                      b
                   Fig. 1. Hierarchical network for predictive coding. (a) General           c
                   architecture of the hierarchical predictive coding model. At each
                   hierarchical level, feedback pathways carry predictions of neural
                   activity at the lower level, whereas feedforward pathways carry
                   residual errors between the predictions and actual neural activity.
                   These errors are used by the predictive estimator (PE) at each level
                   to correct its current estimate of the input signal and generate the
                   next prediction. (b) Components of a PE module, composed of
                                                                            T
                   feedforward neurons encoding the synaptic weights U , neurons
                   whose responses r maintain the current estimate of the input signal,
                   feedback neurons encoding U and conveying the prediction f(Ur) to
                   the lower level, and error-detecting neurons computing the differ-
                              td                                                              td
                   ence (r – r ) between the current estimate r and its top-down prediction r from a higher level. (c) A three-level hierarchical network used
                   in the simulations. An input image was analyzed by three level-1 PE modules, each predicting its own local image patch. The responses r of all
                   three level-1 modules were input to the level-2 module. This convergence of lower-level inputs to a higher-level module increases receptive-
                   field size of neurons as one ascends the hierarchy, with the receptive field at the highest level spanning the entire input image.
         http://neurosci.nature.com
        •          Results                                                                 that was not predicted by V2 (refs 12, 22). To test this hypothesis,
                   HIERARCHICALPREDICTIVECODINGMODEL                                       a three-level hierarchical network of predictive estimators
                   Each level in the hierarchical model network (except the lowest         (Fig. 1c) was trained on image patches extracted from five nat-
                   level, which represents the image) attempts to predict the respons-     ural images (Fig. 2a), the motivation being that the response
                   es at the next lower level via feedback connections (Fig. 1a). The      properties of visual neurons might be largely determined by the
                   error between this prediction and the actual response is then sent      statistics of natural images17,20,21,30. Such an approach has pre-
                   back to the higher level via feedforward connections. This error        viously explained some important visual cortical RF proper-
                                                                                               26,31,32
                   signal is used to correct the estimate of the input signal at each      ties      .
                   level (see Methods and Fig. 1b), similar to some previous mod-              We allowed the network to learn a hierarchical internal model
        1999 Nature America Inc. els22–24 (see also refs 15, 25, 26). The prediction and error-cor-of its natural image inputs by maximizing the posterior proba-
         
        ©          rection cycles occur concurrently throughout the hierarchy, so          bility of generating the observed data (Methods). The internal
                   top-down information influences lower-level estimates, and bot-         model is encoded in a distributed manner within the synapses
                   tom-up information influences higher-level estimates of the input       of model neurons at each level. The synaptic weights (or ‘effica-
                   signal. Lower levels operate on smaller spatial (and possibly tem-      cies’) of a neuron encode a single basis vector that in conjunc-
                   poral) scales, whereas higher levels estimate signal properties at      tion with other basis vectors predicts lower-level inputs. For
                   larger scales because a higher-level module predicts and estimates      example, a given input image at the zeroth level can be predicted
                   the responses of several lower-level modules (for example, three        as an appropriate linear combination of the first-level basis vec-
                   in Fig. 1c). Thus, the effective RF size of units increases progres-    tors (Methods, Equation 2). In this linear combination, the
                   sively until the highest level, where the RF spans the entire input     weighting coefficient for the kth basis vector is given by the
                   image. The underlying assumption here is that the external envi-        response of the kth neuron in the first level. The response is deter-
                   ronment generates natural signals hierarchically via interacting        mined by a first-order differential equation implementing the
                   hidden physical causes (object attributes such as shape, texture        prediction and error-correction cycle mentioned above. This
                   and luminance) at multiple spatial and temporal scales. The goal        equation, like the synaptic learning rule, is also derived by max-
                   of a visual system then becomes optimally estimating these hid-         imizing the posterior probability of generating the observed data
                   den causes at each scale for each input image and, on a longer          (Methods). Thus, for any given input, the network converges to
                   time scale, learning the parameters governing the hierarchical          a set of neuronal responses optimal for predicting that input.
                   generative model. Similar models have been studied by other             These responses are then used to adapt the synaptic basis vec-
                   researchers (for example, refs 27, 28).                                 tors. The same description applies to each level of the hierarchy,
                                                                                           with each level predicting the inputs at its lower level using its
                   HIERARCHICALPREDICTIVECODINGOFNATURALIMAGES                             set of learned basis vectors and, on a slower time scale, adapting
                   Given that the visual cortex is hierarchically organized and that       these basis vectors to enable more accurate prediction of the
                   cortico-cortical connections are almost always reciprocal29, the        inputs in the future.
                   model described above suggests the following hypothesis: feed-              After exposure to several thousand natural image patches, the
                   back connections from a higher area to a lower area (say V2 to          basis vectors learned by the network at level 1 resembled orient-
                   V1) carry predictions of expected neural activity in V1, whereas        ed edges or bars (Fig. 2b), whereas the basis vectors at level 2
                   feedforward connections convey to V2 the residual activity in V1        seemed to be composed of various combinations of the features
                   80                                                                                        nature neuroscience  •  volume 2  no 1  •  january 1999
                                                              © 1999 Nature America Inc. • http://neurosci.nature.com
                                                                                                                                                   articles
                     a                                                                         Fig. 2. Receptive fields of feedforward model neurons after
                                                                                               training on natural images. (a) Five natural images used for
                                                                                               training the three-level hierarchical network of Fig. 1c
                                                                                               (Methods). The two upper boxes in the bottom right corner
                                                                                               show relative sizes (16 x 16 and 16 x 26 pixels) of level-1 and
                                                                                               level-2 receptive fields respectively. (b) Learned synaptic
                                                                                               weights (RF weighting profiles) of 20 of the 32 feedforward
                                                                                               model neurons in the level-1 module analyzing the central image
                                                                                               region. Flanking image regions were analyzed by two other
                                                                                               level-1 modules (Fig. 1c), each with 32 feedforward model
                                                                                               neurons (Methods). Values for these synapses, which form rows
                                                                                               of the matrix UT, can be positive (excitatory, bright regions) or
                                                                                               negative (inhibitory, dark regions). These RF profiles resemble
                                                                 Level 1                                          classical oriented-edge/bar detectors charac-
                     b                                                                                            teristic of simple cells2. (c) RF profiles of 12
                                                                                                                  of the 128 level-2 feedforward model neu-
                                                                                                                  rons. (d) Localized RF profiles resembling
                                                                                                                  Gabor wavelets obtained by using a sigmoidal
                                                                                                                  nonlinearity in the generative model, along
                                                                                                                  with a sparse kurtotic prior distribution for
                                                                 Level 2                                          the network activities (Methods). All 32
                     c                                                                                            level-1 feedforward model neurons are
                                                                                                                  shown; Gaussian windowing of inputs (as in
                                                                                                                  b) was not necessary in this case.
         http://neurosci.nature.com               Level 1 (with sparse prior distribution)
        •            d
                   represented at level 1 (Fig. 2c). The basis vectors can be regarded     nections to a higher area generally arise from the superficial lay-
                   as approximate ‘receptive fields’ of the feedforward model neu-         ers (such as layer 2/3). A relatively large number of neurons in
                   rons because they are the primary determinants of the neurons’          layer 2/3 of striate cortex (V1) show endstopping and related
        1999 Nature America Inc.          26,32                                                                   2,3,33
                   feedforward responses      . These RFs at level 1 are reminiscent of    extra-classical effects    . To ascertain whether these observed
        ©          oriented Gabor or difference-of-Gaussian filters that have been         neuronal responses can be functionally interpreted as residual
                   used to model simple-cell RFs in primary visual cortex (for exam-       error signals, we recorded the responses of level-1 error-detecting
                   ple, ref. 7). We used a Gaussian weighting profile to model the         neurons in the simulated network, when exposed to the image
                   input dendritic arbor of the model neurons so that each set of          of a short dark bar lying within their RF (Fig. 3a). The solid box
                   the level 1 neurons only sees a localized portion of the entire input   in the first panel (‘Input’) represents the RF size of the level-1
                   image. However, the model also learns localized receptive fields        neurons (16 × 16 pixels), whereas the dotted box represents the
                   without a Gaussian spatial window if we impose the additional           level-2 RFs (16 × 26 pixels). The last two panels show the two
                   constraint of sparseness on the model neuron responses (Meth-           components that determine the error signal. Many of the error-
                                 26,32
                   ods; Fig. 2d)     . In this case, the wavelet-like basis vectors code   detecting neurons showed significant non-zero responses,
                   for local oriented structures rather than being centered in the         demonstrating that feedback from level 2 could not completely
                   input window as in Fig. 2b. These basis vectors and their level-2       predict the responses at level 1.
                   counterparts were used for the simulations in Fig. 6, whereas all           On the other hand, when the bar stimulus extends beyond
                   other simulations used the basis vectors in Fig. 2b and c.              the classical receptive field into the flanking regions (Fig. 3b),
                                                                                           the same error-detecting neurons showed little or no response
                   ENDSTOPPEDRESPONSESINTERPRETEDASERRORSIGNALS                            because the predictions from level 2 were much more accurate,
                   Given an input image, the initial predictions at any given level        with prediction errors close to zero. Why are the level 2 predic-
                   are based on an arbitrary random combination of the basis vec-          tions much more accurate for the longer bar than for the short
                   tors, giving large error signals. To minimize this error, the net-      bar? Recall that the network was trained on natural images. In
                   work converges to the responses that best predict the current           natural images, short bars seldom occur in isolation; rather, a
                   input by subtracting the prediction from the input (via inhibi-         bar in a small region of an image is usually part of a longer bar
                   tion) and propagating the residual error signal to the neurons at       that extends into neighboring regions. Because the network was
                   the next level, which integrate this error and generate a better        optimized for natural image statistics, the most accurate predic-
                   prediction (Methods).                                                   tions are generated when the input’s properties match those of
                       The model neurons carrying the error signal (the ‘error-            natural images. The continuation of the bar into the surrounding
                   detecting’ neurons) send feedforward connections from the lower         region provides the necessary context for the bar in the center to
                   level to the higher level. In the visual cortex, feedforward con-       be predicted, much as in the case of retinal center-surround pre-
                   nature neuroscience  •  volume 2  no 1  •  january 1999                                                                                  81
                                                                     © 1999 Nature America Inc. • http://neurosci.nature.com
                     articles
                       a      Input                     Error                Level 1 reponses      Predictive feedback            Fig. 3. Endstopping in the model net-
                                                        (r-rtd)                       r                     rtd                   work. (a) Responses of the 32 error-
                                                                                                                                  detecting model neurons in the central
                                                                                                                                  level-1 module to a dark bar. (Positive val-
                                                                                                                                  ues are upward bars; negative values are
                                                                                                                                  downward bars.) Although not modeled
                                             Response                                                                             here, positive and negative values may be
                                                                                                                                  coded by separate neurons in the cortex.
                                                                                                                                  (b) Reduction in the level-1 residual
                                                                                                                                  errors due to increase in top-down pre-
                       b                                                                                                          diction accuracy as the bar extends
                                                                                                                                  beyond the classical RF (solid box), up to
                                                                                                                                  the size of the level-2 RF (dashed box).
                                                                                                                                  This reduced prediction error manifests
                                               Response                                                                           itself as endstopping in the error-detect-
                                                                                                                                  ing model neurons. (c) Length-tuning
                                                                                                                                  curves for two error-detecting model
                                                    Neuron number                                                                 neurons at level 1 with even-symmetric
                                                                                                                                  (left) and odd-symmetric (right) RF pro-
                                                                                                                                  files. Both model neurons show the
                       c                   Model neuron 1                                      Model neuron 2                     decrease in response characteristic of
                                                                                0.03                                              endstopping as the bar extends beyond
                                                                                                                                  the classical RF. The dashed line repre-
                                                                                0.025                                             sents the corresponding response r at
                                                                                                                                  level 1, and the dotted line represents the
                                                                                0.02                                              predictive feedback rtd from level 2.
                                                                                0.015
          http://neurosci.nature.comResponse
         •                                                                      0.01
                                                                                0.005
                              0       5       10       15      20      25         0
                                                                                   0       5       10      15      20       25
                                           Bar length (pixels)                                 Bar length (pixels)
                     diction mechanisms. Without this contextual information in the                  from level 2 falls short of the actual level-1 responses for shorter
         1999 Nature America Inc. surrounding region, the higher level cannot accurately predict     bar lengths but gradually matches the actual response as the
          
         ©           the bar in the center. The short bar thus elicits a relatively large            length of the bar is increased. This determines the model length-
                     response from the error-detecting neurons as compared to the                    tuning curves, which closely resemble the tuning curves of layer
                     longer bar.                                                                     2/3 neurons in cat striate cortex (Fig. 5a). The model tuning curve
                         This argument suggests that the autocorrelation along a dom-                is a parameter-free prediction of the data in the sense that it is
                     inant orientation in a local region in natural images extends over              determined by the statistics of the input natural images rather
                     reasonably large distances. We tested this hypothesis on a set of               than by the physiological data. Thus, the close similarity between
                     natural images (Fig. 4a). Random locations were selected in these               the model and physiological tuning curves is noteworthy. In the
                     images, and the local oriented energy was computed by summing                   model, the average length of the bar eliciting maximal response
                     the squared outputs of quadrature pairs of filters. The orienta-                was found to be approximately 4.5 pixels, the absolute RF sizes
                     tion that maximized this energy measure was selected as the dom-                being approximately 5 × 10 pixels. For comparison, ref. 3 reports
                     inant orientation. Correlations in the dominant orientation                     RF sizes of 1° × 1.75° and 0.5° × 1.5° for two visual cortical neu-
                     direction and in the opposite direction in the natural image were               rons. These were maximally responsive to bars of length 1° and
                     then calculated along three different orientation directions (ver-              0.5°, respectively.
                     tical, horizontal and diagonal) for several thousand random
                     image locations (Fig. 4b). The average correlations along the                   PREDICTIVEFEEDBACKANDEXTRA-CLASSICALRF EFFECTS
                     dominant directions, especially the vertical and horizontal direc-              The removal of feedback from level 2 to level 1 in the model
                     tions, remain relatively high for distances of up to plus or minus              caused previously endstopped neurons to continue to respond
                     50 pixels as compared to the correlations in the opposite direc-                to bars of increasing lengths (Fig. 5a), supporting the hypothesis
                     tion. As a control, we repeated the experiment for three differ-                that predictive feedback is important in mediating endstopping
                     ent natural image sizes (968 × 968, 484 × 484 and 242 × 242                     in the level-1 model neurons. To quantify this result, we com-
                     pixels). In all three cases, higher correlations were observed in               puted the distribution of endstopping (Fig. 5b) in all 32 model
                     the dominant direction as compared to the opposite direction.                   layer 2/3 (error-detecting) neurons in the central level-1 module
                     (Results for a random white-noise image are shown in Fig. 4c.)                  (see Fig. 1c) with and without feedback from level 2. The degree
                         To compare model neuron responses to neurophysiological                     of endstopping was quantified as the percentage difference
                     data, we computed the tuning curves of model error-detecting                    between peak response and average plateau response for lengths
                     neurons to bars of increasing length (Fig. 3c). The prediction                  greater than 18 pixels: (peak – plateau)/peak × 100. Model neu-
                     82                                                                                                  nature neuroscience  •  volume 2  no 1  •  january 1999
                                                                    © 1999 Nature America Inc. • http://neurosci.nature.com
                                                                                                                                                                 articles
                       a                                                                                    Fig. 4. Autocorrelation along dominant orientation direc-
                                                                                                            tions in natural images. (a) Three natural images from the
                                                                                                            Sweeney/Rubin Ansel Adams Fiat Lux collection (repro-
                                                                                                            duced with permission from the California Museum of
                                                                                                            Photography, University of California, Riverside). Each image
                                                                                                            was filtered with quadrature pairs of oriented filters for
                                                                                                            computing oriented energy. Three of these oriented filters
                                                                                                            are shown at the bottom alongside the arrows. The bottom
                                                                                                            row shows examples of oriented structures extending over
                                                                                                            relatively large distances in three natural image patches. 
                                                                                                            (b) Average correlations in the natural images along the
                                                                                                            dominant orientation direction and the orthogonal direc-
                                                                                                            tion, shown here for three different orientation directions
                                                                                                            (horizontal, vertical and diagonal) and for three different
                                                                                                            natural image sizes. Correlations were computed by choos-
                                                                                                            ing a 16 x 16 image patch at a randomly selected location in
                       b          Vertical (90°)           Horizontal (0°)          Diagonal (135°)         a natural image and translating the correlation window up to
                                                                                                            plus and minus 50 pixels along the dominant orientation
                                                                                                            direction and the orthogonal direction. The dominant orien-
                                                                                                            tation was chosen to be the one that maximized the local
                                                                                                            oriented energy as given by the sum of squared outputs of
                                                                                                            the quadrature pairs of filters. Correlations along the domi-
                                                                                                            nant directions remained positive for distances of up to plus
                                                                                                            or minus 50 pixels, supporting the hypothesis that oriented
                                                                                                            structures in natural images on the average tend to extend
                                                                                                            over reasonably large distances. (c) Results of applying the
                                                                                                            same procedure to a randomly generated white-noise image.
          http://neurosci.nature.comCorrelation
         •
                                                                                                            three-level hierarchical network, similar to the one used
                                                                                                            for the endstopping simulations, on ten different natural
                                                                                                            images. Rather than using a Gaussian window to localize
                                                                                                            receptive fields as in the endstopping experiments, we
                                                       Distance (in pixels)                                 allowed the network to learn localized receptive fields by
                                                                                                                                                        32
                                                                                                            imposing a sparse prior distribution           on the network
                       c                                                                                    responses (Methods). A total of nine level-1 modules
         1999 Nature America Inc.                                                                           arranged in three rows and three columns analyzed a local
          
         ©                                                                                                  image patch (14 × 14 pixels). The outputs of these nine
                                                                                                            modules were input to the single level-2 module.
                                                                                                                An oriented grating in the classical RF produced a
                         Correlation                                                                        robust response in a level-1 error-detecting model neu-
                                                      Distance (in pixels)                                  ron in the simulated network (Fig. 6a). This steady-state
                                                                                                            response was suppressed 85.3% when a grating at the
                                                                                                            same orientation was introduced in the surrounding
                                                                                                            extra-classical region, consistent with a reduction in the
                     rons were classified into 10 categories according to their degree of           residual error signal due to better prediction from level 2 based
                     endstopping, with 100% inhibition denoting a plateau response                  on the surrounding context. Introducing an orientation contrast
                     of zero to long bars. If we define endstopping as greater than 50%             between the center and the surrounding region increased the
                     inhibition, 28 of the 32 model error-detecting neurons were end-               model neuron response by 19.1% over the classical RF response,
                     stopped with feedback intact. Disabling the feedback connec-                   reflecting an increase in the residual error. Similar increases in
                     tions eliminated endstopping in all but 5 of these neurons, a                  neuronal responses due to cross-oriented grating stimuli have
                                                                                                                                                 36
                     reduction of 82%. The five neurons that continued to show some                 been reported in primary visual cortex . An optimally oriented
                     degree of endstopping after removal of feedback were those whose               grating restricted only to the surround elicited little response in
                     receptive field orientations were not completely aligned with that             the model neuron. We determined the response of a model neu-
                     of the bar used for testing.                                                   ron (Fig. 6b) to four different texture stimuli previously used in
                                                                                                                            35
                                                                                                    a macaque V1 study . The largest response was elicited by the
                     OTHEREXTRA-CLASSICALRF EFFECTSINTHEMODEL                                       ‘pop-out’ texture stimulus (compare with Fig. 4 of ref. 35 show-
                     Several neurophysiological studies have reported nonclassical                  ing a similar response in a V1 neuron). For these stimuli, the spa-
                     surround effects due to orientation contrast between the stimuli               tial displacement of the central and surrounding bars in a
                     in the central classical RF region and the surrounding                         particular direction sometimes modified a response from sup-
                             33,35,36
                     region         . To investigate whether some of these effects could            pression to enhancement or vice versa, an effect attributable to
                     result from the extended positive correlations along dominant                  the localized nature of the level-1 receptive fields (Fig. 2d). We
                     orientation directions in natural images (Fig. 4), we trained a                also tested the response of an error-detecting model neuron
                     nature neuroscience  •  volume 2  no 1  •  january 1999                                                                                               83
                                                                          © 1999 Nature America Inc. • http://neurosci.nature.com
                       articles
                                            Model Neuron                               Cortical Neuron                 Fig. 5. Predictive feedback and endstopping. (a) Effect of
                         a                Model neuron                                Cortical neuron
                              100                                        100                                           inactivating feedback from level 2 in the model. Plotted on
                               90                                         90                                           the left are the length tuning curves for a ‘layer 2/3’ error-
                               80                      Without feedback   80                                           detecting model neuron at level 1 with and without feed-
                               70                                         70                     Layer 6 inactivated   back from level 2 (solid and dotted line respectively).
                               60                                         60                                           Tuning curves for a layer 2/3 complex cell in cat striate cor-
                               50                                         50                                           tex (V1) (redrawn from Fig. 3 in ref. 3) are shown on the
                               40                                         40                                           right for comparison. Disabling top-down feedback elimi-
                               30                                         30                                           nated endstopping in the model neuron in a manner quali-
                             % Maximum Response20         With feedback   20
                             % maximum response10                         10                        Layer 6 intact     tatively similar to that observed in the cortical neuron after
                                00  2   4   6   8  10 12 14 16 18 20       00    1   2    3    4   5    6    7   8     inactivation of layer 6 (dotted line). Elimination of feedback
                                            Bar Length (pixels)                        Bar Length (deg)                from V2 dramatically affects neural responses in layer 6 of
                                           Bar length (pixels)                         Bar length (deg)                                               34. (b) Histograms summarizing
                                                                                                                       V1 in the squirrel monkey
                        b                                                                                              the distribution of length tuning in all 32 model layer 2/3
                                       Model with feedback                      Model without feedback                 neurons in the central level 1 module with feedback (left)
                                       Model With Feedback                       Model Without Feedback
                           12                                          12                                              and without feedback (right) from level 2. Endstopping was
                           10                                          10                                              quantified as the percentage difference between peak
                                                                                                                       response and average plateau response for lengths greater
                            8                                          8                                               than 18 pixels. Model neurons were classified into ten cate-
                            6                                          6                                               gories according to their degree of endstopping. Disabling
                                                                                                                       feedback connections eliminated endstopping (defined as
                            4                                          4                                               greater than 50% inhibition) in 82% of the model layer 2/3
                         Number of neuronsNumber of Neurons2           2                                               neurons.
                            0                                          0
                               0  10 20 30 40 50 60 70 80 90 100           0  10 20 30 40 50 60 70 80 90 100
                              Min                                Max      Min                                Max
                                    Degree of Endstopping (%)                    Degree of Endstopping (%)
                                                         Degree of endstopping (%)
          http://neurosci.nature.com
         •
                       (Fig. 6c) to random texture stimuli used in a study of contextu-                      back should disinhibit the responses of layer 2/3 neurons that are
                       al modulation in alert macaque V1 (ref. 33). The tonic phase of                       suppressed by extra-classical stimuli under normal conditions.
                       the model neuron response reveals a large positive difference                         In anesthetized monkeys, inactivation of higher-order visual cor-
                       (93.5%) developing over time for the orientation-contrast tex-                        tical areas disinhibits responses to surround stimuli in lower-area
                                                                                                                       37
                       ture as compared to the homogeneous texture. This modulation                          neurons      (see also Hupé, J. M. et al., Soc. Neurosci. Abstr. 23,
                       in response resembles the type of contextual modulation observed                      1031, 1997 and James, A. C. et al., Soc. Neurosci. Abstr. 21, 904,
                       in V1 neurons (compare with Fig. 2 of ref. 33).                                       1995), consistent with the predictive coding model. In the cat,
                                                                                                             removal of feedback from visual cortical areas 17 and 18 to the
         1999 Nature America Inc.                                                                                                                                                         38
                       Discussion                                                                            LGN strongly reduces the degree of end-inhibition in LGN cells .
         ©             Our simulation results suggest that certain extra-classical RF                        Also, extra-classical RF effects in layer 2/3 neurons in alert mon-
                       effects could be an emergent property of the cortex using an effi-                    key V1 often manifest themselves only 80–100 milliseconds after
                       cient hierarchical and predictive strategy for encoding natural                       stimulus onset, suggesting that feedback from higher areas may be
                       images. In this model, cortical neurons showing extra-classical                       involved in mediating these effects33.
                       effects are interpreted as error-detecting neurons that signal the                        The simulation results show that extra-classical RF effects can
                       difference between an input and its prediction from a higher visu-                    occur in the predictive coding model under either Gaussian
                       al area. In particular, the layer 2/3 neurons that send axons to the                  (Figs 3 and 5) or sparse kurtotic (Fig. 6) prior distributions for
                       higher visual area are posited to be likely candidates for this func-                 the network activities. The issue of prior distributions has been
                                                                                                                                12,31,32
                       tion. In the model, predictions are made based on progressively                       much discussed             , with kurtotic distributions being favored
                       larger spatial contexts as one ascends the visual hierarchy. As a                     because they can produce localized receptive fields and sparse
                       result, when the stimulus properties in a neuron’s receptive field                    codes. Our results suggest that the effects can be obtained under
                       match the stimulus properties in the surrounding region, little                       both sparse and non-sparse prior distributions, as long as one
                       response is evoked from the error-detecting neurons because the                       interprets the effects as being caused due to residual errors in pre-
                       ‘surround’ can predict the ‘center.’ On the other hand, when the                      diction based on an internal model of natural image statistics.
                       stimulus occurs in isolation, such a prediction fails, eliciting a                        The predictive coding model does not rule out the possibility
                       relatively large response. This behavior can be viewed as a refine-                   that certain extra-classical contextual effects may result from
                       ment of the types of predictive coding observed at the retina17–19                    recurrent lateral inhibition mediated by long-range horizontal
                       and the LGN20,21 involving spatiotemporal prediction based on                         connections within the same visual area39. In fact, the equation
                       weighted averages of spatially/temporally local pixels and sub-                       for the dynamics of the network can be rewritten such that some
                       traction of this prediction from current pixel values.                                of the effects of feedback are replaced by recurrent lateral inter-
                           The model predicts that layer 2/3 neurons will respond most                       actions (Methods, Equation 8; refs 32, 40). In addition, the repet-
                       vigorously to stimuli whose statistics differ in certain drastic ways                 itive subtraction of neighboring neuronal activities (Equation 8)
                                                                                                                                                                                      41
                       from natural image statistics (as in, for example, Fig. 6). This                      may produce a net effect similar to divisive normalization , an
                       raises the interesting possibility of discovering novel extra-classical               operation that reproduces certain extra-classical effects in sim-
                       RF effects by explicitly constructing stimuli that deviate from                       ulations (Simoncelli, E. P., results presented at the 1998 Center
                       natural image statistics. In addition, termination of cortical feed-                  for Visual Science Symposium, Rochester, New York, 1998).
                       84                                                                                                         nature neuroscience  •  volume 2  no 1  •  january 1999
                                                                    © 1999 Nature America Inc. • http://neurosci.nature.com
                                                                                                                                                                 articles
                       a                         1                                                b
                                                                                                                              1.4
                      Orientation contrast
                     Orientation Contrast                                                                                     1.2
                           Grating             0.8                                                Pop-out texture
                             grating                                                             Pop-Out Texture
                                                                                                                                1
                                               0.6                                                                            0.8
                                               0.4                                                                          ResponseResponse0.6
                                              ResponseResponse                                                                0.4
                                               0.2                                                                            0.2
                                                 0                                                                              0
                     Fig. 6. Nonclassical surround effects in the model. (a) Responses             c
                                                                                                     Homogeneous
                     of an error-detecting model neuron to oriented gratings in the                   Homogeneous             0.08
                                                                                                     Random Texture
                     classical (center region) and extra-classical RF (surrounding                   random texture
                             36. An oriented grating in the classical RF produced a                                                                      Orientation Contrast
                     region)                                                                                                  0.06                       Homogeneous
                     robust response (first bar in the bar graph), which was sup-
                     pressed when a grating at the same orientation was introduced in
                     the surrounding extra-classical region (second bar). Introducing                                       ResponseResponse0.04
                     an orientation contrast between center and surround increased                Orientation contrast
                     the response beyond the center-only response (third bar). An                  Orientation Contrast
                                                                                                                              0.02
                     optimally oriented grating in the surround only elicited a small
                     response (fourth bar). (b) Responses of an error-detecting model
                     neuron to texture stimuli used in ref. 35. The largest response                                             0 0    10   20    30    40   50    60    70
                                                                                                                                           Time (number of iterations)
                     was elicited by the ‘pop-out’ texture stimulus (compare with Fig.                                                   Time (number of iterations)
                     4 of ref. 35). (c) Extra-classical contextual modulation in the tem-
                     poral response of an error-detecting model neuron, when
          http://neurosci.nature.comexposed to the random texture stimuli used in ref. 33. The tonic phase of the response reveals a large positive difference developing over
         •
                     time for the orientation-contrast texture as compared to the homogeneous stimulus (compare with Fig. 2 of ref. 33).
                         Some extra-classical RF effects involve facilitatory rather than           from actual inputs in cerebellum-like structures in several dis-
                                            39                                                                             46
                     inhibitory responses . In other words, the presence of a stimulus              tinct classes of fishes  . In this case, the sensory prediction is gen-
                     in the surround may facilitate rather than inhibit the neural                  erated using not only recent sensory inputs but also corollary
                     response elicited by a stimulus in the center alone. Some examples             discharge or proprioceptive signals associated with motor com-
                     of such facilitatory effects in the model are shown in Fig. 6, but             mands. Finally, the responses of dopaminergic neurons project-
         1999 Nature America Inc. other facilitatory effects may reflect a bipolar strategy for encod-ing to the cortex and striatum from the midbrain can often be
          
         ©           ing prediction errors. Because these errors can be either positive             characterized as encoding reward prediction errors: large respons-
                     or negative, the cortex may use two distinct populations of neu-               es are elicited whenever actual rewards do not match the pre-
                                                                                                                                              47
                     rons to signal errors, one for positive and another for negative               dicted rewards in a behavioral task . These examples suggest
                     errors, in analogy with the existence of on-center, off-surround               that the general idea of predictive coding may be applicable across
                     and off-center, on-surround cells in the early visual pathway.                 different brain regions and modalities, providing a useful frame-
                         Although we have focused on interpreting responses in V1,                  work for understanding the general structure and function of
                                                                                                                    22,48
                     the general idea of predictive coding may help explain certain                 the neocortex        .
                     responses in other brain regions as well. For example, some neu-
                     rons in MT are suppressed when the direction of stimulus motion                Methods
                     in the surrounding region matches that in the center of the clas-              HIERARCHICAL GENERATIVE MODEL. Consider an image I represented as a
                              6                                                                     vector of n pixels. We assume that the cortex tries to represent the image
                     sical RF . This suggests a hierarchical predictive coding strategy
                     for motion analogous to the one suggested here for image fea-                  in terms of hypothetical causes, as represented by a vector r. We charac-
                     tures. Although the precise details of such a strategy are far from            terize the relationship between the causes r and the image I using the
                     clear, a testable prediction of such a model would be a significant            function f and a matrix U:
                     reduction in extra-classical effects in layer 2/3 neurons in MT                I = f (Ur) + n                                                      (1)
                     upon inactivation of feedback from a higher area such as MST.                  where n is a stochastic noise process characterizing the differences
                     Certain neurons in the anterior inferotemporal (IT) cortex of                  between I and f(Ur). Note that
                     alert behaving monkeys fire vigorously whenever a presented test
                     stimulus does not match the item held in memory, though show-                             k
                                                                                                    f (Ur) = f (  Ur)                                                   (2)
                                                                            42                                 ∑ j j
                     ing little or no response in the case of a match . This suggests                          j=1
                     an interpretation of these responses in terms of residual error                where U are columns of U, representing basis vectors for generating
                     signals between a test stimulus and a predicted item from mem-                          j
                     ory. Whether such a model can also account for the very specif-                images. Thus, each image I is assumed to be generated by a linear super-
                                                                    43,44                           position of the basis vectors followed by a possible nonlinearity f. In
                     ic face and view-sensitive cells in IT               remains unclear           terms of a neural network, the coefficients r correspond to the activities
                     (however, see ref. 45). A third example suggestive of predictive                                                            j
                                                                                                    or firing rates of neurons, whereas the basis vectors U correspond to the
                                                                                                                                                          j
                     coding is the generation and subtraction of sensory expectations               synaptic weights of neurons. The function f(x) is the neuronal activa-
                     nature neuroscience  •  volume 2  no 1  •  january 1999                                                                                               85
                                                                                          © 1999 Nature America Inc. • http://neurosci.nature.com
                            articles
                            tion function, typically a sigmoidal function such as tanh(x). The coef-                                where k1 is a positive constant governing the rate of descent towards a
                            ficients r can be regarded as the network’s internal representation of the                              minimum for E, x= Ur, and g´is the derivative of g with respect to r. In
                                        j
                            spatial characteristics of the image I, as interpreted using the internal                               the linear case (f(x) =x),
                            model defined by the basis vectors U.                                                                       T
                                                                              j                                                      ∂f 
                                                                                                                                     —
                               To make this model hierarchical, we assume that the causes r them-                                    ∂x
                            selves can be represented as a set of higher-level causes rh representing                               is the identity matrix and in the case where f(x) = tanh(x),
                            more abstract stimulus properties than the lower level. This yields the                                  ∂f                     2
                                                                                                                                     —=(1 – tanh(x) ). 
                            equation:                                                                                                ∂x
                                                                                                                                    Similarly, for a Gaussian prior distribution, g´(r) = 2α r and for the kur-
                            r = rtd + ntd                                                                              (3)                                                                                         2
                                                                                                                                    totic prior distribution in Equation 6, g´(r ) = 2α r /(1+r ) (ref. 32).
                                                                                                                                                                                             i           i        i
                                       td        h h                                                            td                      To modify r toward the optimal estimate (Equation 7), one needs the
                            where r = f(U r ) is the ‘top-down’ prediction of r, and n                             is a sto-                                                                                                 td
                            chastic noise process.                                                                                  ‘bottom-up’ residual error (I – f(Ur)) and the ‘top-down’ error (r                          – r).
                               Because the dendritic arbors of neurons can only span a finite spatial                               The bottom-up error is multiplied by the transpose of the gradient and
                                                                                                                                                            T
                            extent, we limit the size of I at the lowest level so that only a local por-                            the basis matrix U , and a decay term g´(r) due to the prior probability of
                            tion of the actual image is being generated by a given set of causes r. The                             r is subtracted. Note that all the information required is available local-
                            higher-level vector rh, however, generates several sets of these causes r                               ly at each level. The weight accorded to the top-down and bottom-up
                            associated with local neighboring image regions. Thus, a given image is                                 errors is inversely proportional to their respective noise variances: the
                            generated by groups of local causes r, several groups being generated by                                larger the noise variance, the smaller the weight (see ref. 12). In a neur-
                                                                                                                                    al implementation (Fig. 1b), each row of the matrix UT corresponds to
                                                                 h
                            a single higher-level vector r , several of which are in turn generated by an                           the synaptic weights of a single neuron.
                            even higher level of causes until the entire image is accounted for. This
                            results in increasing receptive field size as one ascends the hierarchy, sim-                               In the linear case (f(x) =x), the above dynamics can be rewritten to
                                                                                                              29                    allow lateral interactions32,40:
                            ilar to that observed in the occipitotemporal visual pathway . To allow
                            prediction in time for time-varying images, the model can be extended                                    dr     k            k                k             k
                                                                                                                                              1   T       1    td           1             1
                                                                                                                                     — —                —
                                                                                                                                         =      U I +      (r     – r) –      g´(r) –      Wr                                  (8)
                            using a set of recurrent synaptic weights V that recursively transform the                                        2           2               —             —
                                                                                                                                     dt     σ           σ                  2              2
                            vector r(t) at time t to the predicted vector r(t+1) at time t+1: r(t+1) =                                                    td                            σ
                            f(Vr(t)) + m where m is a noise process. Because static images sufficed                                 where W = UTU. In this implementation, the neural responses r under-
                            for our simulation results, we did not use the temporal prediction com-                                 go recurrent lateral inhibition due to the term 
                            ponent, but the interested reader is referred to refs 12 and 49 for more                                 k
                                                                                                                                      1 Wr,
                            details.                                                                                                 —
                                                                                                                                       2
            http://neurosci.nature.com                                                                                               σ
           •                OPTIMIZATION FUNCTION. The goal is to estimate, for each hierarchical                                   where the ith row of W represents the lateral weights for the ith neuron
                            level, the coefficients r for a given image and, on a longer time scale, learn                          that maintains the estimate r. Such lateral connections between neurons
                                                                                                                                                                           i
                            appropriate basis vectors Uj for each hierarchical level. Assuming that                                 maintaining r may thus also be involved in mediating some of the extra-
                                                            td                                                              2       classical RF effects observed in the visual cortex (see Discussion).
                            the noise terms n and n            are Gaussian with zero mean and variances σ
                            and σ 2respectively, one can write the following optimization function:                                     A synaptic learning rule for adapting the basis matrix U can be
                                    td
                                    1                 T                     1          td T        td                               obtained by performing gradient descent on E with respect to U:
                                   —                                       —
                            E =       (I – f (Ur)) (I – f (Ur)) +       (r – r ) (r – r )                              (4)
                              1    σ2                                      σ2                                                                 k          k      T
                                                                             td                                                     dU         2 ∂E        2 ∂f                   T 
                                                                                                                                     — —— —
                                                                                                                                         = –            =            (I – f (Ur))r  – k λU                                     (9)
                                                                                                                                     dt       2 ∂U         2 —                          2
                            where the superscript T denotes the transpose of a vector or matrix. Note                                                    σ ∂x
           1999 Nature America Inc. that E1 is the negative logarithm of the probability of the data given the                      where k is a positive parameter determining the learning rate of the net-
                            parameters. It is the sum of squared prediction errors for level 1 and level                                       2
           ©                                                                                                                        work and x= Ur. Note that this learning rule is a form of Hebbian adap-
                            2, each term being weighted by the respective inverse variances. Taking                                 tation, the presynaptic activity being r and the postsynaptic activity being
                            into account the prior distributions of r and U, one obtains the opti-                                  the residual error (I – f (Ur)) (see Fig. 1b). 
                            mization function:                                                                                      Although the top-down feedback rtd does not appear explicitly in the
                            E = E + g(r) + h(U)                                                                        (5)          learning rule for U, it nevertheless influences the estimation of r (see
                                   1
                                                                                                                                    Equation 7) and hence, also U.
                            where g(r) and h(U) are the negative logarithms of the prior probabilities of                           SIMULATIONS. For the endstopping simulations, five natural images of dif-
                            r and U respectively. For the endstopping simulations, we used Gaussian                                 ferent sizes (Fig. 2a) were first filtered using a center-surround difference-
                            prior distributions for both these model parameters because this was suffi-                             of-Gaussians operator to approximate processing at the levels of the retina
                            cient to illustrate the properties of the model. This results in g(r) = αΣ r2and
                                                  2                                                                 i i             and the LGN (see also ref. 26). During the training phase, three 16 × 16
                            h(U) = λΣ U             where αand λare positive constants related to the vari-
                                           i,j  i,j                                                                                 overlapping Gaussian-windowed image patches (offset by 5 pixels hori-
                            ance of the Gaussian prior distributions. Localized receptive fields can be                             zontally) were input to the three level-1 modules (Fig. 1c). The respons-
                            obtained by using sparse kurtotic prior distributions for r (refs 26,31), e.g.,                         es from the level-1 modules at each time instant were input as a single
                                                        2                                                                           vector to the level-2 module. The effective level-2 RF thus encompassed a
                            g(r) = α ∑ log(1 + ri )                                                                    (6)
                                         i                                                                                          16 × 26 image region spanned by the three overlapping circles (Fig. 2a).
                            This choice was used for the extra-classical surround experiments in Fig.                               For simplicity, a linear generative model (f(x) =x) was used in the end-
                            6. Note that by Bayes Theorem, minimizing E is equivalent to maximiz-                                   stopping simulations. Each level-1 module consisted of 32 feedforward
                            ing the posterior probability of the model parameters given the input                                                                    T
                                                                                                                                    neurons representing U (size 32 × 256), 32 neurons that maintained r
                            data. In the context of information theory, E can be interpreted as rep-                                (according to equation 7), 32 error-detecting neurons that propagated to
                            resenting the cost of coding the errors and parameters in bits (in base e).                                                                            td
                                                                                                                                    level 2 the top-down residual (r – r ), and a set of 256 feedback neurons
                            Thus, minimizing E is equivalent to using the minimum description                                       whose synaptic efficacies encoded the rows of U and that conveyed the
                                                  50
                            length principle , which requires solutions to be not only accurate but                                 prediction Urto level 0. The level-2 module consisted of 128 feedforward
                            also cheap in terms of coding length.                                                                   neurons receiving inputs from the three level-1 modules, 128 neurons for
                                                                                                                                                       h
                            NETWORKDYNAMICSANDSYNAPTICLEARNING.An optimal estimate of rcan                                          maintaining r , and 96 feedback neurons whose synapses encoded rows
                                                                                                                                          h                                                  h h
                            be obtained by performing gradient descent on E with respect to r:                                      of U and which conveyed the prediction U r to level 1. Parameter values:
                                                                                                                                                  2            2
                                                                                                                                    k = 0.5, σ = 1, σ            = 10, α = 1 for level 1 and 0.05 for level 2, and λ =
                             dr       k          k           T                   k                 k                                  1                      td
                                       1 ∂E       1    T ∂f                        1   td           1                               0.02. The learning rate k was initially set to 1 and decreased gradually by
                            — —— — —                                             —                 —                                                                 2
                                = –            =      U       (I – f (Ur)) +      (r      – r) –      g´(r)            (7)
                            dt        2 ∂r         2      ∂x                       2               2
                                                 σ                              σ                                                   dividing with 1.015 after every 40 training inputs.
                                                                                   td
                            86                                                                                                                                nature neuroscience  •  volume 2  no 1  •  january 1999
                                                                              © 1999 Nature America Inc. • http://neurosci.nature.com
                                                                                                                                                                                         articles
                           For the extra-classical RF simulations in Fig. 6, a nonlinear hierarchical                   inhibition in the retina. Proc. R. Soc. Lond. B Biol. Sci. 216, 427–459 (1982).
                        generative model (f(x) = tanh(x)) was used at levels 1 and 2 of the three-                 20. Dan, Y., Atick, J. J. & Reid, R. C. Efficient coding of natural scenes in the
                        level hierarchical network, along with a kurtotic prior distribution for r                      lateral geniculate nucleus: experimental test of a computational theory. J.
                        (Equation 6). Nine level-1 modules, each with 32 feedforward model neu-                         Neurosci. 16, 3351–3362 (1996).
                        rons and each analyzing a local 8 × 8 pixel image region, were arranged                    21. Dong, D. W. & Atick, J. J. Temporal decorrelation: a theory of lagged and
                                                                                                                        nonlagged responses in the lateral geniculate nucleus. Network Comput.
                        in a 3 × 3 overlapping configuration to analyze a 14 × 14 pixel image                           NeuralSys.6, 159–178 (1995).
                        region. The level-2 module included 64 feedforward model neurons. The                      22. Mumford, D. On the computational architecture of the neocortex. II. The
                        network was trained on ten prewhitened natural images and during train-                         role of cortico-cortical loops. Biol. Cybern. 66, 241–251 (1992).
                        ing, the gain of each basis vector in U was adapted so as to maintain equal                23. Pece, A. E. C. in Artificial Neural Networks 2 (eds Aleksander, I. & Taylor, J.)
                                                                                                                        865–868 (Elsevier, Amsterdam, 1992).
                        variance on each r (see ref. 26 for more details). The level-1 basis vectors               24. Softky, W. R. in Advances in Neural Information Processing Systems 8 (eds
                                              i                                                                         Touretzky, D., Mozer, M. & Hasselmo, M.) 809–815 (MIT Press, Cambridge,
                        were learned first, followed by the level-2 basis vectors.                                      MA, 1996).
                                                                                                                   25. Ullman, S. in Large-Scale Neuronal Theories of the Brain (eds Koch, C. &
                        Acknowledgements                                                                                Davis, J. L.) 257–270 (MIT Press, Cambridge, MA, 1994).
                                                                                                                   26. Olshausen, B. A. & Field, D. J. Sparse coding with an overcomplete basis set:
                        We thank Christof Koch for comments on the manuscript and Mary Hayhoe,                          A strategy employed by V1? Vision Res. 37, 3311–3325 (1997).
                        Terrence Sejnowski and members of the Computational Neurobiology Lab at the                27. Dayan, P., Hinton, G.E., Neal, R.M. & Zemel, R.S. The Helmholtz machine.
                        Salk Institute for discussions. This work was supported by research grants from                 NeuralComput.7, 889–904, (1995).
                                                                                                                   28. Luettgen, M. R. & Willsky, A. S. Likelihood calculation for a class of
                        the National Institute of Health (NIH), the National Science Foundation (NSF)                   multiscale stochastic models, with application to texture discrimination.
                        and the Alfred P. Sloan Foundation.                                                             IEEETrans.ImageProc.4, 194–207 (1995).
                                                                                                                   29. Felleman, D. J. & Van Essen, D. C. Distributed hierarchical processing in the
                        RECEIVED29 JUNE; ACCEPTED18 NOVEMBER1998                                                        primate cerebral cortex. Cereb. Cortex 1, 1–47 (1991).
                                                                                                                   30. Field, D. J. Relations between the statistics of natural images and the response
                                                                                                                        properties of cortical cells. J. Opt. Soc. Am. A 4, 2379–2394 (1987).
                                                                                                                   31. Bell, A. J. & Sejnowski, T. J. The “independent components” of natural scenes
                        1.  Hubel, D. H. & Wiesel, T. N. Receptive fields and functional architecture in                are edge filters. Vision Res. 37, 3327–3338 (1997).
                            two non-striate visual areas (18 and 19) of the cat. J. Neurophysiol. 28,              32. Olshausen, B. A. & Field, D. J. Emergence of simple-cell receptive field
                            229–289 (1965).                                                                             properties by learning a sparse code for natural images. Nature 381, 607–609
                        2.  Hubel, D. H. & Wiesel, T. N. Receptive fields and functional architecture of                (1996).
                            monkey striate cortex. J. Physiol. (Lond.) 195, 215–243 (1968).                        33. Zipser, K., Lamme, V. A. F. & Schiller, P. H. Contextual modulation in
                        3.  Bolz, J. & Gilbert, C. D. Generation of end-inhibition in the visual cortex via             primary visual cortex. J. Neurosci. 16, 7376–7389 (1996).
                            interlaminar connections. Nature 320, 362–365 (1986).                                  34. Sandell, J. H. & Schiller, P. H. Effect of cooling area 18 on striate cortex cells in
                        4.  Hubel, D. H. & Livingstone, M. S. Segregation of form, color, and stereopsis                the squirrel monkey. J. Neurophysiol. 48, 38–48 (1982).
           http://neurosci.nature.comin primate area 18. J. Neurosci. 7, 3378–3415 (1987).                         35. Knierim, J. & Van Essen, D. C. Neural responses to static texture patterns in
          •             5.  Desimone, R. & Schein, S. J. Visual properties of neurons in area V4 of the                 area V1 of the alert macaque monkey. J. Neurophysiol. 67, 961–980 (1992).
                            macaque: sensitivity to stimulus form. J. Neurophysiol. 57, 835–868 (1987).            36. Sillito, A. M., Grieve, K. L., Jones, H. E., Cudeiro, J. & Davis, J. Visual cortical
                        6.  Allman, J., Miezin, F. & McGuinness, E. Stimulus specific responses from                    mechanisms detecting focal orientation discontinuities. Nature 378, 492–496
                            beyond the classical receptive field: Neurophysiological mechanisms for                     (1995).
                            local-global comparisons in visual neurons. Annu.Rev.Neurosci.8, 407–429               37. Hupé, J. M. et al. Cortical feedback improves discrimination between figure
                            (1985).                                                                                     and background by V1, V2 and V3 neurons. Nature 394, 784–787 (1998).
                        7.  Dobbins, A., Zucker, S. W. & Cynader, M. S. Endstopped neurons in the                  38. Murphy, P. C. & Sillito, A. M. Corticofugal feedback influences the generation
                            visual cortex as a substrate for calculating curvature. Nature 329, 438–441                 of length tuning in the visual pathway. Nature 329, 727–729 (1987).
                            (1987).                                                                                39. Gilbert, C. D. Adult cortical dynamics. Physiol. Rev. 78, 467–485 (1998).
                        8.  Bolz, J., Gilbert, C. D. & Wiesel, T. N. Pharmacological analysis of cortical          40. Lee, D. D. & Seung, H. S. in Advances in Neural Information Processing
                            circuitry. Trends Neurosci. 12, 292–296 (1989).                                             Systems 9 (eds Mozer, M., Jordan, M. & Petsche, T.) 515–521 (MIT Press,
                        9.  Peterhans, E. & von der Heydt, R. in Representations of Vision. Trends and                  Cambridge, MA, 1997).
          1999 Nature America Inc. Tacit Assumptions (eds Gorea, A., Frégnac, Y., Kapoulis, Z. & Findlay, J.)      41. Heeger, D. J., Simoncelli, E. P. & Movshon, J. A. Computational models of
                            111–124 (Cambridge Univ. Press, Cambridge, UK, 1991).
          ©                                                                                                             cortical visual processing. Proc. Natl. Acad. Sci. USA 93, 623–627 (1996).
                        10. Grossberg, S., Mingolla, E. & Ross, W. D. Visual brain and visual perception: how      42. Miller, E. K., Li, L. & Desimone, R. A neural mechanism for working and
                            does the cortex do perceptual grouping? TrendsNeurosci.20, 106–111 (1997).                  recognition memory in inferior temporal cortex. Science 254, 1377–1379
                        11. Peterhans, E. & von der Heydt, R. Subjective contours—bridging the gap                      (1991).
                            between psychophysics and physiology. Trends Neurosci. 14, 112–119 (1991).             43. Gross, C. G. & Sergent, J. Face recognition. Curr. Opin. Neurobiol. 2, 156–161
                        12. Rao, R. P. N. & Ballard, D. H. Dynamic model of visual recognition predicts                 (1992).
                            neural response properties in the visual cortex. Neural Comput. 9, 721–763             44. Logothetis, N. K. & Pauls, J. Psychophysical and physiological evidence for
                            (1997).                                                                                     viewer-centered object representations in the primate. Cereb. Cortex 5,
                        13. Gallant, J. L., Connor, C. E. & Van Essen, D. C. Neural activity in areas V1, V2            270–288 (1995).
                            and V4 during free viewing of natural scenes compared to controlled viewing.           45. Poggio, T. & Edelman, S. A network that learns to recognize 3D objects.
                            Neuroreport9, 2153–2158 (1998).                                                             Nature 343, 263–266 (1990).
                        14. Attneave, F. Some informational aspects of visual perception. Psychol.Rev.61,          46. Bell, C., Bodznick, D., Montgomery, J. & Bastian, J. The generation and
                            183–193 (1954).                                                                             subtraction of sensory expectations within cerebellum-like structures. Brain
                        15. MacKay, D. M. in Automata Studies (eds Shannon, C. E. & McCarthy, J.)                       Behav.Evol.50Suppl. 1, 17–31 (1997).
                            235–251 (Princeton Univ. Press, Princeton, NJ, 1956).                                  47. Schultz, W. et al. in Models of Information Processing in the Basal Ganglia (eds
                        16. Barlow, H. B. in Sensory Communication (ed. Rosenblith, W. A.) 217–234                      Houk, J. C., Davis, J. L. & Beiser, D. G.) 233–248 (MIT Press, Cambridge,
                            (MIT Press, Cambridge, MA, 1961).                                                           MA, 1995).
                        17. Atick, J. J. Could information theory provide an ecological theory of sensory          48. Creutzfeldt, O. D. Generality of the functional structure of the neocortex.
                            processing? NetworkComput.NeuralSys.3, 213–251 (1992).                                      Naturwissenschaften64, 507–517 (1977).
                        18. Buchsbaum, G. & Gottschalk, A. Trichromacy, opponent colours coding and                49. Rao, R. P. N. An optimal estimation approach to visual perception and
                            optimum colour information transmission in the retina. Proc.R.Soc.Lond.B                    learning. Vision Res. (in press).
                            Biol. Sci. 220, 89–113 (1983).                                                         50. Rissanen, J. Stochastic Complexity in Statistical Inquiry (World Scientific,
                        19. Srinivasan, M. V., Laughlin, S. B. & Dubs A. Predictive coding: A fresh view of             Singapore, 1989).
                        nature neuroscience  •  volume 2  no 1  •  january 1999                                                                                                                      87
