                        QS     Matching      mAP       mAP      mAP                        Pretrain on
                                                  25       50                                                            Instance   Semantic
                                                                                        Scan-     Struc-     Pooling     mAP         mIoU
                    SPFormer, baseline                                                   Net     tured3D                      50
                               Hungarian      82.9      73.9     56.3
                    OneFormer3D,ours                                                 SPFormer, baseline
                               Hungarian      84.4      75.6     58.0                     ✓                 superpoint     66.8
                        ✓      Hungarian      84.6      75.9     58.1                OneFormer3D,ours
                        ✓     disentangled    86.4      78.1     59.3                                         voxel        60.5       59.1
                                                                                          ✓                   voxel        68.5       69.3
              Table 5. Comparison of query initialization and matching strate-            ✓                 superpoint     67.1       68.1
              gies on the ScanNet validation split. QS is our query selection.                      ✓         voxel        65.1       66.2
                                                                                          ✓         ✓         voxel        72.0       72.4
              4.3. Ablation Studies                                               Table 6. Ablation study of pretraining and feature pooling on
                                                                                  S3DIS Area 5. We demonstrate the benefits of pretraining on the
              Queryselection&disentangledmatching.             First, we ab-      mixture of real ScanNet and synthetic Structured3D data.
              late key novel components of our pipeline on the Scan-
              Net validation split, and report the results in Tab. 5. In              Instance   Semantic    Instance   Semantic    Panoptic
              this study, we only compare instance segmentation metrics,              queries     queries    mAP50       mIoU         PQ
              since both ablated components do not affect semantic seg-                  ✓                     78.1
              mentation. SPFormer [32] uses random query initialization                             ✓                     72.8
              and Hungarian matching strategy; we evaluate it with the                   ✓          ✓          78.1       76.6        71.2
              same backbone for a fair comparison. Evidently, our reim-
              plementation with joint instance and semantic training has          Table 7. Benefits of joint instance-semantic training on ScanNet
              a minor gain over the baseline. Besides, our query selec-           validation split. Not only OneFormer3D allows panoptic segmen-
              tion scheme does not improve the quality if combined with           tation for free, but also improves semantic segmentation.
              the baseline bipartite matching scheme. But, the synergy
              of these two modifications allows for the state-of-the-art re-      Joint training.   Training a single unified model but three
              sults, improving mAP , mAP , and mAP by at least +1.3.
                                     25      50                                   reducesthetrainingtimethreetimes,but,moreimportantly,
                                                                                  it also improves segmentation metrics. As can be seen from
              Pretraining and pooling.      Previous state-of-the-art meth-       Tab. 7, instance segmentation accuracy remains unchanged,
              ods [3, 31, 32, 35] use pretraining to achieve the highest          while the accuracy of semantic predictions grows by as
              scores on S3DIS, as this dataset is fairly small, with 272          much as +3.4 mIoU. We assume that using a large trans-
              scenes in total. Following the best practices, we pre-train         former decoder causes overfitting for a semantic segmen-
              our OneFormer3DonScanNet,whichgivessignificantper-                  tation task, but adding an extra instance segmentation task
              formance boost: +8.0 mAP         and +10.2 mIoU (Tab. 6).           serves as a regularization and reduces the overfitting, hence
                                            50                                    improving semantic scores. For instance segmentation, the
              Whenbeingpretrained on ScanNet, OneFormer3D and SP-                 improvement is negligible, mainly because semantic anno-
              Formerdemonstratecomparableresults. Wealsoleveragea                 tations for all non-stuff classes can be derived from instance
              large scale synthetic Structured3D [50] dataset for pretrain-       one, so adds limited new information for model training.
              ing, which is an order of magnitude larger than ScanNet,
              with as many as 21835 scenes. In this experiment, benefits          5. Conclusion
              from using a larger amount of training data exceed the pos-
              sible negative effect of a domain gap: the best results are         In this paper, we proposed a novel transformer-based
              achieved with pretraining on a mixture of real and synthetic        framework, OneFormer3D, that unifies three 3D point
              data, bringing at least +11.5 in both mAP     and mIoU.             cloud segmentations tasks: instance, semantic, and panop-
                                                         50                       tic. Trained only once on a panoptic dataset, OneFormer3D
                 Besides, we investigate how our flexible pooling affects         consistently outperforms existing segmentation approaches
              the final performance. To this end, we switch it off by re-         – even though they are trained separately on each task.
              placing superpoints with voxels of 5cm. According to the            Wealso identified the weaknesses of existing transformer-
              Tab.  6, the gain is at least of +1.2 in both mAP50 and             based 3D instance segmentation methods, and addressed
              mIoU. Yet, we should mention that superpoint clustering             them with a novel query selection and disentangled
              takes almost a half of the entire inference time, so removing       matching strategies. In extensive experiments on ScanNet,
              it causes at least two times speed-up and eliminates the need       ScanNet200, and S3DIS, OneFormer3D established a
              to select and tune such an algorithm for each dataset.              new state-of-the-art in all three 3D segmentation tasks.
                                                                              20950
