                                  1550                                                                                      G.Hinton,S.Osindero,andY.-W.Teh
                                  mixes properly, we will eventually obtain unbiased samples from the joint
                                  distribution given in equation A.6.
                                         Nowlet us imagine that we unroll this sequence of Gibbs updates in
                                  space, suchthatweconsidereachparallelupdateofthevariablestoconsti-
                                  tutestatesofaseparatelayerinagraph.Thisunrolledsequenceofstateshas
                                  a purely directed structure (with conditional distributions taking the form
                                  of equations A.4 and A.5 and in alternation). By equivalence to the Gibbs
                                  sampling scheme, after many layers in such an unrolled graph, adjacent
                                  pairs of layers will have a joint distribution as given in equation A.6.
                                         Wecanformalizetheaboveintuitionforunrollingthegraphasfollows.
                                  Thebasicideaistounrollthegraph“upwards”(i.e.,movingawayfromthe
                                  data),sothatwecanputawell-deﬁneddistributionovertheinﬁnitestackof
                                  variables.Thenweverifysomesimplemarginalandconditionalproperties
                                  ofthejointdistributionandthusdemonstratetherequiredpropertiesofthe
                                  graphinthe“downwards”direction.
                                         Let x = x(0),y = y(0),x(1),y(1),x(2),y(2),...be a sequence (stack) of vari-
                                  ables, the ﬁrst two of which are identiﬁed as our original observed and
                                  hiddenvariable. Deﬁne the functions
                                                        
      
         1             	                        
      
         
  


                                                 f (x , y ) =                 exp                    (x,y)+                             γ (x ) +                   α (y )                         (A.8)
                                                                         Z                              i, j     i     i                    i     i                     j     j
                                                                                             i, j                                   i                          j
                                                      fx(x
)= f(x
,y
)                                                                                                                            (A.9)
                                                                            

                                                                          y
                                                      fy(y
)= f(x
,y
)                                                                                                                         (A.10)
                                                                            

                                                                          x
                                                gx(x
|y
)= f(x
,y
)/fy(y
)                                                                                                                      (A.11)
                                                gy(y
|x
)= f(x
,y
)/fx(x
),                                                                                                                     (A.12)
                                  anddeﬁneajointdistributionoveroursequenceofvariablesasfollows:
                                                           (0)       (0)              (0)         (0)
                                                   P(x ,y )= f x ,y                                                                                                                             (A.13)
                                                        (i)      (i−1)                 (i)        (i−1)
                                                P(x |y                   ) =gxx |y                                       i = 1,2,...                                                          (A.14)
                                                     P(y(i)|x(i))=gy y(i)|x(i) .                                           i = 1,2,...                                                          (A.15)
                                  We verify by induction that the distribution has the following marginal
                                  distributions:
                                                P(x(i))= fxx(i)                              i = 0,1,2,...                                                                                    (A.16)
                                                P(y(i))= fyy(i)                              i = 0,1,2,...                                                                                    (A.17)
