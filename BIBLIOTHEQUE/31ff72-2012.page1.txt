                    Learning Semantic String Transformations from Examples
                                                                              ∗
                                                   Rishabh Singh                                                                 Sumit Gulwani
                                             MITCSAIL,Cambridge,MA                                                  Microsoft Research, Redmond, WA
                                              rishabh@csail.mit.edu                                                       sumitg@microsoft.com
                   ABSTRACT                                                                                 professional programmers, but they need to create small,
                   We address the problem of performing semantic transfor-                                  often one-oﬀ, applications to support business functions [6].
                   mations on strings, which may represent a variety of data                                   Unfortunately, the programming experience since incep-
                   types (or their combination) such as a column in a relational                            tion has mostly focused on serving the needs of a select class
                   table, time, date, currency, etc. Unlike syntactic transfor-                             of few million skilled users. In particular, spreadsheet sys-
                   mations, which are based on regular expressions and which                                tems like Microsoft Excel allow sophisticated users to write
                   interpret a string as a sequence of characters, semantic trans-                          macros using a rich inbuilt library of string and numerical
                   formations additionally require exploiting the semantics of                              functions, or to write arbitrary scripts using a variety of
                   the data type represented by the string, which may be en-                                programming languages like Visual Basic, or .NET. Since
                   coded as a database of relational tables. Manually perform-                              end-users are not proﬁcient in programming, they ﬁnd it too
                   ing such transformations on a large collection of strings is                             diﬃcult to write desired macros or scripts.
                   error prone and cumbersome, while programmatic solutions                                    The combination of the above-mentioned technical trends
                   are beyond the skill-set of end-users.                 We present a pro-                 and lack of a satisfactory solution has led to a marketplace
                                                                                                                                                                               1
                   gramming by example technology that allows end-users to                                  of hundreds of advertisement-driven help-forums , some of
                   automate such repetitive tasks.                                                          whichcontainmillions of posts from end-users soliciting help
                      We describe an expressive transformation language for                                 for scripts to manipulate data in their spreadsheets. The ex-
                   semantic manipulation that combines table lookup opera-                                  perts respond to these requests after some time. From an
                   tions and syntactic manipulations. We then present a syn-                                extensive case study of such spreadsheet help-forums, we ob-
                   thesis algorithm that can learn all transformations in the                               served the following two things.
                   language that are consistent with the user-provided set of                               Semantic String Transformations: Several of the re-
                   input-output examples. We have implemented this technol-                                 quested scripts/macros were for manipulating strings that
                   ogy as an add-in for the Microsoft Excel Spreadsheet system                              need to be interpreted as more than a sequence of charac-
                   and have evaluated it successfully over several benchmarks                               ters, e.g., as a column entry from some relational table, or
                   picked from various Excel help-forums.                                                   as some standard data type such as date, time, or currency.
                                                                                                            (See §2 for a motivating example.) In this paper, we de-
                   1.     INTRODUCTION                                                                      scribe the systematic design of a semantic transformation
                                                                                                            language for manipulating such strings.
                      The IT revolution over the past few decades has resulted                              Input-Output Examples based Interaction Model:
                   in two signiﬁcant advances: digitization of massive amounts                              End-users used input-output examples as the most com-
                   of data and accessibility of computational devices to massive                            mon and natural way of expressing intent to experts on the
                   proportions of the population. It is thus not surprising that                            other side of the help-forums. An expert provides a pro-
                   morethan500millionpeopleworldwideusespreadsheetsfor                                      gram/transformationthatisconsistent with those examples.
                   storing and manipulating data. These business end-users                                  If the end-user is not happy with the result of the program
                   have myriad diverse backgrounds and include commodity                                    on any other new input in the spreadsheet, the interaction
                   traders, graphic designers, chemists, human resource man-                                is repeated with an extended set of input-output examples.
                   agers, ﬁnance pros, marketing managers, underwriters, com-                               This is the natural interface that our tool provides to the
                   pliance oﬃcers, and even mail room clerks—they are not                                   end-user. We describe the systematic design of an (induc-
                   ∗                                                                                        tive) synthesis algorithm that can learn desired scripts in
                    Work done during two internships at Microsoft Research.                                 our transformation language from very few examples.
                                                                                                               Weobservethatmostsemantictransformationscanbeex-
                   Permission to make digital or hard copies of all or part of this work for                pressed as a combination of lookup transformations and syn-
                   personal or classroom use is granted without fee provided that copies are                tactic transformations. We use this observation to present
                   not made or distributed for proﬁt or commercial advantage and that copies                a systematic design of the transformation language for per-
                   bear this notice and the full citation on the ﬁrst page. To copy otherwise, to           forming semantic string transformations. We ﬁrst present
                   republish, to post on servers or to redistribute to lists, requires prior speciﬁc        an expressive language for lookup transformations and then
                   permission and/or a fee. Articles from this volume were invited to present               extend it by adding syntactic transformations [8].
                   their results at The 38th International ConferenceonVeryLargeDataBases,
                   August 27th - 31st 2012, Istanbul, Turkey.                                               1http://www.excelforum.com/, http://www.ozgrid.com/forum/,
                   Proceedings of the VLDB Endowment, Vol. 5, No. 8                                         http://www.mrexcel.com/, http://www.exceltip.com/
                   Copyright 2012 VLDB Endowment 2150-8097/12/04... $ 10.00.
                                                                                                      740
