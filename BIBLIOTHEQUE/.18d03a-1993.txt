                                                                                                                                                                                                                                                    Keeping Neural Networks Simple by Minimizing
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            the Description Length of the Weights
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Georey E. Hinton and Drew van Camp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Department of Computer Science
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        UniversityofToronto
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      10 King's College Road
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Toronto M5S 1A4, Canada
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Abstract                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Limit the number of connections in the network
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (andhope that eachweightdoes not havetoomuch
                                                                                                                                                                                                                                                                                                                     Supervised neural networks generalize well if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               information in it).
                                                                                                                                                                                                                                                                                                                     there is much less information in the weights                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Divide the connections into subsets, and force the
                                                                                                                                                                                                                                                                                                                     than there is in the output vectors of the train-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           weights within a subset to be identical.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        If this
                                                                                                                                                                                                                                                                                                                     ing cases.                                                                                                                                                                                                                      So during learning, it is impor-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \weight-sharing"is based on an analysis of the nat-
                                                                                                                                                                                                                                                                                                                     tanttokeep the weights simple by penaliz-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ural symmetries of the task it can be very eective
                                                                                                                                                                                                                                                                                                                     ing the amount of information they contain.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (Lang, Waibel and Hinton (1990); LeCun 1989).
                                                                                                                                                                                                                                                                                                                     The amount of information in a weight can                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Quantize all the weights in the network so that a
                                                                                                                                                                                                                                                                                                                     be controlled by adding Gaussian noise and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  probability mass, p, can be assigned to each quan-
                                                                                                                                                                                                                                                                                                                     the noise level can be adapted during learning                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              tized value. The number of bits in a weight is then
                                                                                                                                                                                                                                                                                                                     to optimize the trade-o between the expected                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                logp, provided we ignore the cost of dening the
                                                                                                                                                                                                                                                                                                                     squared error of the network and the amount                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 quantization. Unfortunately this method leads to
                                                                                                                                                                                                                                                                                                                     of information in the weights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  We describe                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 a dicult search space because the cost of a weight
                                                                                                                                                                                                                                                                                                                     a method of computing the derivatives of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                does not have a smooth derivative.
                                                                                                                                                                                                                                                                                                                     expected squared error and of the amountof
                                                                                                                                                                                                                                                                                                                     information in the noisy weights in a net-
                                                                                                                                                                                                                                                                                                                     work that contains a layer of non-linear hidden                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2                                                                                    Applying the Minimum Description
                                                                                                                                                                                                                                                                                                                     units. Providedthe output units arelinear, the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Length Principle
                                                                                                                                                                                                                                                                                                                     exact derivatives can be computed eciently
                                                                                                                                                                                                                                                                                                                     without time-consuming Monte Carlo simula-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Whentting models to data, it is always possible to t
                                                                                                                                                                                                                                                                                                                     tions. The idea of minimizing the amountof                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              the training data better by using a more complexmodel,
                                                                                                                                                                                                                                                                                                                     information that is required to communicate                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             but this may make the model worse at tting new data.
                                                                                                                                                                                                                                                                                                                     the weights of a neural network leads to a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              So we need some way of deciding when extra complex-
                                                                                                                                                                                                                                                                                                                     numberofinteresting schemes forencoding the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ity in the model is not worth the improvement in the
                                                                                                                                                                                                                                                                                                                     weights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                data-t. The Minimum Description Length Principle
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (Rissanen, 1986) asserts that the best model of some
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             data is the one that minimizes the combined cost of
                                                                                                                                                                                                                                 1                                                                                    Introduction                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           describing the model and describing the mist between
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the modeland the data. For supervised neural networks
                                                                                                                                                                                                                                 In many practical learning tasks there is little available                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  withapredetermined architecture, the modelcost is the
                                                                                                                                                                                                                                 training data so any reasonably complicated model will                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      number of bits it takes to describe the weights, and the
                                                                                                                                                                                                                                 tend to overt the data and give poor generalization to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     data-mistcost is the number of bits it takes to describe
                                                                                                                                                                                                                                 new data. Toavoid overtting we need to ensure that                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          the discrepancy between the correct output and the out-
                                                                                                                                                                                                                                 there is less information in the weights than there is in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   put of the neural network on each training case. We can
                                                                                                                                                                                                                                 the output vectors of the training cases. Researchers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        think in terms of a sender who can see both the input
                                                                                                                                                                                                                                 have considered many possible ways of limiting the in-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      vector and the correct output and a receiver who can
                                                                                                                                                                                                                                 formation in the weights:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   only see the input vector. The sender rst ts a neural
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             network, of pre-arranged architecture, to the complete
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             set of training cases, then sends the weights to the re-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ceiver. For each training case the sender also sends the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             discrepancy between the net's output and the correct
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             output. By adding this discrepancy to the output of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the net, the receiver can generate exactly the correct
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             output.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        t                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    square deviation of the mists from zero.1 Using this
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             value of  and summingover all training cases the last
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             term of equation 2 becomes a constant and the data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             mist cost is:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0                                                                     v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             N                                                                                                              " 1 X c                                                                                                                                                                                                                                                                   c 2#
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  C                                                                                                                                                                                                                                               =kN +                                                                                                                                                                                                                                                           log                                                                                                                                                                                                     (d  y )                                                                                                                                                                                                                                (3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                data-mist                                                                                                                                                                                                                                                                                                                                                                                                                               2                                                                                                                                  N                                                                                                                                                   j                                                                                       j
                                                                                                                                                                                                                                                                                   Figure 1: This shows the probability mass asso-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  c
                                                                                                                                                                                                                                                                                   ciated with a quantized value, v, using a quan-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           where k is a constant that depends only on t.
                                                                                                                                                                                                                                                                                   tization width t.Ift is much narrower than the
                                                                                                                                                                                                                                                                                   Gaussian distribution, the probability mass is well                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Independently of whether we use the optimal value or
                                                                                                                                                                                                                                                                                   approximatedbythe product ofthe height and the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            a predetermined value for j, it is apparent that the
                                                                                                                                                                                                                                                                                   width, so the log probabilityis a sum of two terms.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       description length is minimizedby minimizingthe usual
                                                                                                                                                                                                                                                                                   The logt term is a constant, and if the distribu-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         squared error function, so the Gaussian assumptions we
                                                                                                                                                                                                                                                                                   tion is a zero-mean Gaussian, the log of the height                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       have made about coding can be viewed as the MDL
                                                                                                                                                                                                                                                                                   is proportional to v2.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    justication of this error function.
                                                                                                                                                                                                                                 3                                                                                    Coding the data mists                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4                                                                                    Asimple method of coding the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  weights
                                                                                                                                                                                                                                 To apply the MDL principle we need to decide on a
                                                                                                                                                                                                                                 coding scheme for the data mists and for the weights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Wecould code the weights in just the same wayaswe
                                                                                                                                                                                                                                 Clearly, if the data mists are real numbers, an innite                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    code the data mists. We assume that the weights of
                                                                                                                                                                                                                                 amountofinformationis needed to convey them. So we                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           the trained network are nely quantized and come from
                                                                                                                                                                                                                                 shall assume that they are very nely quantized, using                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      a zero-mean Gaussian distribution. If the standard de-
                                                                                                                                                                                                                                 intervals of xed width t.We shall also assume that                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          viation, w, of this distribution is xed in advance, the
                                                                                                                                                                                                                                 the data mists are encoded separately for each of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      description length of the weights is simply proportional
                                                                                                                                                                                                                                 output units.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               tothesumoftheirsquares. So,assumingweuseaGaus-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sian with standard deviation  for encoding the output
                                                                                                                                                                                                                                 The coding theorem tells us that if a sender and a re-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             errors, we can minimize the total description length of
                                                                                                                                                                                                                                 ceiver have agreed on a probability distribution that as-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the data mists and the weights by minimizingthe sum
                                                                                                                                                                                                                                 signs a probability mass, p(y), to each possible quan-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     of two terms:
                                                                                                                                                                                                                                 tized data mist, y, then we can code the mist using
                                                                                                                                                                                                                                  log2p(y) bits. If wewant to minimize the expected
                                                                                                                                                                                                                                 number of bits, the best probability distribution to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        X 1 X c c2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1 X 2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         C=                                                                                                                                                                                                                                                                                                       (d  y )                                                                                                                                                                                                                 +                                                                                                                                                                                                                               w                                                                                                                                      (4)
                                                                                                                                                                                                                                 is the correct one, but any other agreed distribution can                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               22                                                                                                                                                                            j                                                                                       j                                                                                                                                                                   22                                                                                                                                                                                 ij
                                                                                                                                                                                                                                 also be used. For convenience, we shall assume that for                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                j                                                                                             j                                                     c                                                                                                                                                                                                                                                                                                                                                                                    w ij
                                                                                                                                                                                                                                 output unit j the data mists are encoded by assuming
                                                                                                                                                                                                                                 that they are drawn from a zero-mean Gaussian distri-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        where c is an index over training cases.
                                                                                                                                                                                                                                 bution with standard deviation,  . Provided that  is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   j                                                                                                                                                                                                                                                                                                                                            j                                                                                                                                                            This is just the standard \weight-decay" method. The
                                                                                                                                                                                                                                 large compared with the quantization width t, the as-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        fact that weight-decay improves generalization (Hinton,
                                                                                                                                                                                                                                 sumed probability of a particular data mist between                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1987) can therefore be viewed as a vindication of this
                                                                                                                                                                                                                                 the desired output, dc on training case c and the actual
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               crude MDL approach in which the standard deviations
                                                                                                                                                                                                                                 output yc is then well approximated by the probability
                                                                                                                                                                                                                                                                                                                                                                                              j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              of the gaussians used for coding the data mists and the
                                                                                                                                                                                                                                 mass shown in gure 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             weights are both xed in advance.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "                                                                                                  c                                                                                        c 2#                                                                                                                                                                                                                                                                                                                        An elaboration of standard weight-decay is to assume
                                                                                                                                                                                                                                                                                                                                                                                                                                   c                                                                                        c                                                                                                            p1                                                                                                                                                                                                                                        (dj  yj)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   that the distribution of weights in the trained network
                                                                                                                                                                                                                                                                                                                                                                        p(d  y )=t                                                                                                                                                                                                                                                                                                                                                                                            exp                                                                                                                                                                                                                                                                                                                                                                                                                                   (1)
                                                                                                                                                                                                                                                                                                                                                                                                                                   j                                                                                        j                                                                                                                                              2                                                                                                                                                                                                                                                                             22                                                                                                                                                                                                                                                                                                                                                                                                               can be modelled more accurately by using a mixture
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 j                                                                                                                                                                                                                                                      j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             of several Gaussians whose means, variances and mix-
                                                                                                                                                                                                                                 Using an optimal code, the description length of a data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ing proportions are adapted as the network is trained
                                                                                                                                                                                                                                 mist, dc yc, in units of log (e) bits (called \nats") is:
                                                                                                                                                                                                                                                                                                                                                                                     j                                                                                 j                                                                                                                                                                                                                                                                                                  2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1If the optimal value of  is to be used, it must be com-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             municated before the data mists are sent, so it too must be
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   p                                                                                                                                                                                                                                                                                                                   c                                                                                        c 2                                                                                                                                                          coded. However, since it is only one number we are probably
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (d  y )
                                                                                                                                                                                                                                       logp(dc yc)= logt+log 2+log + j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       j                                                                                                                                                              safe in ignoring this aspect of the total description length.
                                                                                                                                                                                                                                                                                                                                                                                                   j                                                                              j                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               j                                                                                                                       22                                                                                                                                                                                                                                                                                   2It is clear from equation 4 that it is only the ratio of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (2)                                                                                                                                                      the variances of the two Gaussians that matters. Rather
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             than guessing this ratio, it is usually better to estimate it by
                                                                                                                                                                                                                                 To minimize this description length summed over all N                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        seeing which ratio gives optimal performance on a validation
                                                                                                                                                                                                                                 training cases, the optimal value of j is the root mean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set.
                                                                                                                                                                                                                                 (Nowlan and Hinton, 1992). For some tasks this more                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          weight. After learning, the sender has a Gaussian pos-
                                                                                                                                                                                                                                 elaborate way of coding the weights gives considerably                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      terior distribution, Q, for the weight. We describe a
                                                                                                                                                                                                                                 better generalization. This is especially true when only                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    method of communicating both the weights and the
                                                                                                                                                                                                                                 a small number of dierentweightvalues are required.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         data mists and show that using this method the num-
                                                                                                                                                                                                                                 However, this more elaborate scheme still suers from                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ber of bits required to communicatethe posterior distri-
                                                                                                                                                                                                                                 a serious weakness: It assumes that all the weights are                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     bution of a weight is equal to the asymmetric divergence
                                                                                                                                                                                                                                 quantized to the same tolerance, and that this tolerance                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (the Kullback-Liebler distance) from P to Q.
                                                                                                                                                                                                                                 is small compared with the standard deviations of the
                                                                                                                                                                                                                                 Gaussians used for modelling the weight distribution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               G(P;Q)=Z Q(w)logQ(w)dw                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (5)
                                                                                                                                                                                                                                 Thus it takes into account the probability densityofa                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               P(w)
                                                                                                                                                                                                                                 weight (the height in gure 1) but it ignores the pre-
                                                                                                                                                                                                                                 cision (the width). This is a terrible waste of bits. A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     5.2                                                                                                          The \bits back" argument
                                                                                                                                                                                                                                 network is clearly much more economical to describe if
                                                                                                                                                                                                                                 some of the weightvalues can be described very impre-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        To communicate a set of noisy weights, the sender rst
                                                                                                                                                                                                                                 cisely without signicantly aecting the predictions of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     collapses the posterior probability distribution for each
                                                                                                                                                                                                                                 the network.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                weightbyusing asource of randombits to pick a precise
                                                                                                                                                                                                                                 MacKay (1992) has considered the eects of small                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             value for the weight (to within some very ne tolerance
                                                                                                                                                                                                                                 changes in the weights on the outputs of the network                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         t). The probability of picking each possible value is de-
                                                                                                                                                                                                                                 after the network has been trained. The next section                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         termined by the posterior probability distribution for
                                                                                                                                                                                                                                 describes a methodoftakingthe precision ofthe weights                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        the weight. The sender then communicates these pre-
                                                                                                                                                                                                                                 into account during training so that the precision of a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cise weights by coding them using some prior Gaussian
                                                                                                                                                                                                                                 weight can be traded against both its probability den-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      distribution, P, so that the communication cost of a
                                                                                                                                                                                                                                 sity and the excess data mist caused by imprecision in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     precise weight, w, is:
                                                                                                                                                                                                                                 the weight.
                                                                                                                                                                                                                                 5                                                                                    Noisy weights                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  C(w)= logt logP(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (6)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             t must be small compared with the variance of P so
                                                                                                                                                                                                                                 Astandardwayoflimitingthe amountofinformationin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              C(w) is big. However, as we shall see, we are due for a
                                                                                                                                                                                                                                 anumber is to add zero-mean Gaussian noise. At rst                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          big refund at the end.
                                                                                                                                                                                                                                 sight, a noisy weight seems to be even more expensive                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Having sent the precise weights, the sender then com-
                                                                                                                                                                                                                                 to communicatethan a precise one since it appears that                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      municatesthe data-mistsachieved using those weights.
                                                                                                                                                                                                                                 we need to send a variance as well as a mean, and that                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Havingreceived the weights and the mists, the receiver
                                                                                                                                                                                                                                 weneedtodecideonaprecision forbothofthese. As we                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             can then produce the correct outputs. But he can also
                                                                                                                                                                                                                                 shall see, however, the MDL framework can be adapted                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         do something else. Once he has the correct outputs he
                                                                                                                                                                                                                                 to allowvery noisy weights to be communicated very                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           can run whatever learning algorithm was used by the
                                                                                                                                                                                                                                 cheaply.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sender and recover the exact same posterior probability
                                                                                                                                                                                                                                 When using backpropagation to train a feedforward                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            distribution, Q, that the sender collapsed in order to get
                                                                                                                                                                                                                                 neural network, it is standard practice to start at some                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the precise weights.                                                                                                                                                                                                                                                                                                                                                                                  Now, since the receiver knows the
                                                                                                                                                                                                                                 particular pointinweight space and to move this point                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sender's posterior distribution for eachweight and he
                                                                                                                                                                                                                                 in the direction that reduces the error function. An al-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    knowsthe precise value that was communicated, he can
                                                                                                                                                                                                                                 ternative approach is to start with a multivariate Gaus-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    recover all the random bits that the sender used to col-
                                                                                                                                                                                                                                 sian distribution over weightvectors and to change both                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     lapse that distribution to that value. So these random
                                                                                                                                                                                                                                 the mean and the variance of this cloud of weightvec-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        bits have been successfully communicated and wemust
                                                                                                                                                                                                                                 tors so as to reduce some cost function. We shall restrict                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  subtract them from the overall communication cost to
                                                                                                                                                                                                                                 ourselves to distributions in which the weights are inde-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   get the true cost of communicating the model and the
                                                                                                                                                                                                                                 pendent, so the distribution can be represented by one                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      mists. The number of randombits required to collapse
                                                                                                                                                                                                                                 mean and one variance per weight.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            the posterior distribution for a weight, Q, to a particular
                                                                                                                                                                                                                                 The cost function is the expected description length of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     nely quantized value, w, is:
                                                                                                                                                                                                                                 the weights and of the data mists. It turns out that
                                                                                                                                                                                                                                 high-variance weights are cheaper to communicate but                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 R(w)= logt logQ(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (7)
                                                                                                                                                                                                                                 they cause extra variance in the data mists thus mak-
                                                                                                                                                                                                                                 ing these mists more expensive to communicate.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              So the true expected description length for a noisy
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             weight is determined by taking an expectation, under
                                                                                                                                                                                                                                 5.1                                                                                                           The expected description length of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        the distribution Q :
                                                                                                                                                                                                                                                                                                                                               weights
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                3If the sender used random initial weights these can be
                                                                                                                                                                                                                                 We assume that the sender and the receiver havean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            communicated at a net cost of 0 bits using the method that
                                                                                                                                                                                                                                 agreed Gaussian prior distribution, P, for a given                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           is being explained.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Z                                                                                                                                                                                                                        Q(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2                                                                                                                                                                                                                                                                               2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    hE i = h(d  y ) i =(d   ) +V                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (12)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  j                                                                                                                                               j                                                                                       j                                                                                                                                                                 j                                                                                            y                                                                                                                                               y
                                                                                                                                                                                                                                                          G(P;Q)=hC(w) R(w)i=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Q(w)log                                                                                                                                                                                                                                                                       dw (8)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            j                                                                                                                                               j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   P(w)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             So, for each input vector, we can use the table and the
                                                                                                                                                                                                                                 For Gaussians with dierent means and variances, the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         equations above to compute the exact value of hEji.We
                                                                                                                                                                                                                                 asymmetric divergence is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    can also backpropagate the exact derivatives of E =
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             PhEiprovided we rst build another table to allow
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         j                                                               j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             derivatives to be backpropagated through the hidden
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       p                                                                                                                                                                                                                         2                                                                                              2                                                                                                                                                                                                                                                                           2                                                                                                                                                                                                                units. As before, the table is indexed by                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           andV                                                                                                                                                  but
                                                                                                                                                                                                                                                      G(P;Q)=log                                                                                                                                                                                                                                                                                                                                  +                                                                                                                                                        +(   ) (9)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       x                                                                                                                                                     x
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          22                                                                                                                  q                                                                                              p                                                                                                                                          p                                                                                              q                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         h                                                                                                                                                     h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       q                                                                                                                                                p                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    for the backward pass each cell of the table contains the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             four partial derivatives that are needed to to convert the
                                                                                                                                                                                                                                 5.3                                                                                                           The expected description length of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        output derivatives of h into its input derivatives using
                                                                                                                                                                                                                                                                                                                                               data mists                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   the equations:
                                                                                                                                                                                                                                 To compute the data-mist cost given in equation 3 we
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     c                                                                          c 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   @E                                                                                                                                                                                                                    @E @                                                                                                                                                                                                                                                                                                                                     @E @V
                                                                                                                                                                                                                                 need the expected value of (dj yj) . This squared error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      =                                                                                                                                                                                                                                                             yh                                                                               +                                                                                                                                                                                                                                                       yh                                                                                     (13)
                                                                                                                                                                                                                                 is caused partly by the systematic errors of the network                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             @                                                                                                                                                                                                                     @                                                                                                                           @                                                                                                                                                                                                            @V                                                                                                                          @
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       x                                                                                                                                                                                                                      y                                                                                                                            x                                                                                                                                                                                                            y                                                                                                                            x
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          h                                                                                                                                                                                                                    h                                                                                                                              h                                                                                                                                                                                                          h                                                                                                                              h
                                                                                                                                                                                                                                 and partly by the noise in the weights. Unfortunately,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       @E                                                                                                                                                                                                                   @E @                                                                                                                                                                                                                                                                                                                                    @E @V
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            y                                                                                                                                                                                                                                                                                                                                       y
                                                                                                                                                                                                                                 for general feedforward networks with noisyweights, the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      =                                                                                                                                                                                                                                                                              h                                                               +                                                                                                                                                                                                                                                                       h                                                                      (14)
                                                                                                                                                                                                                                 expected squared errors are noteasy tocompute. Linear                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 @V                                                                                                                                                                                                                    @                                                                                                                           @V                                                                                                                                                                                                           @V                                                                                                                          @V
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       x                                                                                                                                                                                                                      y                                                                                                                           x                                                                                                                                                                                                            y                                                                                                                           x
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          h                                                                                                                                                                                                                    h                                                                                                                             h                                                                                                                                                                                                          h                                                                                                                             h
                                                                                                                                                                                                                                 approximations are possible if the level of noise in the
                                                                                                                                                                                                                                 weights is suciently small compared with the smooth-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6                                                                                   Letting the data determine the prior
                                                                                                                                                                                                                                 ness of the non-linearities, but this defeats one of the
                                                                                                                                                                                                                                 main purposes of the idea which is to allowvery noisy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        So far, wehave assumed that the \prior" distribution
                                                                                                                                                                                                                                 weights. Fortunately, if there is only one hidden layer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     that is used for coding the weights is a single Gaussian.
                                                                                                                                                                                                                                 and if the output units are linear, it is possible to com-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  This coding-prior must be known to both the sender
                                                                                                                                                                                                                                 pute the expected squared error exactly.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     and the receiver before the weights are communicated.
                                                                                                                                                                                                                                 The weights are assumed to have independent Gaussian                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         If we x its mean and variance in advance we could pick
                                                                                                                                                                                                                                 noise, so for any input vector we can compute the mean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      inappropriatevalues thatmakeitvery expensivetocode
                                                                                                                                                                                                                                 x , and variance, Vx , of the Gaussian-distributed to-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     the actual weights. We therefore allow the mean and
                                                                                                                                                                                                                                                                             h                                                                                                                                                                                                                                                                                                                                                          h
                                                                                                                                                                                                                                 tal input, x , received by hidden unit h. Using a table,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    variance of the coding-prior to be determined during
                                                                                                                                                                                                                                                                                                                                                                                                                                                 h
                                                                                                                                                                                                                                 we can then compute the mean,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 and variance, V                                                                                                                                                                                                                                                                                                               ,                                                                                                               the optimization process, so the coding-prior depends
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            yh                                                                                                                                                                                                                                                                                                                                          yh
                                                                                                                                                                                                                                 of the output of the hidden unit, even though this out-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     onthe data. This is a funny kind of prior! We could try
                                                                                                                                                                                                                                 put is not Gaussian distributed. A lot of computation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        to make sense of it in Bayesian terms by assuming that
                                                                                                                                                                                                                                 is required to create this two-dimensional table since                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      we start with a hyper-prior that species probability
                                                                                                                                                                                                                                 manydierent pairs of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     and V                                                                                                                                                           must be used, and                                                                                                                                                                                                                                                                                                                                                                                                                                 distributions for the mean and variance of the coding-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      xh                                                                                                                                                             xh
                                                                                                                                                                                                                                 for each pair wemust use Monte Carlo sampling or nu-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         prior and then we use the hyper-prior and the data to
                                                                                                                                                                                                                                 merical integration to compute                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   and V . Once the                                                                                                                                                                                                                                                                                                                                                                                                                                           nd the best coding-prior. This would automatically
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              yh                                                                                                                                                             yh
                                                                                                                                                                                                                                 table is built, however, it is much more ecient than                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        takeinto account the cost of communicatingthe coding-
                                                                                                                                                                                                                                 using Monte Carlo sampling at runtime.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       prior to a receiver who only knows the hyper-prior. In
                                                                                                                                                                                                                                 Since the noise in the outputs of the hidden units is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        practice, we just ignore the cost of communicating the
                                                                                                                                                                                                                                 independent, they independently contribute variance to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      two parameters of the coding-prior so we do not need
                                                                                                                                                                                                                                 each linear output unit. The noisy weights, w , also                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         to inventhyper-priors.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  hj
                                                                                                                                                                                                                                 contribute variance to the output units. Since the out-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     6.1                                                                                                          Amoreexible prior distribution for the
                                                                                                                                                                                                                                 put units are linear, their outputs, yj, are equal to the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                weights
                                                                                                                                                                                                                                 total inputs they receive, x . On a particular training
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      j
                                                                                                                                                                                                                                 case, the output, yj, of output unit j is a random vari-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    If we use a single Gaussian prior for communicatingthe
                                                                                                                                                                                                                                 able with the following mean and variance:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   noisy weights, we get a relatively simple penalty term,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the asymmetric divergence, for the posterior distribu-
                                                                                                                                                                                                                                                                                                                            y                                                                                                  = Xy w                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (10)                                                                                                                                                                         tion of each noisy weight. Unfortunately, this coding
                                                                                                                                                                                                                                                                                                                                                                     j                                                                                                                                                                                                                                                 h                                                                     hj                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              scheme is not exible enough to capture certain kinds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              h                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              of common structure in the weights. Suppose, for ex-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Xh 2                                                                                                                                                                                                                                                                                                               2                                                                                                                                                                                                                                                                                                                             i                                                                                                                                                                                                                ample,that wewant a few of the weights to havevalues
                                                                                                                                                                                                                                                                                                                            V                                                                                                   =                                                                                                                                                                                                                                                  V                                                                       + V                                                                                                                                                                                                 +V V                                                                                                                                                                                                                           (11)
                                                                                                                                                                                                                                                                                                                                                     y                                                                                                                                                                                                                                                                                                                                                      y                                                                                                                                                                                w                                                                                                                                    y                                                              w
                                                                                                                                                                                                                                                                                                                                                                     j                                                                                                                                                                                                                                                   whj                                                                                                 h                                                                                                yh                                                                                     hj                                                                                                                            h                                                                     hj                                                                                                                                                                                                                                                  near 1 and the rest to havevalues very close to 0. If
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              h
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the posterior distribution for eachweight has lowvari-
                                                                                                                                                                                                                                 The mean and the variance of the activity of output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ance (to avoid the extra squared error caused by noise
                                                                                                                                                                                                                                 unit j make independent contributions to the expected                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        in the weights) we inevitiably pay a high code cost for
                                                                                                                                                                                                                                 squared error hEji. If the desired output of j on a par-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    weights because no single Gaussian prior can provide a
                                                                                                                                                                                                                                 ticular training case is dj, hEji is given by:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               good model of a spike around 0 and a spike around 1.
                                                                                                                                                                                                                                 If we knowinadvance that dierent subsets of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             energy ofasystemdepends ontheenergies ofthevarious
                                                                                                                                                                                                                                 weights are likely to have dierent distributions, we can                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   alternative congurations of the system. Indeed, one
                                                                                                                                                                                                                                 use dierent coding-priors for the dierent subsets. As                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     way to derive equation 17 is to dene a coding scheme
                                                                                                                                                                                                                                 MacKay(1992)hasdemonstrated,it makessense to use                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             in which the code cost resembles a free energy and to
                                                                                                                                                                                                                                 dierent coding-priors for the input-to-hidden weights                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      then use a lemma from statistical mechanics.
                                                                                                                                                                                                                                 and the hidden-to-output weights since the input and
                                                                                                                                                                                                                                 output values mayhave quite dierent scales. If wedo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         7                                                                                   Acoding scheme that uses a mixture
                                                                                                                                                                                                                                 not knowinadvance whichweights should be similar,
                                                                                                                                                                                                                                 we can model the weight distribution by an adaptive                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              of Gaussians
                                                                                                                                                                                                                                 mixture of Gaussians as proposed byNowlan and Hin-
                                                                                                                                                                                                                                 ton (1992). During the optimization, the means, vari-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Suppose that a sender and a receiver have already
                                                                                                                                                                                                                                 ances and mixing proportions in the mixture adapt to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         agreed on a particular mixture of Gaussians distribu-
                                                                                                                                                                                                                                 modelthe clusters in the weightvalues. Simultaneously,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      tion. The sender can now send a sample from the pos-
                                                                                                                                                                                                                                 the weights adapt to t the current mixture model so                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         terior Gaussian distribution of a weight using the fol-
                                                                                                                                                                                                                                 weights get pulled towards the centers of nearby clus-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      lowing coding scheme:
                                                                                                                                                                                                                                 ters. Suppose, for eaxample, that there are two Gaus-
                                                                                                                                                                                                                                 sians in the mixture. If one gaussian has mean 1 and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1. Randomlypick one of the Gaussians in the mixture
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                with probability r given by
                                                                                                                                                                                                                                 lowvariance and the other gaussian has mean 0 and low                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                i
                                                                                                                                                                                                                                 variance it is very cheap to encode low-variance weights                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          G
                                                                                                                                                                                                                                 with values near 1 or 0.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ie                                                                                                          i
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       r = P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (18)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          i                                                                                                                                                                                                           G
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         e                                                                                                              j
                                                                                                                                                                                                                                 Nowlan and Hinton (1992) implicitly assumed that the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           j                                               j
                                                                                                                                                                                                                                 posterior distribution for eachweight has a xed and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2. Communicate the choice of Gaussian to the re-
                                                                                                                                                                                                                                 negligible variance so they focussed on maximizing the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ceiver. If we use the mixing proportions as a prior
                                                                                                                                                                                                                                 probability density of the mean of the weight under the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         for communicating the choice, the expected code
                                                                                                                                                                                                                                 coding-prior mixture distribution. Wenow showhow                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cost is
                                                                                                                                                                                                                                 their technique can be extended to takeinto account the
                                                                                                                                                                                                                                 variance of the posterior distributions for the weights,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Xrlog 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (19)
                                                                                                                                                                                                                                 assuming that the posterior distributions are still con-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                i                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            i                                                                                                                                                                          i
                                                                                                                                                                                                                                 strained to be single Gaussians. As before, we ignore the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 3. Communicate the sample value to the receiver us-
                                                                                                                                                                                                                                 cost of communicating the mixture distribution that is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ing the chosen Gaussian. If we takeinto account
                                                                                                                                                                                                                                 to be used for coding the weights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              the randombits that we get back when the receiver
                                                                                                                                                                                                                                 The mixture prior has the form:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 reconstructs the posterior distribution from which
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 the sample was chosen, the expected cost of com-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  P(w)=XiPi(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (15)                                                                                                                                                                                                                                                             municating the sample is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    XriGi                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (20)
                                                                                                                                                                                                                                 where  is the mixing proportion of Gaussian P . The                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         i
                                                                                                                                                                                                                                                                                                                                                                                 i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   i
                                                                                                                                                                                                                                 asymmetric divergence between the mixture prior and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             So the expected cost of communicating both the
                                                                                                                                                                                                                                 the single Gaussian posterior, Q, for a noisy weightis                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          choice of Gaussian and the sample value given that
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 choice is
                                                                                                                                                                                                                                                                                                                                                                                                   G(P;Q)=Z Q(w)logPQ(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            dw                                                                                                                                          (16)                                                                                                                                                                                                                                                                                                                X                                                                                                                                                                                                    X 1 X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              i iPi(w)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                r G +                                                                                                                                                                                               r log                                                                                                                                                          =                                                                                                              r ( log e Gi)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          i                                             i                                                                                                                                                     i                                                                                                                                                                                                                                                                            i                                                                                                                                                         i
                                                                                                                                                                                                                                 Thesuminsidethelogmakesthishardtointegrate ana-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            i                                                                                                                                                                                                    i                                                                                                                                                                          i                                                                                                 i
                                                                                                                                                                                                                                 lytically. This is unfortunate since the optimizationpro-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (21)
                                                                                                                                                                                                                                 cess requires that we repeatedly evaluate both G(P;Q)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     4. After receiving samples from all the posterior
                                                                                                                                                                                                                                 and its derivatives with respect to the parameters of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           weightdistributions andalsoreceiving the errors on
                                                                                                                                                                                                                                 P and Q.Fortunately, there is a much more tractable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the training cases with these sampled weights, the
                                                                                                                                                                                                                                 expression which is an upper bound on G and can there-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          receiver can run the learning algorithm and recon-
                                                                                                                                                                                                                                 fore be used in its place. This expression is in terms of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       struct the posterior distributions from which the
                                                                                                                                                                                                                                 the G (P ;Q) the asymmetric divergences between the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            weights are sampled. This allows the receiver to
                                                                                                                                                                                                                                                                                                                                            i                                                        i
                                                                                                                                                                                                                                 posterior distribution, Q, and each of the Gaussians, Pi,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      reconstruct all of the Gi and hence to reconstruct
                                                                                                                                                                                                                                 in the mixture prior.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          the randombitsused tochoose a Gaussian fromthe
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                mixture. So the number of \bits back" that must
                                                                                                                                                                                                                                                                                                                                                                                                                                   ^                                                                                                                                                                                                                                                                                                                                                                                                                                               X  Gi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         be subtracted from the expected cost in equation
                                                                                                                                                                                                                                                                                                                                                                                                                          G(P ;P :::;Q)= log                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           e                                                                                                                                                                                                                                       (17)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1                                                                2                                                                                                                                                                                                                                                                                                                                                                                                       i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  21 is
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           i
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ^                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            X 1
                                                                                                                                                                                                                                 The way in which G depends on the Gi in equation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   H= rlog                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (22)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       i                                                                                     r
                                                                                                                                                                                                                                 17 is precisely analogous to the way in which the free                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  i                                                                                                                                                                      i
                                                                                                                                                                                                                                 Wenowusealemmafromstatisticalmechanicsto get a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               9                                                                                   Preliminary Results
                                                                                                                                                                                                                                 simple expression for the expected code cost minus the
                                                                                                                                                                                                                                 bits back.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Wehave not yet performed a thorough comparison be-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             tween this algorithm and alternative methods and it
                                                                                                                                                                                                                                 7.1                                                                                                           Alemmafromstatistical mechanics                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               maywell turn out that further renements are required
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             to make it competitive. Wehave, however, tried the
                                                                                                                                                                                                                                 For a physical system at a temperature of 1, the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             algorithm on one very high dimensional task with very
                                                                                                                                                                                                                                 Helmholtz free energy, F, is dened as the expected                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          scarce training data. The task is to predict the eec-
                                                                                                                                                                                                                                 energy minus the entropy                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    tiveness of a class of peptide molecules. Each molecule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             is described by 128 parameters (the input vector) and
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       X                                                                                                                                                                                                  X 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                has an eectiveness that is a single scalar (the ouput
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                F =                                                                                                                                                       r E                                                                                                                                                                                                r log                                                                                                                                                                                                                                                                                                                              (23)                                                                                                                                                                         value). All inputs and outputs were normalized to have
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             i                                            i                                                                                                                                                     i                                                                                     r
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               i                                                                                                                                                                                                  i                                                                                                                                                                      i                                                                                                                                                                                                                                                                                                                                                                                   zero mean and unit variance so that the weights could
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             be expected to have similarscales. The trainingset con-
                                                                                                                                                                                                                                 where i is an index over the alternative possible states                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sisted of 105 cases and the test set was the remaining
                                                                                                                                                                                                                                 of the system, E is the energy of a state, and r is the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           i                                                                                                                                                                                                                                  420 cases. We deliberately chose a very small training
                                                                                                                                                                                                                                 probability of a state. F is a function of the probabil-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    set since these are the circumstances in which it should
                                                                                                                                                                                                                                 ity distribution over states and the probability distribu-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  be most helpful to control the amount of informationin
                                                                                                                                                                                                                                 tion which minimizesF is the Boltzmanndistribution in                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        the weights. We tried a network with 4 hidden units.
                                                                                                                                                                                                                                 which probabilities are exponentially related to energies                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   This network contains 521 adaptiveweights (including
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             the biases of the output and hidden units) so it overts
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           E
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       e                                                                    i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                the 105 training cases very badly if we do not limit the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        r = P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (24)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           i                                                                                                                                            e Ej                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 information in the weights.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               j
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             We used an adaptive mixture of 5 Gaussians as our
                                                                                                                                                                                                                                 At the minimumgiven by the Boltzmann distribution,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           coding-prior for the weights. The Gaussians were ini-
                                                                                                                                                                                                                                 the free energy is equal to minus the log of the partition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  tialized with means uniformly spaced between  0:24
                                                                                                                                                                                                                                 function:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   and+0:24and separated by 2 standard deviations from
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             their neighbors. The initial means for the posterior dis-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             F = logXe Ei                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (25)                                                                                                                                                                         tributions of eachweightwere chosen from a Gaussian
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             with mean 0 and standard deviation 0:15. The stan-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               i                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             dard deviations of the posteriors for the weights were
                                                                                                                                                                                                                                 If we equate each Gaussian in the mixture with an al-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        all initialized at 0:1.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         E
                                                                                                                                                                                                                                 ternative state of a physical system, we can equate e                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    i                                                                                                                   We optimize all of the parameters simultaneously us-
                                                                                                                                                                                                                                                                                                                                                                                        G
                                                                                                                                                                                                                                 with ie                                                                                                                                                                                                 i. So our method of picking a Gaussian from                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ing a conjugate gradient method. For the variances we
                                                                                                                                                                                                                                 the mixture uses a Boltzmann distribution because it                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         optimize the log variance so that it cannot go negative
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              E
                                                                                                                                                                                                                                 makes ri proportional to e                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    i. The random bits that                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        and cannot collapse to zero. To ensure that the mix-
                                                                                                                                                                                                                                 are successfully communicated when the receiver recon-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ing proportions of the Gaussians in the coding-prior lie
                                                                                                                                                                                                                                 structs the probabilities ri correspond exactly to the en-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  between 0 and 1 and add to 1 we optimize the xi where
                                                                                                                                                                                                                                 tropy of the Boltzmann distribution, so the total code
                                                                                                                                                                                                                                 cost (including the bits back) is equivalenttoF and is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 x
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     e i
                                                                                                                                                                                                                                 therefore equal to the expression given in equation 17.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         = P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (26)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        i                                                                                                                                                                xj
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              j e
                                                                                                                                                                                                                                 8                                                                                    Implementation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         If we penalize the weights by the full cost of describing
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             them, the optimization quickly makes all of the weights
                                                                                                                                                                                                                                 With an adaptive mixture of Gaussians coding-prior,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          equal and negative and uses the bias of the output unit
                                                                                                                                                                                                                                 the derivatives of the cost function are moderately com-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    to x the output at the mean of the desired values in
                                                                                                                                                                                                                                 plicated so it is easy to make an error in implementing                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     the training set. It seems that it is initially very easy to
                                                                                                                                                                                                                                 them. This is worrying because gradient descent algo-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        reduce the combinedcost function by using weights that
                                                                                                                                                                                                                                 rithms are quite robust against minor errors. Also, it                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      contain almost no information,and it is very hard to es-
                                                                                                                                                                                                                                 is hard to knowhow large to make the tables that are                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         capefromthispoorsolution. Toavoidthistrap,wemul-
                                                                                                                                                                                                                                 used for propagating Gaussian distributions through lo-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     tiply the cost of the weights by a coecent that starts at
                                                                                                                                                                                                                                 gistic functions or for backpropagating derivatives. To                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     :05 and gradually increases to 1 according to the sched-
                                                                                                                                                                                                                                 demonstrate that the implementation was correct and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ule :05;:1;:15;:2;:3;:4;:5;:6;:7;:8;:9;1:0. At eachvalue
                                                                                                                                                                                                                                 to decide the table sizes we used the following semantic                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    of the coecientwe do 100 conjugate gradient updates
                                                                                                                                                                                                                                 check. Wechange each parameter by a small step and                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of the weights and at the nal value of 1:0we do not ter-
                                                                                                                                                                                                                                 check that the cost function changes by the product of                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      minate the optimization until the cost function changes
                                                                                                                                                                                                                                 the gradient and step size. Using this method we found                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      by less than 10 6 nats (a nat is log (e) bits). Figure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2
                                                                                                                                                                                                                                 that a 300  300 table with linear interpolation gives                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2 shows all the incoming and outgoing weights of the
                                                                                                                                                                                                                                 reasonably accurate derivatives.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             four hidden units after one run of the optimization. It
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Figure 3: The nal probability distribution that
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                is used for coding the weights. This distribution
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                is implemented by adapting the means, variances
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                and mixing proportions of ve gaussians.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             is clear that the weights form three fairly sharp clus-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ters. Figure 3 shows that the mixture of 5 Gaussians
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             has adapted to implement the appropriate coding-prior
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             for this weight distribution.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             The performance of the network can be measured by
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             comparingthe squared error it achieves on the test data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             with the error that would be achieved by simply guess-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ing the mean of the correct answers for the test data:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        P(d  y )2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    c                                                      c                                                                                      c
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Relative Error = P                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    2                                                                                                                                                                                                            (27)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            c(dc  d)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Weran the optimization ve times using dierent ran-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             domly chosen values for the initial means of the noisy
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             weights. For the network that achieved the lowest value
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             of the overall cost function, the relative error was 0:286.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Thiscompareswitharelativeerror of0:967forthe same
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             network when we used noise-free weights and did not
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             penalize their information content. The best relative
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             error obtained using simpleweight-decay with four non-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             linear hidden units was :317. This required a carefully
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             chosen penalty coecient for the squared weights that
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             corresponds to 2=2 in equation 4. To set this weight-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         j                                                                w
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             decay coecient appropriately it was necessary to try
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             many dierentvalues on a portion of the training set
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             and to use the remainder of the training set to decide
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             which coecientgave the best generalization. Once the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             best coecient had been determined the whole of the
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             training set was used with this coecient. A lower er-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ror of 0:291 can be achieved using weight-decayifwe
                                                                                                                                                                                                                                                                                   Figure 2: The nal weights of the network. Each                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           gradually increase the weight-decay coecient and pick
                                                                                                                                                                                                                                                                                   large block represents one hidden unit. The small                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         the value that gives optimal performance on the test
                                                                                                                                                                                                                                                                                   black or white rectangles represent negativeor                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            data. But this is cheating. Linear regression gavea
                                                                                                                                                                                                                                                                                   positiveweights with the area of a rectangle rep-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         huge relative error of 35:6 (gross overtting) but this
                                                                                                                                                                                                                                                                                   resenting the magnitude of the weight. The bot-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           fell to 0:291 when we penalized the sum of the squares
                                                                                                                                                                                                                                                                                   tom12 rows in each block represent the incoming                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           of the regression coecients by an amountthat was cho-
                                                                                                                                                                                                                                                                                   weights of the hidden unit. The central weightat                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          sen to optimize performance on the test data. This is
                                                                                                                                                                                                                                                                                   the top of each block is the weight from the hidden                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       almostidentical to the performance with 4 hidden units
                                                                                                                                                                                                                                                                                   unit to the linear output unit. The weight at the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         and optimalweight-decay probably because, with small
                                                                                                                                                                                                                                                                                   top-rightofablock is the bias of the hidden unit.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         weights, the hidden units operate in their central linear
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             range, so the whole network is eectively linear.
                                                                                                                                                                                                                                 These preliminary results demonstrate that our new                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           hidden units, the integration over the Gaussian distri-
                                                                                                                                                                                                                                 method allows us to t quite complicated non-linear                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          bution can be performed exactly and the exact weight
                                                                                                                                                                                                                                 models even when the number of training cases is less                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        derivatives can be computed eciently.
                                                                                                                                                                                                                                 than the number of dimensions in the input vector.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           It is not clear howmuch is lost by ignoring the o-
                                                                                                                                                                                                                                 The results also show that the new method is slightly                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        diagonal terms in the covariance matrix. David Mackay
                                                                                                                                                                                                                                 better than simple weight-decay on at least one task.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (personal communication) has shown that if standard
                                                                                                                                                                                                                                 Much more experimental work is required to decide                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            backpropagationis used to nd a single, locally optimal
                                                                                                                                                                                                                                 whether the method is competitive with other statis-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         pointinweight space and a Gaussian approximation
                                                                                                                                                                                                                                 tical techniques for handling non-linear tasks in which                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     to the posterior weight distribution is then constructed
                                                                                                                                                                                                                                 the amountoftrainingdatais very smallcomparedwith                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            around this point, the covariances between dierent
                                                                                                                                                                                                                                 the dimensionality of the input. It is also worth men-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      weights are signicant. However, this does not mean
                                                                                                                                                                                                                                 tioning that the solution with the lowest value of the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      that the covariances are signicant when the learning
                                                                                                                                                                                                                                 total description length was the solution in which all                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      algorithm is explicitly manipulating the Gaussian dis-
                                                                                                                                                                                                                                 the weights except the output bias are equal and nega-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      tribution because in this case the learning will try to
                                                                                                                                                                                                                                 tive. This solution has a relative error of approximately                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   force the noise in the weights to be independent. The
                                                                                                                                                                                                                                 1:0 so it is a serious embarrassment for the Minimum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         pressure for independence comes from the fact that the
                                                                                                                                                                                                                                 Description Length Principle or for our method of de-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cost function will overestimate the information in the
                                                                                                                                                                                                                                 scribing the weights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       weights if they have correlated noise. We are currently
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             performing simulations to see if this pressure does in-
                                                                                                                                                                                                                                 10 Discussion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               deed suppress the covariances.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Whenusingthestandard backpropagationalgorithm,it
                                                                                                                                                                                                                                 There is a correct, but intractable, Bayesian method                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         is essential that the output of a hidden unit is a smooth
                                                                                                                                                                                                                                 of determining the weights in a feedforward neural net-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     function of its input. This is why the hidden units use
                                                                                                                                                                                                                                 work. Westartwithapriordistributionoverallpossible                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           a smooth sigmoid function instead of a linear thresh-
                                                                                                                                                                                                                                 points in weight space. We then construct the correct                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        old function. With noisy weights, however, it is possi-
                                                                                                                                                                                                                                 posterior distribution at each pointinweight space by                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ble to use a version of the backpropagation algorithm
                                                                                                                                                                                                                                 multiplying the prior by the probability of getting the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     described above in networks that have one layer of lin-
                                                                                                                                                                                                                                 outputs in the training set given those weights.4 Fi-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ear threshold units. The noise in the weights ensures
                                                                                                                                                                                                                                 nally we normalize to get the full posterior distribution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  that the probability of a threshold unit being activeis
                                                                                                                                                                                                                                 Then we use this distribution of weightvalues to make                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        a smooth function of its inputs. As a result, it is easier
                                                                                                                                                                                                                                 predictions for new input vectors.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           to optimize a whole Gaussian distribution over weight
                                                                                                                                                                                                                                 In practice, the closest we can get to the ideal Bayesian                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   vectors than it is to optimize a single weightvector.
                                                                                                                                                                                                                                 methodis to use a Monte Carlo method to sample from
                                                                                                                                                                                                                                 the posterior distribution. This could be done by con-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      11 Acknowledgements
                                                                                                                                                                                                                                 sidering random moves in weight space and accepting a
                                                                                                                                                                                                                                 move with a probability that depends on howwell the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          This researchwas funded by operating and strategic
                                                                                                                                                                                                                                 resulting network ts the desired outputs. Neal (1993)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      grants from NSERC. Georey Hinton is the Noranda
                                                                                                                                                                                                                                 shows how the gradient information provided by back-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         fellow of the Canadian Institute for Advanced Research.
                                                                                                                                                                                                                                 propagation can be used to get a much more ecient                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Wethank DavidMackay,RadfordNeal, Chris Williams
                                                                                                                                                                                                                                 method of obtaining samples from the posterior distri-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      and Rich Zemel for helpful discussions.
                                                                                                                                                                                                                                 bution. The major advantage of Monte Carlo meth-
                                                                                                                                                                                                                                 ods is that they do not impose unrealistically simple
                                                                                                                                                                                                                                 assumptions about the shape of the posterior distribu-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      12 References
                                                                                                                                                                                                                                 tion in weight space.
                                                                                                                                                                                                                                 If we are willing to make simplifying assumptions about                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Hinton, G. E. (1987) Learning translation invariant
                                                                                                                                                                                                                                 the posterior distribution, time-consumingMonte Carlo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        recognition in a massively parallel network. In Goos, G.
                                                                                                                                                                                                                                 simulations can be avoided. MacKay (1992) nds a sin-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        and Hartmanis, J., editors, PARLE: Parallel Architec-
                                                                                                                                                                                                                                 gle locally optimal pointinweight space and constructs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      tures and Languages Europe, pages 1{13, Lecture Notes
                                                                                                                                                                                                                                 a full covariance Gaussian approximation to the pos-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         in Computer Science, Springer-Verlag, Berlin.
                                                                                                                                                                                                                                 terior distribution around that point. The alternative                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Lang, K., Waibel, A. and Hinton, G. E. (1990) A Time-
                                                                                                                                                                                                                                 methodproposed in this paper is to use a simpler Gaus-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Delay Neural Network Architecture for Isolated Word
                                                                                                                                                                                                                                 sian approximation (with no o-diagonal terms in the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Recognition. Neural Networks, 3, 23-43.
                                                                                                                                                                                                                                 covariance matrix) but to take this distribution into ac-
                                                                                                                                                                                                                                 count during the learning. With one layer of non-linear                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Le Cun, Y., Boser, B., Denker, J. S., Henderson,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             D., Howard, R. E., Hubbard, W. and Jackel, L. D.
                                                                                                                                                                                                                                                                                      4This assumes that the output of the neural net repre-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (1989) Back-Propagation Applied to Handwritten Zip-
                                                                                                                                                                                                                                 sents the mean of a Gaussian distribution from which the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    code Recognition. Neural Computation, 1, 541-551.
                                                                                                                                                                                                                                 nal output is randomly selected. So the nal output could
                                                                                                                                                                                                                                 be exactly correct even though the output of the net is not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Mackay,D.J.C.(1992)ApracticalBayesian framework
                                                                                                                                                                                                                                 for backpropagation networks. Neural Computation, 4,
                                                                                                                                                                                                                                 448-472.
                                                                                                                                                                                                                                 Neal, R. M. (1993) Bayesian learning via stochastic dy-
                                                                                                                                                                                                                                 namics. In Giles, C. L., Hanson, S. J. and Cowan, J.
                                                                                                                                                                                                                                 D. (Eds), Advances in Neural Information Processing
                                                                                                                                                                                                                                 Systems 5, Morgan Kaufmann, San Mateo CA.
                                                                                                                                                                                                                                 Nowlan. S. J. and Hinton, G. E. (1992) Simplifying
                                                                                                                                                                                                                                 neural networks by soft weight sharing. Neural Compu-
                                                                                                                                                                                                                                 tation, 4, 173-193.
                                                                                                                                                                                                                                 Rissanen, J. (1986) Stochastic Complexity and Model-
                                                                                                                                                                                                                                 ing. Annals of Statistics, 14, 1080-1100.
