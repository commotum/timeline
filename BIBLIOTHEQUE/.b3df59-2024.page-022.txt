                                                                                                                                                                                               TheSurprising Effectiveness of Test-Time Training for Few-Shot Learning
                                                                       100                  Boolean Expressions                         100                    Causal Judgement                           100                  Date Understanding                           100                   Disambiguation Qa                          100                     Dyck Languages                            100                     Formal Fallacies                         100                    Geometric Shapes                           100                        Hyperbaton                             100          Logical Deduction Five Objects
                                                                                       85.7 80.1 81.9            84.2                                                                                                                                                                                                                                                                                                                                                                                                                                                                 84.8 80.2
                                                                         80                                                    77.3       80                                                                80                                                                80                                                               80                                                                80                                                                80                                                               80                   78.7                                         80
                                                                                71.0                       69.7         71.3                                                                                                                                                                             65.9         67.9                                          68.8                       71.6 67.3                                                                                                                                                                        69.3                66.0
                                                                                                                                                         58.4         58.1         61.7         59.3                             61.6         58.7                60.8                      63.7 63.0                               64.2                                                59.7                                                              58.6                                                                                              58.0 63.8                                     60.8
                                                                         60                                                               60 53.5              57.5         53.8          55.0              60                         57.2          57.8 57.3                60                                                               60                          53.2                                  60            56.6 57.6 56.7 54.1              56.2 55.3          60                  54.7                56.5          52.7       60                                                                60                                       52.2
                                                                                                                                                                                                                    50.8 51.2                                                                                   49.3         45.8                                                                                                                                                                44.9                             50.7
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              44.3 40.0                                                                                                      41.6 43.3 41.6 41.0 38.9                       41.3
                                                                         40                                                               40                                                                40                                                                40                                                               40                                                                40                                                                40                                                               40                                                                40                                             37.8
                                                                                                                                                                                                                                                                                     29.2
                                                                         20                                                               20                                                                20                                                                20                                                               20             18.5                                               20                                                                20 14.2                                                          20                                                                20
                                                                           0                                                                0                                                                 0                                                                 0                                                                0      3.6                       2.7                              0     0.0                                                         0                                                                0                                                                 0
                                                                                      ICL    TTT                  TT                                    ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT
                                                                          Zero-Shot                  Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                              Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O
                                                                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T
                                                                                             ermutations      No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss
                                                                                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs
                                                                                           P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs
                                                                       100         Logical Deduction Seven Objects                      100          Logical Deduction Three Objects                      100                Movie Recommendation                           100              Multistep Arithmetic Two                        100                          Navigate                             100                     Object Counting                          100                   Penguins In A Table                         100         Reasoning About Colored Objects                       100                        Ruin Names
                                                                                                                                                                                                                                 86.7 87.4 86.4            88.7 92.3                                                                                                                                                                                                                                                                                                                                                                                           86.7
                                                                                                                                                                                   83.4                                                              84.6                                                                                                                                                                                                                                                                                                                                                                                  81.9 83.1 81.7            85.8 84.2
                                                                         80                                                               80                                                                80                                                                80                                                               80                                                                80                                                                80                                                               80                                                                80
                                                                                                                                                         68.5 69.8 63.6                         66.8                      69.5                                                                                                                                63.8                      65.0                                                                                                                                                                                                 65.0
                                                                         60                                                               60                                62.5          60.2              60                                                                60                                                               60                   62.3 62.5                  61.9 60.2         60                                56.4                            60                                                               60 59.2 59.0 57.2 56.8                          57.8 58.1         60            60.5
                                                                                                    51.9         52.4 51.2                        51.6                                                              53.2                                                                                                                                                         54.2                                          50.8 54.7 56.1             50.8         54.4                                                51.9                                                       54.7                                   53.6
                                                                                       49.2 48.8           46.5                47.0                                                                                                                                                                                                                    43.8                                                              44.4                                                             47.3 47.1 43.5 45.0 44.4                46.3 46.6
                                                                         40 40.4                                                          40                                                                40                                                                40                                                               40                                                                40                                             41.9               40                                                               40                                                                40
                                                                         20                                                               20                                                                20                                                                20                                                               20                                                                20                                                                20                                                               20                                                                20
                                                                           0                                                                0                                                                 0                                                                 0     0.8    2.8   2.5    2.2   1.1    2.6    2.7   2.0          0                                                                 0                                                                 0                                                                0                                                                 0
                                                                                      ICL    TTT                  TT                                    ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT
                                                                          Zero-Shot                  Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                              Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O
                                                                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T
                                                                                             ermutations      No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss
                                                                                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs
                                                                                           P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs
                                                                       100       Salient Translation Error Detection                    100                            Snarks                             100                 Sports Understanding                                               Temporal Sequences                          100 Tracking Shuffled Objects Five Objects 100Tracking Shuffled Objects Seven Objects 100 Tracking Shuffled Objects Three Objects 100                                                                                           Web Of Lies                            100                       Word Sorting
                                                                                                                                                                                                                                                                            100                   99.3 99.9 99.9 100.0 99.7 99.6
                                                                                                                                                                                                                                                                                     93.2
                                                                         80                                                               80                   77.6 73.0           72.3 72.1                80 76.0 75.6 75.9 74.6                   77.2         76.9        80                                                               80                                                                80                                                                80                                                               80                                                                80
                                                                                                                                                         70.2                                   66.8                                          69.5         69.6
                                                                                                                                                  60.7                      63.7
                                                                         60                                      50.2                     60                                                                60                                                                60                                                               60                                                                60                                                                60                                                               60                   50.5         50.2 52.6 51.6                  60 50.9 55.7 56.4 55.2                   53.2 56.5 54.4
                                                                                       48.1 47.2                               44.9                                                                                                                                                                                                                                                                                                                                                                                                                               49.5          49.8                      49.3                                          49.1
                                                                         40 42.0                    42.9 41.0           38.7              40                                                                40                                                                                                                                 40                                                                40                                                                40                                      37.7                     40                                                                40
                                                                                                                                                                                                                                                                              40            37.0                                                                                                                                                                                          30.0 33.0 35.2 34.8 32.8                32.8 32.1
                                                                                                                                                                                                                                                                                                                                                                    23.8 20.8 23.2 26.5 21.2                                          22.4         20.2 24.8
                                                                         20                                                               20                                                                20                                                                20                                                               20 18.7 20.1                                          19.9        20 16.8 17.0               17.8                18.8 15.8          20                                                               20                                                                20
                                                                           0                                                                0                                                                 0                                                                 0                                                                0                                                                 0                                                                 0                                                                0      0.0                                                        0
                                                                                      ICL    TTT                  TT                                    ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT                                    ICL   TTT                  TT                                     ICL   TTT                  TT                                    ICL    TTT                  TT
                                                                          Zero-Shot                  Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                              Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O                             Zero-Shot                 Direct I/O                             Zero-Shot                  Direct I/O
                                                                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                          No Example      Shared T                                          No Example     Shared T                                           No Example     Shared T
                                                                                             ermutations      No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss                                   ermutations       No Demo Loss                                    ermutations       No Demo Loss                                    ermutations       No Demo Loss
                                                                                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs                                                       and Outputs                                                      and Outputs                                                       and Outputs
                                                                                           P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs                            P                       Loss on Inputs                            P                       Loss on Inputs                            P                      Loss on Inputs
                                                                                                                                            Figure 17. Task-specific 10-shot results for each BIG-Bench Hard task, averaged over 5 random seeds.
                                                                                         Rangefor x = TTTaccuracy − ICLAccuracy                                                                                                                                                                                                                        Tasks (Count)
                                                                                         x≤−5                                                                                                                                                                                                                                                          1 task total:
                                                                                                                                                                                                                                                                                                                                                       Boolean Expressions
                                                                                         −5<x≤−2                                                                                                                                                                                                                                                       1 task total:
                                                                                                                                                                                                                                                                                                                                                       Penguins In A Table
                                                                                                                                                                                                                                                                                                                                                       13tasks total:
                                                                                                                                                                                                                                                                                                                                                       Causal Judgement, Disambiguation Qa, Formal Fallacies,
                                                                                                                                                                                                                                                                                                                                                       Logical Deduction Five Objects,
                                                                                         −2<x<2                                                                                                                                                                                                                                                        Logical Deduction Seven Objects,
                                                                                                                                                                                                                                                                                                                                                       Logical Deduction Three Objects, Multistep Arithmetic Two,
                                                                                                                                                                                                                                                                                                                                                       Navigate, Reasoning About Colored Objects,
                                                                                                                                                                                                                                                                                                                                                       Salient Translation Error Detection, Sports Understanding,
                                                                                                                                                                                                                                                                                                                                                       WebOfLies,WordSorting
                                                                                                                                                                                                                                                                                                                                                       3 tasks total:
                                                                                         2 ≤ x < 5                                                                                                                                                                                                                                                     Object Counting, Tracking Shuffled Objects Five Objects,
                                                                                                                                                                                                                                                                                                                                                       Tracking Shuffled Objects Three Objects
                                                                                                                                                                                                                                                                                                                                                       9 tasks total:
                                                                                                                                                                                                                                                                                                                                                       Date Understanding, Dyck Languages, Geometric Shapes,
                                                                                         x≥5                                                                                                                                                                                                                                                           Hyperbaton, Movie Recommendation, Ruin Names,
                                                                                                                                                                                                                                                                                                                                                       Snarks, Temporal Sequences,
                                                                                                                                                                                                                                                                                                                                                       Tracking Shuffled Objects Seven Objects
                                                                                                                                                                                      Table 9. Tasks Categorized by the Difference x = TTT Accuracy − ICL Accuracy.
                                                                                                                                                                                                                                                                                                                                                                       22
