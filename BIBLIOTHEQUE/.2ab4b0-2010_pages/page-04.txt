                                      REVIEWS
                                                                                                                                                                                                                                                                                                                                 The second issue is the form of the recognition den-
                                          Box 2 | Hierarchical message passing in the brain                                                                                                                                                                                                                            sity that is encoded by physical attributes of the brain, 
                                                                                                                        (i)           (i)       (i)            (i)((i â€“ 1)                     i)                                                                                                                      such as synaptic activity, efficacy and gain. In general, 
                                                                                                                    Î¾ = Î  Îµ =Î  (Î¼                                               â€“ g(Î¼ ))
                                                                                                                       v              v        v               v        v                                                                                                                                              any density is encoded by its sufficient statistics (for exam-
                                                                                                                        (i)           (i)       (i)            (i)((i )                       i)
                                                                                                                    Î¾ = Î  Îµ =Î  (DÎ¼ â€“ f(Î¼ ))
                                                                                                                       x              x        x               x            x                                                                                                                                          ple, the mean and variance of a Gaussian form). The way 
                                                                                                                                                                                                                                                                                                                       the brain encodes these statistics places important con-
                                                                                                                                                                                                                                                                     (3)                                               straints on the sorts of schemes that underlie recognition: 
                                            Sensory                               (1)                                                                                                                                                                            Î¾
                                                                                                                                                                                                                                                                    v
                                                input                         Î¾v                                                                                              (2)                                                  (2)                                                                                 they range from free-form schemes (for example, particle  
                                                                                                                                                                           Î¾
                                                                                                                                                                              v                                                 Î¾
                                                                                                                                                                                                                                   x                                       Backward:
                                                                                                                                             (1)                                                                                                                                                                                                   26                                                                                                                                35â€“38
                                                                                                                                                                                                                                                                                                                       filtering  and probabilistic population codes                                                                                                                             ),  
                                               Forward:                                                                                   Î¾x                                                                                                                               predictions
                                               prediction                                                                                                                                                                                                                                                              which use a vast number of sufficient statistics, to sim-
                                               error                                                                                                                                                                                                                 (2)                                               pler forms, which make stronger assumptions about 
                                                                                                                                                                                                                                                                 Î¼
                                                                             ~                                                                                                                                                                                       v                                                 the shape of the recognition density, so that it can be 
                                                                             s(t)                                                                                             (1)
                                                                                                                                                                          Î¼                                                          (2)
                                                                                                                                                                              v
                                                                                                                                                                                                                                 Î¼                                                                                     encoded with a small number of sufficient statistics. The 
                                                                                                                                                                                                                                     x
                                                                                                                                              (1)
                                                                                                                                           Î¼                                                                                                                                                                           simplest assumed form is Gaussian, which requires only 
                                                                                                                                              x
                                                                                                                                                                                                                                                                                                                       the conditional mean or expectation â€” this is known 
                                                                                                                                                                                                                                                                                                                                                                                                     39
                                           Lower cortical areas                                                                                                                                                            Higher cortical areas                                                                       as the Laplace assumption , under which the free energy 
                                                                                                                                 (i)              (i)((i)                       (i)         i + 1)
                                                                                                                                                                          T
                                                                                                                             Ë™Î¼      = DÎ¼ âˆ’ (âˆ‚ Îµ ) Î¾Î¾âˆ’                                                                                                                                                                 is just the difference between the modelâ€™s predictions 
                                              Synaptic plasticity                                                                v                v             v                         v                                 Synaptic gain
                                                                         T                                                       (i)              (i)((i)                        i)                                                                                      T
                                                                                                                                                                          T                                                                                                                                            and the sensations or representations that are predicted. 
                                             ï¿½Î¼       = âˆ’âˆ‚ Îµ Î¾ï¿½Î¼ = Â½tr(âˆ‚Î (Î¾Î¾ âˆ’ Î (Î¼)))
                                                 Î¸                Î¸                                                          Ë™Î¼      = DÎ¼ âˆ’ (âˆ‚ Îµ ) Î¾                                                                             Î³                       Î³                                  Î³
                                                   ij               ij                                                           x                x             x                                                                  i                       i                                                           Minimizing free energy then corresponds to explaining 
                                          The figure details a neuronal architecture that optimizes the conditional expectations of                                                                                                                                                                                    away prediction errors. This is known as predictive coding 
                                          causes in hierarchical models of sensory input. It shows the putative cells of origin of forward                                                                                                                                                                             and has become a popular framework for understand-
                                                                                                                                                                                                                    Nature Reviews | Neuroscience
                                          driving connections that convey prediction error (grey arrows) from a lower area (for                                                                                                                                                                                        ing neuronal message passing among different levels of 
                                          example, the lateral geniculate nucleus) to a higher area (for example, V1), and nonlinear                                                                                                                                                                                                                                                  40
                                                                                                                                                                                                                                                                                                                       cortical hierarchies . In this scheme, prediction error 
                                          backward connections (black arrows) that construct predictions41. These predictions try to                                                                                                                                                                                   units compare conditional expectations with top-down 
                                          explain away prediction error in lower levels. In this scheme, the sources of forward and                                                                                                                                                                                    predictions to elaborate a prediction error. This predic-
                                          backward connections are superficial and deep pyramidal cells (upper and lower triangles),                                                                                                                                                                                   tion error is passed forward to drive the units in the 
                                          respectively, where state units are black and error units are grey. The equations represent a                                                                                                                                                                                level above that encode conditional expectations which 
                                          gradient descent on free energy using the generative model below. The two upper equations                                                                                                                                                                                    optimize top-down predictions to explain away (reduce) 
                                          describe the formation of prediction error encoded by error units, and the two lower 
                                          equations represent recognition dynamics, using a gradient descent on free energy.                                                                                                                                                                                           prediction error in the level below. Here, explaining  
                                          Generative models in the brain                                                                                                                                                                                                                                               away just means countering excitatory bottom-up 
                                          To evaluate free energy one needs a generative model of how the sensorium is caused.                                                                                                                                                                                         inputs to a prediction error neuron with inhibitory syn-
                                          Such models p(sËœ ,Ï‘) = p(sËœ  | Ï‘) p(Ï‘) combine the likelihood p(sËœ  | Ï‘) of getting some data given                                                                                                                                                                          aptic inputs that are driven by top-down predictions 
                                          their causes and the prior beliefs about these causes, p(Ï‘). The brain has to explain                                                                                                                                                                                        (see BOX 2 and REFS 41,42 for detailed discussion). The 
                                          complicated dynamics on continuous states with hierarchical or deep causal structure                                                                                                                                                                                         reciprocal exchange of bottom-up prediction errors and 
                                          and may use models with the following form                                                                                                                                                                                                                                   top-down predictions proceeds until prediction error 
                                                                                                                                                                                                                                                                                                                       is minimized at all levels and conditional expectations 
                                                                        
         
        
               
                           
Ks                    
K       
K        
K             
K
                                                     U I
Z X  Î¸ \                                                                  X           I
Z X  Î¸ \                                                                                                                                            are optimized. This scheme has been invoked to explain 
                                                                                                                              â€¦â€¦
                                                Â·                                                                                                 Â· 
                                                                                                                                                   
                                                                                                                                                    
K                
K       
K        
K               
K
                                                  
                  
        
         
                
                            Z  H
Z X  Î¸ Y                                                                                                                                                                                                                                                                           40,43
                                               Z  H
Z X  Î¸ Y                                                                                                                                                                                                                                                  many features of early visual responses                                                                                               and provides 
                                                                   (i)                (i)                                                                                                                                                                                                                              a plausible account of repetition suppression and mis-
                                               Here, g  and f  are continuous nonlinear functions of (hidden and causal) states, with                                                                                                                                                                                                                                                                                                             44
                                                                                                                                    Nature Reviews | Neuroscience                                                                                                                                                      match responses in electrophysiology . FIGURE 1 pro-
                                                                                (i)                                                                                     (i)                         (i)
                                          parameters Î¸ . The random fluctuations z(t)  and w(t)  play the part of observation 
                                                                                                                                                                                                                                                                (i)                                                    vides an example of perceptual categorization that uses 
                                          noise at the sensory level and state noise at higher levels. Causal states v(t)  link                                                                                                                                                                                        this scheme.
                                          hierarchical levels, where the output of one level provides input to the next. Hidden 
                                                                      (i)                                                                                                                                                                                                                                                        Message passing of this sort is consistent with func-
                                          states x(t)  link dynamics over time and endow the model with memory.  
                                          Gaussian assumptions about the random fluctuations specify the likelihood                                                                                                                                                                                                                                                                                                                                                       45
                                                                                                                                                                                                                                                                                                                       tional asymmetries in real cortical hierarchies , where 
                                          and Gaussian assumptions about state noise furnish empirical priors in terms of                                                                                                                                                                                              forward connections (which convey prediction errors) 
                                          predicted motion. These assumptions are encoded by their precision (or inverse                                                                                                                                                                                               are driving and backwards connections (which model 
                                                                            (i)
                                          variance), ÐŸ (Î³), which are functions of precision parameters Î³.                                                                                                                                                                                                             the nonlinear generation of sensory input) have both 
                                          recognition dynamics and prediction error                                                                                                                                                                                                                                    driving and modulatory characteristics46. This asym-
                                          If we assume that neuronal activity encodes the conditional expectation of states, then                                                                                                                                                                                      metrical message passing is also a characteristic feature 
                                          recognition can be formulated as a gradient descent on free energy. Under Gaussian                                                                                                                                                                                           of adaptive resonance theory47,48, which has formal simi-
                                          assumptions, these recognition dynamics can be expressed compactly in terms                                                                                                                                                                                                  larities to predictive coding.
                                                                                                                                                                 (i)             (i)      (i)
                                          of precision-weighted prediction errors Î¾  =  ÐŸ (Îµ)  on the causal states and motion of                                                                                                                                                                                                In summary, the theme underlying the Bayesian brain 
                                          hidden states. The ensuing equations (see the figure) suggest two neuronal populations                                                                                                                                                                                       and predictive coding is that the brain is an inference 
                                          that exchange messages: causal or hidden-state units encoding expected states and                                                                                                                                                                                            engine that is trying to optimize probabilistic representa-
                                          error units encoding prediction error. Under hierarchical models, error units receive                                                                                                                                                                                        tions of what caused its sensory input. This optimization 
                                          messages from the state units in the same level and the level above, whereas state units 
                                          are driven by error units in the same level and the level below. These provide bottom-up                                                                                                                                                                                     can be finessed using a (variational free-energy) bound 
                                                                                                                                                                                  (i)
                                          messages that drive conditional expectations Î¼  towards better predictions, which                                                                                                                                                                                            on surprise. In short, the free-energy principle entails 
                                                                                                                                                                                                                                                                        (i)                       (i)
                                          explain away prediction error. These top-down predictions correspond to g(Î¼ ) and f(Î¼ ).                                                                                                                                                                                     the Bayesian brain hypothesis and can be implemented 
                                          This scheme suggests that the only connections that link levels are forward connections                                                                                                                                                                                      by the many schemes considered in this field. Almost 
                                          conveying prediction error to state units and reciprocal backward connections that                                                                                                                                                                                           invariably, these involve some form of message passing 
                                          mediate predictions. See REFS 42,130 for details. Figure is modified from REF. 42.                                                                                                                                                                                           or belief propagation among brain areas or units. This 
                                      130 | FEBRuARy 2010 | voluME 11                                                                                                                                                                                                                                                                                                                                 www.nature.com/reviews/neuro
                                                                                                                                                                                            Â© 2010 Macmillan Publishers Limited. All rights reserved
