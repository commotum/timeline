            
          SUPPLEMENTARY INFORMATION                                           In format provided by Friston (FEBRUARY 2010) 
                   Supplementary information S2 (box): Variational free energy 
                   Here, we derive the free-energy and show how its various formulations relate to each other. 
                   We start with the quantity we want to bound; namely, the surprise or log-evidence associated 
                                      %                                                           %
                   with sensory states  s(t)  that have been caused by some unknown quantities ϑ …{x,θ} , 
                   which include the hidden states and parameters in box (S1)  
                    
                          %              %
                   −ln p(s(t)) = −ln∫ p(s(t),ϑ)dϑ                                            S2.1 
                    
                                                                %
                   To create a free-energy bound on surprise  F (s(t),q(ϑ)), we simply add a non-negative 
                   cross-entropy  between  an  arbitrary  (recognition)  density  on  the  causes  q(ϑ)   and  their 
                                         %
                   posterior density  p(ϑ | s)  (dropping the dependency on m  for clarity). 
                    
                                  q(ϑ)             %
                   F =∫q(ϑ)ln            dϑ−ln p(s)
                                      %
                                 p(ϑ|s)
                                                                                             S2.2 
                                       %        %
                      =D(q(ϑ)|| p(ϑ|s))−ln p(s)
                    
                   The cross-entropy term is non-negative by Gibb’s inequality. In short, free-energy is cross-
                   entropy plus surprise. Because surprise depends only on sensory states, we can bring it 
                                                  %         %   %
                   inside the integral and use  p(ϑ,s) = p(ϑ | s)p(s) to show free-energy is expected energy 
                   minus entropy 
                    
                   F =∫q(ϑ)ln       q(ϑ)     dϑ
                                      %    %
                                 p(ϑ|s)p(s)
                                                        %
                      =∫q(ϑ)lnq(ϑ)dϑ−∫q(ϑ)ln p(ϑ,s)dϑ                                        S2.3 
                                  %
                      =− ln p(ϑ,s)    − −lnq(ϑ)
                                     q            q
                    
          NATURE REVIEWS | NEUROSCIENCE                                                     www.nature.com/reviews/neuro 
                                               © 2010 Macmillan Publishers Limited.  All rights reserved. 
