               # Boxes                 300       500         1000          2000            covers more crowed scenes, DiffusionDet achieves signif-
               DETR[10]               61.3   61.3 (+0.0)   61.3 (+0.0)  61.3 (+0.0)        icant gains by adjusting the number of evaluation boxes and
               Sparse R-CNN[90] 66.6 66.5(-0.1)            66.5 (-0.1)  66.5 (-0.1)        iteration steps. In contrast, previous methods only obtain
               DiffusionDet           66.6   69.0 (+2.4)   71.0 (+4.4)  71.9 (+5.3)        marginal gains or even degraded performance. More de-
                              (a) Dynamic number of evaluation boxes.                      tailed discussions are left in Section 4.
                                                                                              Besides, we evaluate DiffusionDet on COCO [57]
               # Steps                  1         2             3             4            dataset.    With ResNet-50 [37] backbone, DiffusionDet
               DETR[10]               61.3   62.5 (+1.2)   62.7 (+1.4)   62.7 (+1.4)       achieves 45.8 AP using a single sampling step and 300
               Sparse R-CNN[90] 66.6 60.6(-6.0)            55.5 (-11.1)  52.6 (-14.0)      random boxes, which significantly outperforms Faster R-
               DiffusionDet           66.6   69.7 (+3.1)   70.8 (+4.2)   71.4 (+4.8)       CNN[74](40.2AP),DETR[10](42.0AP)andonparwith
                              (b) Dynamic number of evaluation steps.                      Sparse R-CNN [90] (45.0 AP). Besides, we can further im-
               Table 1. Zero-shot transfer from COCO to CrowdHuman vis-                    prove DiffusionDet up to 46.8 AP by increasing the number
               ible box detection. All models are trained with 300 boxes and               of sampling steps and random boxes.
               tested with different number of boxes and steps.                            Ourcontributions are summarized as follows:
                                                                                           • We formulate object detection as a generative denoising
                                                                                             process, which is the first study to apply the diffusion
               ever, to the best of our knowledge, there is no prior art that                model to object detection to the best of our knowledge.
               successfully adopts it to object detection.                                 • Our noise-to-box detection paradigm has several appeal-
                   In this work, we propose DiffusionDet, which tackles                      ing properties, such as decoupling training and evaluation
               the object detection task with a diffusion model by casting                   stage for dynamic boxes and iterative evaluation.
               detection as a generative task over the space of the posi-                  • We conduct extensive experiments on COCO, Crowd-
               tions (center coordinates) and sizes (widths and heights) of                  Human, and LVIS benchmarks. DiffusionDet achieves
               bounding boxes in the image. At the training stage, Gaus-                     favorable performance against previous well-established
               sian noise controlled by a variance schedule [38] is added                    detectors, especially zero-shot transferring across differ-
               to ground truth boxes to obtain noisy boxes. Then these                       ent scenarios.
               noisy boxes are used to crop [36,74] features of Region of                  2. Related Work
               Interest (RoI) from the output feature map of the backbone
               encoder, e.g., ResNet [37], Swin Transformer [60]. Finally,                 Object detection.         Most modern object detection ap-
               these RoI features are sent to the detection decoder, which                 proachesperformboxregressionandcategoryclassification
               is trained to predict the ground-truth boxes without noise.                 on empirical object priors, such as proposals [27,74], an-
               With this training objective, DiffusionDet is able to predict               chors [56,72,73], points [93,95,112]. Recently, Carion et
               the groundtruthboxesfromrandomboxes. Attheinference                         al. proposed DETR [10] to detect objects using a fixed set
               stage, DiffusionDet generates bounding boxes by reversing                   of learnable queries. Since then, the query-based detection
               the learned diffusion process, which adjusts a noisy prior                  paradigm has attracted great attention and inspired a series
               distribution to the learned distribution over bounding boxes.               of following works [12,24,43,51,58,64,66,89,90,107,110,
                   As a probabilistic model, DiffusionDet has an attractive                114]. In this work, we push forward the development of the
               superiority of flexibility, i.e., we can train the network once             object detection pipeline further with DiffusionDet.
               andusethesamenetworkparametersunderdiversesettings                          Diffusion model. As a class of deep generative models,
               in the inference stage, mainly including: (1) Dynamic num-
               ber of boxes. Leveraging random boxes as object candi-                      diffusion models [38,86,88] start from the sample in ran-
               dates, we decouple the training and evaluation stage of Dif-                domdistribution and recover the data sample via a gradual
               fusionDet, i.e., we can train DiffusionDet with N                ran-       denoising process. Diffusion models have recently demon-
                                                                         train             strated remarkable results in fields including computer vi-
               dom boxes while evaluating it with N                random boxes,
                                                             eval                          sion [4,21,33,35,39,68,71,75,76,82,104,108], nature lan-
               where the N         is arbitrary and does not need to be equal
                              eval                                                         guageprocessing[3,30,52],audioprocessing[41,48,50,70,
               to N       .  (2) Iterative evaluation. Benefited by the iter-
                     train                                                                 91,100,103],graph-relatedtopics[42], interdisciplinary ap-
               ative denoising property of diffusion models, DiffusionDet
               can reuse the whole detection head in an iterative way, fur-                plications [2,40,44,78,94,99,102], etc. More applications
               ther improving its performance.                                             of diffusion models can be found in recent surveys [8,104].
                   The flexibility of DiffusionDet makes it a great advan-                 Diffusion model for perception tasks.                While Diffu-
               tage in detecting objects across different scenarios, e.g.,                 sion models have achieved great success in image gener-
               sparse or crowded, without additional fine-tuning. Specifi-                 ation [16,38,88], their potential for discriminative tasks has
               cally, Table 1 shows that when directly evaluating COCO-                    yet to be fully explored. Some pioneer works tried to adopt
               pretraiend models on CrowdHuman [80] dataset, which                         the diffusion model for image segmentation tasks [1,5,6,
                                                                                       19831
