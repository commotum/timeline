                                                                    This ICCV paper is the Open Access version, provided by the Computer Vision Foundation.
                                                                                            Except for this watermark, it is identical to the accepted version;
                                                                                   the final published version of the proceedings is available on IEEE Xplore.
                                                                DiffusionDet: Diffusion Model for Object Detection
                                                                                                  1                             1                                    2,3                             1,4
                                                                      Shoufa Chen                          Peize Sun                     Yibing Song                             Ping Luo
                                                                                 1The University of Hong Kong                                              2Tencent AI Lab
                                                                      3AI3 Institute, Fudan University                                            4Shanghai AI Laboratory
                                                                  {sfchen, pzsun, pluo}@cs.hku.hk                                                   yibingsong.cv@gmail.com
                                                                                                                                                                                             点 (点    |点 )
                                                                   Abstract                                                                    (a)     点!                            点       !   "#$   "   点                               点
                                                                                                                                                                                        "                      "#$                              %
                             We propose DiffusionDet, a new framework that for-                                                                                                              点(点 |点    )
                       mulates object detection as a denoising diffusion process                                                                                                                  "   "#$
                       from noisy boxes to object boxes.                                     During the training                               (b)
                       stage, object boxes diffuse from ground-truth boxes to ran-
                       domdistribution, and the model learns to reverse this nois-
                       ing process. In inference, the model refines a set of ran-                                                              (c)
                       domlygeneratedboxestotheoutputresultsinaprogressive
                       way. Our work possesses an appealing property of flexibil-                                                            Figure 1. Diffusion model for object detection. (a) A diffusion
                       ity, which enables the dynamic number of boxes and itera-                                                             model where q is the diffusion process and p is the reverse pro-
                       tive evaluation. The extensive experiments on the standard                                                                                                                                      胃
                       benchmarksshowthatDiffusionDetachievesfavorableper-                                                                   cess. (b) Diffusion model for image generation task. (c) We pro-
                                                                                                                                             posetoformulateobjectdetectionasadenoisingdiffusionprocess
                       formance compared to previous well-established detectors.                                                             from noisy boxes to object boxes.
                       For example, DiffusionDet achieves 5.3 AP and 4.8 AP
                       gains when evaluated with more boxes and iteration steps,
                       underazero-shottransfersettingfromCOCOtoCrowdHu-                                                                      query-based detection paradigm [23,51,90,114].
                       man. Our code is available at https://github.com/                                                                          While these works achieve a simple and effective de-
                       ShoufaChen/DiffusionDet.                                                                                              sign, they still have a dependency on a fixed set of learnable
                                                                                                                                             queries. A natural question is: is there a simpler approach
                       1. Introduction                                                                                                       that does not even need the surrogate of learnable queries?
                                                                                                                                                  Weanswerthisquestionbydesigninganovelframework
                             Object detection aims to predict a set of bounding boxes                                                        that directly detects objects from a set of random boxes.
                       and associated category labels for targeted objects in one                                                            Starting from purely random boxes, which do not contain
                       image. As a fundamental visual recognition task, it has                                                               learnable parameters that need to be optimized in the train-
                       become the cornerstone of many related recognition sce-                                                               ing stage, we expect to gradually refine the positions and
                       narios, such as instance segmentation [36, 53], pose esti-                                                            sizes of these boxes until they perfectly cover the targeted
                       mation [9, 22], action recognition [32, 81], object track-                                                            objects. This noise-to-box approach requires neither heuris-
                       ing [46,65], and visual relationship detection [45,62].                                                               tic object priors nor learnable queries, further simplifying
                             Modern object detection approaches have been evolv-                                                             the object candidates and pushing the development of the
                       ing with the development of object candidates, i.e., from                                                             detection pipeline forward.
                       empirical object priors [27, 59, 72, 74] to learnable object                                                               Our motivation is illustrated in Figure 1.                                           We think
                       queries [10,90,114]). Specifically, the majority of detectors                                                         of the philosophy of noise-to-box paradigm is analogous
                       solve detection tasks by defining surrogate regression and                                                            to noise-to-image process in the denoising diffusion mod-
                       classification on empirically designed object candidates,                                                             els [16,38,88], which are a class of likelihood-based mod-
                       such as sliding windows [28,79], region proposals [27,74],                                                            els to generate the image by gradually removing noise
                       anchor boxes [56,72] and reference points [19,105,112].                                                               from an image via the learned denoising model. Diffu-
                       Recently, DETR [10] proposes learnable object queries                                                                 sionmodelshaveachievedgreatsuccessinmanygeneration
                       to eliminate the hand-designed components and set up an                                                               tasks [3,4,40,71,94] and start to be explored in perception
                       end-to-end detection pipeline, attracting great attention on                                                          tasks like image segmentation [1,5,6,13,31,47,97]. How-
                                                                                                                                      19830
