
--- PAGE 001 ---
A New Approach to Linear Filtering
and Prediction Problems

R. E. KALMAN

Research Institute for Advanced Study,?
Baltimore, Md.

The classical filtering and prediction problem is re-examined using the Bode-Shannon
representation of random processes and the “‘state-transition” method of analysis of
dynamic systems. New results are:

(1) The formulation and methods of solution of the problem apply without modifica-
tion to stationary and nonstationary statistics and to growing-memory and infinite-

memory filters.

(2) A nonlinear difference (or differential) equation is derived for the covariance

matrix of the optimal estimation error.

From the solution of this equation the co-

efficients of the difference (or differential) equation of the optimal linear filter are ob-
tained without further calculations.

(3) The filtering problem is shown to be the dual of she noise-free regulator problem.

The new method developed here is applied to two well-known problems, confirming
and extending earlier results.

The discussion is largely self-contained and proceeds from first principles; basic
concepts of the theory of random processes are reviewed in the Appendix.

Introduction

As IMPORTANT class of theoretical and practical
problems in communication and control is of a statistical nature.
Such problems are: (i) Prediction of random signals; (ii) separa-
tion of random signals from random noise; (iii) detection of signals
of known form (pulses, sinusoids) in the presence of random noise.

In his pioneering work, Wiener [1]* showed that problems (i)
and (ii) lead to the so-called Wiener-Hopf integral equation; he
also gave a method (spectral factorization) for the solution of
this integral equation in the practically important special case of
stationary statistics and rational spectra.

Many extensions and generalizations followed Wiener’s basic
work. Zadeh and Ragazzini solved the finite-memory case [2].
Concurrently and independently of Bode and Shannon [3], they
also gave a simplified method [2] of solution. Booton dis-
cussed the nonstationary Wiener-Hopf equation [4]. These
results are now in standard texts [5-6]. A somewhat different
approach along these main lines has been given recently by
Darlington [7]. For extensions to sampled signals, see, e.g.,
Franklin [8], Lees [9]. Another approach based on the eigen-
functions of the Wiener-Hopf equation (which applies also to
nonstationary problems whereas the preceding methods in general
don’t), has been pioneered by Davis [10] and applied by many
others, e.g., Shinbrot [11], Blum [12], Pugachev [13], Solodov-
nikov [14].

Tn all these works, the objective is to obtain the specification of
a linear dynamic system (Wiener filter) which accomplishes the
prediction, separation, or detection of a random signal.

1 This research was supported in part by the U. 8. Air Force Office
of Scientific Research under Contract AF 49 (638)-382.

27212 Bellona Ave.

3 Numbers in brackets designate References at end of paper.

4 Of course, in general these tasks may be done better by nonlinear
filters. At present, however, little or nothing is known about how to
obtain (both theoretically and practically) these nonlinear filters.

Contributed by the Instruments and Regulators Division and
presented at the Instruments and Regulators Conference, March 29-
April 2, 1959, of Tae American Society or MECHANICAL ENGINEERS.

Nore: Statements and opinions advanced in papers are to be
understood as individual expressions of their authors and not those of
the Society. Manuscript received at ASME Headquarters, February
24,1959. Paper No. 59—IRD-11.

Journal of Basic Engineering

Present methods for solving the Wiener problem are subject to
a number of limitations which seriously curtail their practical
usefulness:

(1) The optimal filter is specified by its impulse response. It
is not a simple task to synthesize the filter from such data.

(2) Numerical determination of the optimal impulse response
is often quite involved and poorly suited to machine computa-
tion. The situation gets rapidly worse with increasing complex-
ity of the problem.

(3) Important generalizations (e.g., growing-memory filters,
nonstationary prediction) require new derivations, frequently
of considerable difficulty to the nonspecialist.

(4) The mathematics of the derivations are not transparent.
Fundamental assumptions and their consequences tend to be
obscured.

This paper introduces a new look at this whole assemblage of

problems, sidestepping the difficulties just mentioned. The
following are the highlights of the paper:
(5) Optimal Estimates and Orthogonal Projections. The

Wiener problem is approached from the point of view of condi-
tional distributions and expectations. In this way, basic facts of
the Wiener theory are quickly obtained; the scope of the results
and the fundamental assumptions appear clearly. It is seen that
all statistical calculations and results are based on first and second
order averages; no other statistical data are needed. Thus dif-
ficulty (4) is eliminated. This method is well known in probabil-
ity theory (see pp. 75-78 and 148-155 of Doob [15] and pp. 455-
464 of Loéve [16]) but has not yet been used extensively in en-
gineering.

(6) Models for Random Processes. Following, in particular,
Bode and Shannon [3], arbitrary random signals are represented
(up to second order average statistical properties) as the output
of a linear dynamic system excited by independent or uncorre-
lated random signals (‘‘white noise”). This is a standard trick
in the engineering applications of the Wiener theory [2-7]. The
approach taken here differs from the conventional one only in the
way in which linear dynamic systems are described. We shall
emphasize the concepts of siate and state transition; in other
words, linear systems will be specified by systems of first-order
difference (or differential) equations. This point of view is

MARCH 1960 / 3d

Copyright © 1960 by ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 002 ---
natural and also necessary in order to take advantage of the
simplifications mentioned under (5).

(7) Solution of the Wiener Problem. With the state-transition
method, a single derivation covers a large variety of problems:
growing and infinite memory filters, stationary and nonstationary
statistics, etc.; difficulty (3) disappears. Having guessed the
“state” of the estimation (i.e., filtering or prediction) problem
correctly, one is led to a nonlinear difference (or differential)
equation for the covariance matrix of the optimal estimation
error. This is vaguely analogous to the Wiener-Hopf equation.
Solution of the equation for the covariance matrix starts at the
time é when the first observation is taken; at each later time ¢
the solution of the equation represents the covariance of the op-
timal prediction error given observations in the interval (f, ¢).
From the covariance matrix at time ¢ we obtain at once, without
further calculations, the coefficients (in general, time-varying)
characterizing the optimal linear filter.

(8) The Dual Problem. The new formulation of the Wiener
problem brings it into contact with the growing new theory of
control systems based on the “‘state’’ point of view [17-24]. It
turns out, surprisingly, that the Wiener problem is the dual of
the noise-free optimal regulator problem, which has been solved
previously by the author, using the state-transition method to
great advantage [18, 23, 24]. The mathematical background of
the two problems is identical—this has been suspected all along,
but until now the analogies have never been made explicit.

(9) Applications. The power of the new method is most ap-
parent in theoretical investigations and in numerical answers to
complex practical problems. In the latter case, it is best to resort
to machine computation. Examples of this type will be discussed
later. To provide some feel for applications, two standard
examples from nonstationary prediction are included; in these
cases the solution of the nonlinear difference equation mentioned
under (7) above can be obtained even in closed form.

For easy reference, the main results are displayed in the form of
theorems. Only Theorems 3 and 4 are original. The next sec-
tion and the Appendix serve mainly to review well-known ma-
terial in a form suitable for the present purposes.

Notation Conventions

Throughout the paper, we shall deal mainly with discrete (or
sampled) dynamic systems; in other words, signals will be ob-
served at equally spaced points in time (sampling instants). By
suitable choice of the time scale, the constant intervals between
successive sampling instants (sampling periods) may be chosen as
unity. Thus variables referring to time, such as é, é, 7, 7 will
always be integers. The restriction to discrete dynamic systems
is not at all essential (at least from the engineering point of view);
by using the discreteness, however, we can keep the mathe-
matics rigorous and yet elementary. Vectors will be denoted by
small bold-face letters: a, b,..., u, x, y,... <A vector or more
precisely an n-vector is a set of n numbers 1, ... 2,3; the 2; are the
co-ordinates or components of the vector x.

Matrices will be denoted by capital bold-face letters: A, B, Q,
®,W,...; they are m X n arrays of elements a;;, b;;, Qi; + +»
The transpose (interchanging rows and columns) of a matrix will
be denoted by the prime. In manipulating formulas, it will be
convenient to regard a vector as a matrix with a single column.

Using the conventional definition of matrix multiplication, we
write the scalar product of two n-vectors x, y as

nN
x’y = a tis = y'x

t=1

The scalar product is clearly a scalar, i.e., not a vector, quantity.

36 / MARCH 1960

Similarly, the quadratic form associated with then  n matrix Q
is

x’Qx =

n
Pa U5Q 5 5%;
7 1

tij=

We define the expression xy’ where x is an m-vector and y is an
n-vector to be the m X n matrix with elements 2; ;.

We write E(x) = Ex for the expected value of the random vec-
tor x (see Appendix). It is usually convenient to omit the brackets
after Z. This does not result in confusion in simple cases since
constants and the operator # commute. Thus Hxy’ = matrix
with elements E(x,y;); Ex#y’ = matrix with elements H(x;)E(y;).

For ease of reference, a list of the principal symbols used is
given below.

Optimal Estimates

t time in general; present time.
tg time at which observations start.
a(l), tot) basic random variables.
y(t) observed random variable.
ai *(ti |e) optimal estimate of (41) given y(to), ..., y(t).
L loss function (nonrandom function of its argument).
€ estimation error (random variable).

Orthogonal Projections

Y(t) linear manifold generated by the random variables y(t),
vey Yl).
X(4|t) orthogonal projection of (4) on Y(Z).
%(ti|4) component of x(t) orthogonal to Y(é).
Models for Random Processes
(i+ 1; ¢) transition matrix
Q(t) covariance of random excitation

Solution of the Wiener Problem

x(t) basic random variable.
y(t) observed random variable.
Y(t) linear manifold generated by y(t), . . ., y(t).
Z(t) linear manifold generated by y(tlt —1).
x*(i|¢) optimal estimate of x(4) given Y(é).
x(4|¢) error in optimal estimate of x(4) given Y(t).

Optimal Estimates

To have a concrete description of thetype of problems to be
studied, consider the following situation. We are given signal
a(t) and noise x(t). Only the sum y(t) = a(t) + 22(t) can be ob-
served. Suppose we have observed and know exactly the
values of y(éo), .-., y(t). What can we infer from this knowledge
in regard to the (unobservable) value of the signal at ¢ = «4, where
t, may be less than, equal to, or greater than é? If t, < ¢, thisisa
data-smoothing (interpolation) problem. If & = ¢, this is called
filtering. If t, >t, we have a prediction problem. Since our treat-
ment will be general enough to include these and similar problems,
we shall use hereafter the collective term estimation.

As was pointed out by Wiener [1], the natural setting of the
estimation problem belongs to the realm of probability theory
and statistics. Thus signal, noise, and their sum will be random
variables, and consequently they may be regarded as random
processes. From the probabilistic description of the random
processes we can determine the probability with which a par-
ticular sample of the signal and noise will occur. For any given
set of measured values 7(éo), .. . , 9(¢) of the random variable y(¢)
one can then also determine, in principle, the probability of simul-
taneous occurrence of various values £,(¢) of the random variable
2(4). This is the conditional probability distribution function

Transactions of the ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 003 ---
Prlailh) < E:ly(t) = (to), -.., x(t) = on) = F(A) (1)

Evidently, F(&) represents all the information which the meas-
urement of the random variables y(t), .. ., y(t) has conveyed
about the random variable z(t). Any statistical estimate of the
random variable 2(é) will be some function of this distribution
and therefore a (nonrandom) function of the random variables
y(to), ..., y(t). This statistical estimate is denoted by X,(t|é),
or by just X,(é,) or X; when the set of observed random variables
or the time at which the estimate is required are clear from con-
text.

Suppose now that X; is given as a fixed function of the random
variables y(t), ..., y(t). Then X; is itself a random variable and
its actual value is known whenever the actual values of y(éo),
..., y(t) are known. In general, the actual value of X,(é,) will be
different from the (unknown) actual value of z(&). To arrive at
a rational way of determining X, it is natural to assign a penalty
or loss for incorrect estimates. Clearly, the loss should be a (i)
positive, (ii) nondecreasing function of the estimation error € =
ia(t) — Xi(t,). Thus we define a loss function by

L(0) = 0
L(é) = L(a) =O when

L(e) = L(—e)

Some common examples of loss functions are: L(e) = ae’, ae’,
alel, a(l — exp (—e?)], etc., where a is a positive constant.

One (but by no means the only) natural way of choosing the
random variable X, is to require that this choice should minimize
the average loss or risk

E{ Lath) — Xi(4))} = BUB{L[2(h) — Xi(t)I|y(o), .
y(t)}} (3)

Since the first expectation on the right-hand side of (3) does not
depend on the choice of X, but only on y(t), ..., y(é), it is clear
that minimizing (3) is equivalent to minimizing

E{L[x(t) — X(t) y(t), . . -, yl} (4)

Under just slight additional assumptions, optimal estimates can
be characterized in a simple way.

Theorem 1. Assume that L is of type (2) and that the conditional
distribution function F(&) defined by (1) is:

(A) symmetric about the mean E:

F(é — &) = 1-— F(E- &)

(B) convex for —& S &:
F(X, + (1 — AE) S AF(E) + (1 — AYF(E)
forall &, & <Eand0 SX S1

Then the random variable ay*(th|t) which minimizes the average loss
(3) zs the conditional expectation

a*(alt) = Ef(t)|y(to), «. » y(t) (5)

Proof: As pointed out recently by Sherman [25], this theorem
follows immediately from a well-known lemma in probability
theory.

Corollary. If the random processes {an(t)} 5 {xo(t)}, and { y(t)}
are gaussian, Theorem 1 holds.

Proof: By Theorem 5, (A) (see Appendix), conditional distribu-
tions on a gaussian random process are gaussian. Hence the re-
quirements of Theorem 1 are always satisfied.

In the control systems literature, this theorem appears some-
times in a form which is more restrictive in one way and more
general in another way:

Journal of Basic Engineering

Theorem I-a. Jf L(€) = €?, then Theorem 1 is true without as-
sumptions (A) and (B).
Proof: Iixpand the conditional expectation (4):

Elai%(t)|y(t), . . ., y(t)

— 2Xi(t)E[a(ts)|y(to), . -  ylt)] + Xi%(h)

and differentiate with respect to Xi(4). This is not a completely
rigorous argument; for a simple rigorous proof see Doob [15], pp.
77-78.

Remarks: (a) As far as the author is aware, it is not known
what is the most general class of random processes {ax(t)} , {x2(t)}
for which the conditional distribution function satisfies the re-
quirements of Theorem 1.

(b) Aside from the note of Sherman, Theorem 1 apparently
has never been stated explicitly in the control systems literature.
Tn fact, one finds many statements to the effect that loss functions
of the general type (2) cannot be conveniently handled mathe-
matically.

(c) In the sequel, we shall be dealing mainly with vector-
valued random variables. In that case, the estimation problem is
stated as: Given a vector-valued random process {x(t)} and ob-
served random variables y(t), . . ., y(é), where y(t) = Mx(¢) (M
being a singular matrix; in other words, not all co-ordinates of
x(¢) can be observed), find an estimate X(¢,) which minimizes the
expected loss E[{L(|| x(t:) — X(4)|I)], | || being the norm of a
vector.

Theorem 1 remains true in the vector case also, provided we re-
quire that the conditional distribution function of the n co-ordi-
nates of the vector x(t),

Priai(h) S &,.. 5) tlh) S Enly(to), ..-, y)) = FCB, + En)

be symmetric with respect to the x variables £ — &,..., &, — é,
and convex in the region where all of these variables are negative.

Orthogonal Projections

The explicit calculation of the optimal estimate as a function
of the observed variables is, in general, impossible. There is an
important exception: The processes {x(t)}, {<2(t)} are gaussian.

On the other hand, if we attempt to get an optimal estimate
under the restriction L(e) = ¢€? and the additional requirement
that the estimate be a linear function of the observed random
variables, we get an estimate which is identical with the optimal
estimate in the gaussian case, without the assumption of linearity
or quadratic loss function. This shows that results obtainable by
linear estimation can be bettered by nonlinear estimation only
when (i) the random processes are nongaussian and even then (in
view of Theorem 5, (C)) only (ii) by considering at least third-
order probability distribution functions.

In the special cases just mentioned, the explicit solution of the
estimation problem is most easily understood with the help of a
geometric picture. This is the subject of the present section.

Consider the (real-valued) random variables y(t), . . ., y(t).
The set of all linear combinations of these random variables with
real coefficients

t

Dd) ali) (6)

i=l

forms a vector space (linear manifold) which we denote by Y(t).
We regard, abstractly, any expression of the form (6) as “point”
or “vector” in Y(t); this use of the word ‘vector’ should not be
confused, of course, with “vector-valued” random variables, ete.
Since we do not want to fix the value of ¢ (i.e., the total number of
possible observations), Y(t) should be regarded as a finite-dimen-
sional subspace of the space of all possible observations.

MARCH 1960 / a1

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 004 ---
Given any two vectors wu, v in Y(t) (i.e., random variables ex-
pressible in the form (6)), we say that u and v are orthogonal if Fuy
= 0. Using the Schmidt orthogonalization procedure, as de-
scribed for instance by Doob [15], p. 151, or by Loéve [16], p.
459, it is easy to select an orthonormal basis in Y(t). By this is
meant a set of vectors ey, . . ., €, in Y(é) such that any vector in
Y(t) can be expressed as a unique linear combination of ey, . . ., &
and

Eee; = 6;; = 1 if
0 if

ffeil.
tg

Thus any vector £ in Y(é) is given by

t
i= > ae;

t=lo

and so the coefficients a; can be immediately determined with the
aid of (7):

t

Exe, = E (> ow) e¢; = a,Eee; = > a,6;; = a; (8)

t=lo t=to t=to

It follows further that any random variable x (not necessarily
in Y(t)) can be uniquely decomposed into two parts: a part Zin
Y(t) and a part £ orthogonal to Y(¢) (i.e., orthogonal to every
vector in Y(¢)). In fact, we can write

t
t=8+6= )) (Bee +4 (9)

t=lo

Thus ¥ is uniquely determined by equation (9) and is obviously
a vector in Y(t). Therefore # is also uniquely determined; it
remains to check that it is orthogonal to Y(é):

Now the co-ordinates of % with respect to the basis e,, . . ., e, are
given either in the form Fe; (as in (8)) or in the form Eze; (as
in (9)). Since the co-ordinates are unique, Exe; = Hxe; (t = to,
...,¢); hence H%e; = 0 and £ is orthogonal to every base vector e,;
and therefore to Y(t). We call % the orthogonal projection of x on
Y(t).

There is another way in which the orthogonal projection can be
characterized: * is that vector in Y(¢) (i.e., that linear function of
the random variables y(éo), . . ., y(t)) which minimizes the quad-
ratic loss function. In fact, if w is any other vector in Y(t), we
have

E(x — 0)? = E(&£ + % — 0)? = El(x — %) + (¥ — w)]?

Since # is orthogonal to every vector in Y(t) and in particular to
= — wwe have

E(x — vw)? = E(x — &)? + E(R — Ww)? 2 E(x — %)? (10)

This shows that, if also minimizes the quadratic loss, we must
have E(% — w)? = 0 which means that the random variables %
and w are equal (except possibly for a set of events whose proba-
bility is zero).

These results may be summarized as follows:

Theorem 2. Let {x(t)}, {y(t)} random processes with zero mean
(i.e., Ex(t) = Ey(t) = 0 for allt). We observe y(t), ..., y(t).

If either

(A) the random processes {x(t)}, {y(t)} are gaussian; or

(B) the optimal estimate is restricted to be a linear function of the
observed random variables and L(€) = €?;

then

38 / MARCH 1960

x*(|t) = optimal estimate of x(t) given y(t), . . ., y(t)

orthogonal projection (t,|¢) of x(44)on Y(t). (11)

These results are well-known though not easily accessible in the
control systems literature. See Doob [15], pp. 75-78, or Pugachev
[26]. It is sometimes convenient to denote the orthogonal pro-
jection by

(4 |t) = 2*(h|t) = Lfa(n)|Yo)]

The notation £ is motivated by part (b) of the theorem: If the
stochastic processes in question are gaussian, then orthogonal
projection is actually identical with conditional expectation.

Proof. (A) This is a direct consequence of the remarks in con-
nection with (10).

(B) Since x(t), y(t) are random variables with zero mean, it is
clear from formula (9) that the orthogonal part £(t|t) of 2(4) with
respect to the linear manifold Y(¢) is also a random variable with
zero mean. Orthogonal random variables with zero mean are
uncorrelated; if they are also gaussian then (by Theorem 5 (B))
they are independent. Thus

0 = Fault) = Ela(ts|e)|y(to), . . -, y(t)]
= E[x(t) — x(4|t)|y(o), . . ., y(t)]

= Elx(t)|y(to), .. ., y(t)] — (hl) = 0

Remarks. (d) A rigorous formulation of the contents of this
section as t > © requires some elementary notions from the
theory of Hilbert space. See Doob [15] and Loéve [16].

(e) The physical interpretation of Theorem 2 is largely a matter
of taste. If we are not worried about the assumption of gaus-
sianness, part (A) shows that the orthogonal projection is the op-
timal estimate for all reasonable loss functions. If we do worry
about gaussianness, even if we are resigned to consider only
linear estimates, we know that orthogonal projections are not
the optimal estimate for many reasonable loss functions. Since
in practice it is difficult to ascertain to what degree of approxima-
tion a random process of physical origin is gaussian, it is hard to
decide whether Theorem 2 has very broad or very limited sig-
nificance.

(f) Theorem 2 is immediately generalized for the case of vector-
valued random variables. In fact, we define the linear manifold
Y(t) generated by y(to), . . ., y(é) to be the set of all linear com-
binations

PP > ayy (2)

t= j=1

of all m co-ordinates of each of the random vectors y(to), . . ., y(¢).
The rest of the story proceeds as before.

(g) Theorem 2 states in effect that the optimal estimate under
conditions (A) or (B) is a linear combination of all previous ob-
servations. In other words, the optimal estimate can be re-
garded as the output of a linear filter, with the input being the
actually occurring values of the observable random variables;
Theorem 2 gives a way of computing the impulse response of the
optimal filter. As pointed out before, knowledge of this impulse
response is not a complete solution of the problem; for this
reason, no explicit formulas for the calculation of the impulse

response will be given.

Models for Random Processes

In dealing with physical phenomena, it is not sufficient to give
an empirical description but one must have also some idea of the
underlying causes. Without being able to separate in some sense
causes and effects, i.e., without the assumption of causality, one
can hardly hope for useful results.

Transactions of the ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 005 ---
It is a fairly generally accepted fact that primary macroscopic
sources of random phenomena are independent gaussian proc-
esses.5 A well-known example is the noise voltage produced in a
resistor due to thermal agitation. In most cases, observed random
phenomena are not describable by independent random variables.
The statistical dependence (correlation) between random signals
observed at different times is usually explained by the presence
of a dynamic system between the primary random source and the
observer. Thus a random function of time may be thought of as the
oulput of a dynamic system excited by an independent gaussian
random process.

An important property of gaussian random signals is that they
remain gaussian after passing through a linear system (Theorem
5(A)). Assuming independent gaussian primary random sources,
if the observed random signal is also gaussian, we may assume
that the dynamic system between the observer and the primary
source is linear. This conclusion may be forced on us also because
of lack of detailed knowledge of the statistical properties of the
observed random signal: Given any random process with known
first and second-order averages, we can find a gaussian random
process with the same properties(Theorem 5(C)). Thus gaussian
distributions and linear dynamics are natural, mutually plausible
assumptions particularly when the statistical data are scant.

How is a dynamic system (linear or nonlinear) described?
The fundamental concept is the notion of the sfate. By this is
meant, intuitively, some quantitative information (a set of num-
bers, a function, etc.) which is the least amount of data one has
to know about the past behavior of the system in order to pre-
dict its future behavior. The dynamics is then described in terms
of state transitions, i.e., one must specify how one state is trans-
formed into another as time passes.

A linear dynamic system may be described in general by the
vector differential equation

dx/dt = F(t)x + D(é)u(t)

and (12)

y(t) = M(é)x(é)

where x is an 7-vector, the state of the system (the components 2;
of x are called state variables); u(t) is an m-vector (m S n)
representing the inputs to the system; F(t) and D(t) aren X n,
respectively, x  m matrices. If all coefficients of F(t), D(¢),
M(t) are constants, we say that the dynamic system (12) is t7me-
invariant or stationary. Finally, y(t) is a p-vector denoting the
outputs of the system; M(é) isan X p matrix; p Sn.

The physical interpretation of (12) has been discussed in detail
elsewhere [18, 20, 23]. A look at the block diagram in Fig. 1 may
be helpful. This is not an ordinary but a matrix block diagram

(as revealed by the fat lines indicating signal flow). The inte-
u(t) x(t) x(t) y(t)
ot) bay — 5 Mi) E>

— F(t) |

Fig. 1
system

Matrix block diagram of the general linear continuous-dynamic

5 The probability distributions will be gaussian because macroscopic
random effects may be thought of as the superposition of very many
microscopic random effects; under very general conditions, such ag-
gregate effects tend to be gaussian, regardless of the statistical proper-
ties of the microscopic effects. The assumption of independence in
this context is motivated by the fact that microscopic phenomena
tend to take place much more rapidly than macroscopic phenom-
ena; thus primary random sources would appear to be independent
on a macroscopic time'scale.

Journal of Basic Engineering

grator in Fig. 1 actually stands for n integrators such that the
output of each is a state variable; F(t) indicates how the out-
puts of the integrators are fed back to the inputs of the integra-
tors. Thus f;;(¢) is the coefficient with which the output of the jth
integrator is fed back to the input of the 7th integrator. It is not
hard to relate this formalism to more conventional methods of
linear system analysis.

If we assume that the system (12) is stationary and that u(t)
is constant during each sampling period, that is

ué-+7) = u(t); OS 7 <1, t=0,1,... (13)

then (12) can be readily transformed into the more convenient
discrete form

x(¢ + 1) = B(1)x(t) + A(1)u(t); ¢ = 0,1,...
where [18, 20]
(1) = expF = D> Fifi! (F° = unit matrix)
i=0

1
A(1) = (f, exp Frdr ) D
ull) x(tel) x(t) y(t)
=> awn x _[ 2 —————— Mit) E>

[>

and

—

Fig. 2 Matrix block diagram of the general linear discrete-dynamic
system

® (tel;t)

See Fig. 2. One could also express exp Fr in closed form using
Laplace transform methods [18, 20, 22, 24]. If u(¢) satisfies (13)
but the system (12) is nonstationary, we can write analogously

x(t -+ 1) = B(t + 1; ¢) + A(t)u(e)
y(t) = M(é)x(¢)

but of course now @(¢ + 1; é), A(¢) cannot be expressed in gen-
eral in closed form. Equations of type (14) are encountered fre-
quently also in the study of complicated sampled-data systems
[22]. See Fig. 2.

@(i + 1; ¢) is the transition matrix of the system (12) or (14).
The notation P(t; t) (t, t: = integers) indicates transition from
time 4, to time &. Evidently ®(t; ¢) = | = unit matrix. If the
system (12) is stationary then P(t + 1; ¢) = Oi +1 —-—t) =
@(1) = const. Note also the product rule: ®(i; s)@(s; r) =
@(t; 7) and the inverse rule ®~'(t; s) = @(s; ¢), where t, s, r are
integers. In a stationary system, @(/; 7) = exp F(t — 7).

As a result of the preceding discussion, we shall represent ran-
dom phenomena by the model

x(t + 1) = BE + 1; é)x(t) + ut)

where {u(t)} is a vector-valued, independent, gaussian random
process, with zero mean, which is completely described by (in
view of Theorem 5 (C))

Eu(t) = 0 for all d;
Eu(t)u(s) = 0 if
Eu(t)u’(t) = Q(Z).

Of course (Theorem 5 (A)), x(t) is then also a gaussian random
process with zero mean, but it is no longer independent. In fact,
if we consider (15) in the steady state (assuming it is a stable sys-
tem), in other words, if we neglect the initial state x(t), then

$=0,1,. (14)

(15)

ixs

MARCH 1960 / 39

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 006 ---
t—1

x(t) = > @(t; r + 1u(r).

r=—0

Therefore if ¢ = s we have

s—1

Ex(t)x'(s) = D> BU; r+ YQ)"; 7 + 1).

r=-o

Thus if we assume a linear dynamic model and know the statistical
properties of the gaussian random excitation, it is easy to find the
corresponding statistical properties of the gaussian random proc-
ess {x(¢) ie

In real life, however, the situation is usually reversed. One is
given the covariance matrix /x(t)x’(s) (or rather, one attempts to
estimate the matrix from limited statistical data) and the prob-
lem is to get (15) and the statistical properties of u(t). This is a
subtle and presently largely unsolved problem in experimentation
and data reduction. As in the vast majority of the engineering
literature on the Wiener problem, we shall find it convenient to
start with the model (15) and regard the problem of obtaining the
model itself as a separate question. To be sure, the two problems
should be optimized jointly if possible; the author is not aware,
however, of any study of the joint optimization problem.

In summary, the following assumptions are made about random
processes:

Physical random phenomena may be thought of as due to primary
random sources exciting dynamic systems. The primary sources are
assumed to be independent gaussian random processes with zero
mean; the dynamic systems will be linear. The random processes
are therefore described by models such as (15). The question of how
the numbers specifying the model are obtained from experimental
data will not be considered.

Solution of the Wiener Problem

Let us now define the principal problem of the paper.
Problem I. Consider the dynamic model

x(t + 1) = Bt + 1; t)x(t) + u(é)
y(t) = M(é)x(é)

where u(t) is an independent gaussian random process of n-vectors
with zero mean, x(t) ts an n-vector, y(t) is a p-vector (p S n),
M(t + 1; t), M(t)aren X n, resp. p X n, matrices whose elements
are nonrandom functions of time.

Given the observed values of y(t), . . -, y(t) find an estimate
x*(t,|t) of x(t) which minimizes the expected loss. (See Fig. 2,
where A(é) = I.)

This problem includes as a special case the problems of filter-
ing, prediction, and data smoothing mentioned earlier. It in-
cludes also the problem of reconstructing all the state variables of
a linear dynamic system from noisy observations of some of the
state variables (p < n/).

From Theorem 2-a we know that the solution of Problem I is
simply the orthogonal projection of x(t) on the linear manifold
Y(t) generated by the observed random variables. As remarked
in the Introduction, this is to be accomplished by means of a
linear (not necessarily stationary!) dynamic system of the general
form (14). With this in mind, we proceed as follows.

Assume that y(f), ..., y(é — 1) have been measured, i.e., that
Y(t — 1) is known. Next, at time é, the random variable y(¢) is
measured. As before let y(t|t — 1) be the component of y(t)
orthogonal to Y(t — 1). If y(tlt — 1) =0, which means that the
values of all components of this random vector are zero for almost
every possible event, then Y(t) is obviously the same as Y(¢ — 1)
and therefore the measurement of y(t) does not convey any addi-
tional information. This is not likely to happen in a physically
meaningful situation. In any case, y (ele — 1) generates a linear

(16)
(17)

40 / MARCH 1960

manifold (possibly 0) which we denote by Z(t). By definition,
Y(t — 1) and Z(t) taken together are the same manifold as Y(¢),
and every vector in Z(¢) is orthogonal to every vector in Y(t — 1).

Assuming by induction that x*(é — 1e — 1) is known, we can
write:

x*(4[t) = Elx(a)[Y)) = Lea) Yt — 1) + Lix()|Z0)]

= (t+ 1; Ox*(4 — Ife — 1) + Alun — Y/Y - 1]
+ Elx(4)|Z@)] (18)

where the last line is obtained using (16).

Let 4; = +s, wheres is any integer. Ifs = 0, then u(4 — 1)
is independent of Y(¢ — 1). This is because u(t, — 1) = u(é +
s — 1) is then independent of u(é — 2), u(t — 3),... and therefore °
by (16-17), independent of y(¢),.. ., y(é — 1), hence independent
of Y(t— 1). Since, for all ¢, u(é) has zero mean by assumption, it
follows that u(é, — 1) (s 2 0) is orthogonal to Y(t — 1). Thus if
s = 0, the second term on the right-hand side of (18) vanishes; if
s < 0, considerable complications result in evaluating this term.
We shall consider only the case 4; 2 ¢. Furthermore, it will
suffice to consider in detail only the case 4: = ¢ + 1 since the
other cases can be easily reduced to this one.

The last term in (18) must be a linear operation on the random
variable y(ilt — 1):

Elx(t + 1)|Z()] = A*(y(elt — 1)

where A*(¢) is an m X p matrix, and the star refers to “optimal
filtering.”

The component of y(¢) lying in Y(t — 1) is (te — 1) = M(t)x*
(t/t — 1). Hence

y(t]é — 1) = y(t) — Yele — 1) = y(t) — M(é)x*(elé — 1) (20)
Combining (18-20) (see Fig. 3) we obtain
x*(E + 1[t) = B*(t + 1; d)x*(tlé — 1) + A*(A)y(t) (21)

(19)

where

®*(t +1; t) = O(t + 1; t) — A*(t)M(L) (22)

Thus optimal estimation is performed by a linear dynamic
system of the same form as (14). The state of the estimator is
the previous estimate, the input is the last measured value of the
observable random variable y(t), the transition matrix is given by
(22). Notice that physical realization of the optimal filter requires
only (z) the model of the random process (77) the operator A*(é).

The estimation error is also governed by a linear dynamic
system. In fact,

x(é + I]t) = x(é + 1) — x*(¢ + 1[d)

= M(t + 1; t)x(t) + u(t) — B*(E + 1; t)x*(e|t —-1)
— A*(t)M(E)x(é)

(tes 1)

lo Dites; tel)

PROCESS.

y(tir-i)

y(t) \

ylt|t-n

nYO) M(t)

|
}
|
|
|
pa

Fig. 3 Matrix block diagram of optimal filter

Transactions of the ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 007 ---
= @*(t +1; t)x(tlt — 1) + u(t)

Thus®* is also the transition matrix of the linear dynamic system
governing the error.

From (23) we obtain at once a recursion relation for the co-
variance matrix P*(t) of the optimal error x(¢|t — 1). Noting
that u(t) is independent of x(t) and therefore of x(t|¢ — 1), we get

P*(¢ + 1) = Ex(e + [ext + 1/2)
= @*(t +1; ERE — 1)x/Ult — 1)@*'(E + 1; 2 + QW)
= @*(t-+ 1; HERE — 1)x'tlt — IO’ +1; 2) + QW)
= D*(t + 1; t)P*()O"(t + 1; t) + QL) (24)

where Q(t) = Eu(t)u‘(é).
There remains the problem of obtaining an explicit formula for
A* (and thus also for®*), Since,

x(t + 1[Z(t)) = x(t + 1) — Ele(t + 1)/Z))
is orthogonal to y(|t — 1), it follows by (19) that
0 = E[x(t + 1) — A*(e)y(tlt — L)]y(elé — 1)
Ex(t + 1y"(t]t — 1) — A*(EyClt — 1)¥'(tlt — 1).

Noting that x(¢ + ale — 1) is orthogonal to Z(t), the definition of
P(t) given earlier, and (17), it follows further

0 = Ext + 1\t — 1)y(elt — 1) — A*(t)M(e)P*()M (2)

= E[@(t + 1; tx(ele — 1) + uele — 1))8ele — 1)M (2)
— A*(t)M(i)P*(t)M‘(Z).

(23)

Finally, since u(¢) is independent of x(¢),
0 = B(t + 1; t)P*(t)M(t) — A*(t)M(2)P*(t)M (2).

Now the matrix M(¢)P*(¢)M/‘(¢) will be positive definite and hence
invertible whenever P*(¢) is positive definite, provided that none
of the rows of M(t) are linearly dependent at any time, in other
words, that none of the observed scalar random variables y(t),

- + Ym(£) is a linear combination of the others. Under these
circumstances we get finally:

A*(t) = Blt + 1; Q)P*(QM(t)[MM)P*()M(t) 1-1 (25)

Since observations start at fo, X(to|to — 1) = x(é); to begin the
iterative evaluation of P*(¢) by means of equation (24), we must
obviously specify P*(to) = Ex(to)x(t). Assuming this matrix is
positive definite, equation (25) then yields A*(t)); equation (22)
®*(tp + 1; to), and equation (24) P*(é + 1), completing the
cycle. If now Q(é) is positive definite, then all the P*(z) will be
positive definite and the requirements in deriving (25) will
be satisfied at each step.

Now we remove the restriction that 4, = ¢ + 1.
orthogonal to Y(t), we have

x*(t + 1[t) = B[@(t+ 1; t)x(t) + u(d)|Y)] = OC + 1; t)x*(e|Z)

Hence if @(¢ + 1; ¢) has an inverse P(t; ¢ + 1) (which is always
the case when ® is the transition matrix of a dynamic system
describable by a differential equation) we have

x*(t[t) = Bt; t+ 1)x*(t + 10

Since u(¢) is

If 4 = ¢-+ 1, we first observe by repeated application of (16) that
x(t + s) = Bt + 8; t+ 1)x(t + 1)
s—1
+ Sl MG + 5; t+ rute+r)  (s 21)
rl
Since u(¢ + s — 1),..., u(é + 1) are all orthogonal to Y(t),

Journal of Basic Engineering

x*(t + s|t) = E[x(t + s)[Y(0)]
= LM + 8; t+ Ix + 1) [Ye]

=@(t+s; t+ 1)x*(t+ 1) (8 21)

If s < 0, the results are similar, but x*(t — s|¢) will have
(1 — s)(n — p) co-ordinates.

The results of this section may be summarized as follows:

Theorem 3. (Solution of the Wiener Problem)

Consider Problem I. The optimal estimate x*(t + 1|t) of x(t + 1)

given y(lo), ..., y(t) is generated by the linear dynamic system
x*(t + I]t) = @*(t + 1; Ox*('t — 1) + A*(y() (21)
The estimation error is given by
x(t + Ut) = D*(t + 1; dxdt — 1) + u(t) (23)
The covariance matrix of the estimation error is
cov x(t|¢ — 1) = Bx(t't — 1)x’(lt — 1) = P*(t) ~— (26)
The expected quadratic loss is
n
D> Brut — 1) = trace P*(2) (27)

t=1

The matrices A*(t), B*(t + 1; t), P*(t) are generated by the recursion
relations

A*(t) = (t+ 1; t)P*(L)M’(L) [M(L)P*(t)M (6) 7 (28)
@*(i + 1; 2) = Ot +1; 2) — A*(OM(L) " (29)
P¥(¢ + 1) = D*(4 + 1; £)P*(4\(t + 1; 2) 7

+ Q(t) (30)

In order to carry out the iterations, one must specify the covariance
P*(to) of x(to) and the covariance Q(t) of u(t). Finally, for any
s = 0, if P is invertible

x*(t + sit) = D(t + 5; ¢ + 1)x*(t +111)

= @O(t +s; t+ 1)O*(t+ 1; HDL; t+ 8-1)
xX x(t +8 — 1ft— 1)

+ D(t + 8; b+ 1I)A*(dy(e) (31)

so that the estimate x*(t + s\t) (s = 0) is also given by a linear dy-
namic system of the type (21).

Remarks. (hk) Eliminating A* and ®* from (28-30), a nonlinear
difference equation is obtained for P*(é):

P¥(¢ + 1) = @(t-+ 1; ¢){P*(2) — P*(t)M(t)[M(2)P*(t)M(t)]-?
X P*(QM(E) OE + 154) + QQ (t 2h) (82)

This equation is linear only if M(é) is invertible but then the
problem is trivial since all components of the random vector x(t)
are observable P*(é + 1) = Q(t). Observe that equation (32)
plays a role in the present theory analogous to that of the Wiener-
Hopf equation in the conventional theory.

Once P*(t) has been computed via (32) starting at ¢ = t, the
explicit specification of the optimal linear filter is immediately
available from formulas (29-30). Of course, the solution of
Equation (32), or of its differential-equation equivalent, is a
much simpler task than solution of the Wiener-Hopf equation.

(i) The results stated in Theorem 3 do not resolve completely
Problem I. Little has been said, for instance, about the physical
significance of the assumptions needed to obtain equation (25),
the convergence and stability of the nonlinear difference equa-
tion (32), the stability of the optimal filter (21), ete. This can
actually be done in a completely satisfactory way, but must be
left to a future paper. In this connection, the principal guide and

MARCH 1960 / 4]

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 008 ---
tool turns out to be the duality theorem mentioned briefly in the
next section. See [29].

(j) By letting the sampling period (equal to one so far) ap-
proach zero, the method can be used to obtain the specification of
a differential equation for the optimal filter. To do this, i.e., to
pass from equation (14) to equation (12), requires computing
the logarithm F* of the matrix®*. But this can be done only if
@* is nonsingular—which is easily seen not to be the case. This
is because it is sufficient for the optimal filter to have x — p state
variables, rather than n, as the formalism of equation (22) would
seem to imply. By appropriate modifications, therefore, equa-
tion (22) can be reduced to an equivalent set of only n — p equa-
tions whose transition matrix is nonsingular. Details of this type
will be covered in later publications.

(k) The dynamic system (21) is, in general, nonstationary.
This is due to two things: (1) The time dependence of B(¢ + 1; ¢)
and M(t); (2) the fact that the estimation starts at 4 = t and
improves as more data are accumulated. If, M are constants,
it can be shown that (21) becomes a stationary dynamic system in
the limit i— ©. This is the case treated by the classical Wiener
theory.

(1) It is noteworthy that the derivations given are not affected
by the nonstationarity of the model for x(é) or the finiteness of
available data. In fact, as far as the author is aware, the only
explicit recursion relations given before for the growing-memory
filter are due to Blum [12]. However, his results are much more
complicated than ours.

(m) By inspection of Fig. 3 we see that the optimal filter is a
feedback system, and that the signal after the first summer is
white noise since y(éle — 1) is obviously an orthogonal random
process. This corresponds to some well-known results in Wiener
filtering, see, e.g., Smith [28], Chapter 6, Fig. 6-4. However,
this is apparently the first rigorous proof that every Wiener filter
is realizable by means of a feedback system. Moreover, it will be
shown in another paper that such a filter is always stable, under
very mild assumptions on the model (16-17). See [29].

The Dual Problem

Let us now consider another problem which is conceptually
very different from optimal estimation, namely, the noise-free
regulator problem. In the simplest cases, this is:

Problem Il. Consider the dynamic system

x(t + 1) = BCE + 1; t)x(t) + M(é)u(2) (33)

F . A xe
where x(t) is an n-vector, u(t) ts an m-vector (m S n), D, M are

n X nvresp. n X m matrices whose elements are nonrandom func-
tions of time. Given any state x(t) al time t, we are to find a sequence

u(t), .. ., u(7") of control vectors which minimizes the performance
index
T+1
V[x(é)] = be x'(7)Q(r)x(7)
7T=t

where AL) is a positive definite matrix whose elements are nonran-
dom functions of time. See Fig. 2, where A = MandM = I.

Probabilistic considerations play no part in Problem IT; it is
implicitly assumed that every state variable can be measured
exactly at each instant ¢,¢ + 1,..., 7. It is customary to call
T = tthe terminal time (it may be infinity).

The first general solution of the noise-free regulator problem is
due to the author [18]. The main result is that the optimal con-
trol vectors u*(¢) are nonstationary linear functions of x(t). After
a change in notation, the formulas of the Appendix, Reference
[18] (see also Reference [23]) are as follows:

u*(t) = — A*(t)x(2) (34)
Under optimal control as given by (34), the “closed-loop” equa-
tions for the system are (see Fig. 4)

42 / MARCH 1960

x(t + 1) = @*(t + 1; dx(¢)
and the minimum performance index at time ¢t is given by

V*[x(é)] = x/(t)P*(¢ — 1)x(¢)

recursion relations:

The matrices A*(0), @*(t + 1; t), B*(Z) are determined by the

A*(t) = [MAP (OM) AMA()P A(t + 1; ¢) (35)
@*0+1; 0 = +1; 0) — MOA*E) <p 8)
Bet — 1) = GU + 1; NPOH*E + 1; 0 -
+ Qe) (37)
Initially we must set P*(7) = Q(T’ + 1).
— SHYSKAL SYSTEM TO GE CONTROLLED __
| x(tel) |
ww | tz > wy | TS
T Mit) = delay a)
|
| |
| D(teijt) fH |
Uo ees gecee: reams Yeas Ga eines pee ee 4
-I ke

Fig. 4 Matrix block diagram of optimal controller

Comparing equations (35-37) wi

th (28-30) and Fig. 3 with Fig.

4 we notice some interesting things which are expressed precisely
by

Theorem 4. (Duality Theorem) Problem I and Problem IT are

duals of each other in the following sense:

Lett = 0. Replace every matrix X(t) = X(t + 7) in (28-30)
by R(t) = KP — T). Then one has (35-37). Conversely, re-
place every matrix X(T — r) in (35-37) by X(t + +). Then one
has (28-30).

Proof. Carry out the substitutions.

For ease of reference, the

dualities between the two problems are given in detail in Table 1.

1

Table
Problem |

x(t) (unobservable) — state
variables of random proc-
ess.

y(t) observed random varia-
bles.

ty first observation.

D(to + 7 +1; to + 7) transi-
tion matrix.

P*(t) + 7) covariance of opti-
mized estimation error.

A*(to + 7) weighting of ob-
servation for optimal esti-
mation.

@D*(to + 7 + 1; to + 7) transi-
tion matrix for optimal es-
timation error.

M(t. + 7) effect of state on
observation.

Q(t + 7) covariance of ran-
dom excitation.

Remarks. (7) The mathematical

1
Problem Il
x(t) (observable) state varia-
bles of plant to be regu-
lated.
u(t) control variables.

T last control action.

@(T — ++ 1; T — 7) transi-

_ tion matrix.

P*(T — +) matrix of quad-
ratic form for performance
index under optimal regu-
lation.

A*(T — 7) weighting of state
for optimal control.

&*(7 —7r+1; T—7) transi-
tion matrix under optimal

_ regulation.

M(T — 71) effect of control

. vectors on state.

Q(T — 7) matrix of quadratic
form defining error cri-
terion.

significance of the duality be-

tween Problem I and Problem II is that both problems reduce to
the solution of the Wiener-Hopf-like equation (32).

(0) The physical significance of the duality is intriguing. Why
are observations and control dual quantities?

Transactions of the ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 009 ---
Recent research [29] has shown that the essence of the Duality
Theorem lies in the duality of constraints at the output (repre-
sented by the matrix M(é) in Problem I) and constraints at the
input (represented by the matrix M(é) in Problem II).

(p) Applications of Wiener’s methods to the solution of noise-
free regulator problem have been known for a long time; see the
recent textbook of Newton, Gould, and Kaiser [27]. However,
the connections between the two problems, and in particular the
duality, have apparently never been stated precisely before.

(q) The duality theorem offers a powerful tool for developing
more deeply the theory (as opposed to the computation) of Wiener
filters, as mentioned in Remark (2). This will be published
elsewhere [29].

Applications

The power of the new approach to the Wiener problem, as ex-
pressed by Theorem 3, is most obvious when the data of the
problem are given in numerical form. In that case, one simply
performs the numerical computations required by (28-30). Re-
sults of such calculations, in some cases of practical engineering
interest, will be published elsewhere.

When the answers are desired in closed analytic form, the itera-
tions (28-30) may lead to very unwieldy expressions. In a few
cases, A* and @* can be put into “closed form.’’? Without dis-
cussing here how (if at all) such closed forms can be obtained, we
now give two examples indicative of the type of results to be ex-
pected.

Example 1. Consider the problem mentioned under ‘Optimal
Estimates.’”’ Let x(t) be the signal and 2.(t) the noise. We as-
sume the model:

u(t +1) = dulé + 1; t)a(t) + w(é)
to(t + 1) = w(t)
y(t) = a(t) + 22(t)

The specific data for which we desire a solution of the estimation
problem are as follows:

1 4=t+1;46=0

2 Hzx2(0) = 0,ie., 2:(0) = 0

3 Ew%(t) = a2, But) = b?, Eu(t)u(t) = 0 (for all £)
4 gdu(t +1; t) = du = const.

A simple calculation shows that the following matrices satisfy
the difference equations (28-80), for all = to:

gull — C(t)] |

®*(t + 1; n= 0 0

a? + drn2b?C(t) "|

PX(t+ 1) = | 0 i?

b2
a? + b? + ou?b?C(t)

where t20 (38)

Ci+1)=1-

Since it was assumed that z,(0) = 0, neither 2,(1) nor z2(1) can
be predicted from the measurement of y:(0). Hence the meas-
urement at time é = 0 is useless, which shows that we should set
C(0) = 0. This fact, with the iterations (38), completely deter-
mines the function C(t). The nonlinear difference equation (38)
plays the role of the Wiener-Hopf equation.

If b?/a? << 1, then C(t) & 1 which is essentially pure predic-
tion. If b2/a? >> 1, then C(t) & 0, and we depend mainly on
2,*(tlt — 1) for the estimation of m*(t + 1|t) and assign only

Journal of Basic Engineering

very small weight to the measurement y,(); this is what one
would expect when the measured data are very noisy.

In any case, x2*(¢/{ — 1) = 0 at all times; one cannot predict
independent noise! This means that *12. can be set equal to
zero. The optimal predictor is a first-order dynamic system.
See Remark (3).

To find the stationary Wiener filter, let £ = © on both sides of
(38), solve the resulting quadratic equation in C(@), etc.

Example 2, A number of particles leave the origin at time f = 0
with random velocities; after £ = 0, each particle moves with a
constant (unknown) velocity. Suppose that the position of one
of these particles is measured, the data being contaminated by
stationary, additive, correlated noise. What is the optimal
estimate of the position and velocity of the particle at the time
of the last measurement?

Let 2,(¢) be the position and 2,(¢) the velocity of the particle;
2x,(t) is the noise. The problem is then represented by the model,

a(t + 1) = a(t) + 22(2)
x(t + 1) = a(t)
wat + 1) = a(t + 1; t)aa(t) + us(t)
y(t) = a(t) + 2(t)
and the additional conditions

1 t, = t; to =0

2 Ex7(0) = Ex(0) = 0, Hx%0) = a? > 0;
3 Hu;(t) = 0, Hus%(t) = b?.

4 s(t + 1; t) = oss = const.

According to Theorem 3, x*(¢|¢) is calculated using the dynamic
system (31).

First we solve the problem of predicting the position and ve-
locity of the particle one step ahead. Simple considerations
show that

a a*® 0 0
P*(1) =| a? a? O and A*(0) =] 0
0 O Bb 1

It is then easy to check by substitution into equations (28-30)
that

* —_ _ vo
PO = Gaon

2 t — diat(t — 1)
xX t 1 —da(t — 1)
—dai(t — 1) —ds(t — 1) dat — 1)? + Ci(t — 1)

is the correct expression for the covariance matrix of the predic-
tion error x(t|t — 1) for all ¢ = 1, provided that we define

C\(0) = b?/a?
C(t) = Cit — 1) + [t — dat — 1), t 21

It is interesting to note that the results just obtained are valid
also when ¢3; depends on ¢. This is true also in Example 1. In
conventional treatments of such problems there seems to be an
essential difference between the cases of stationary and nonsta-
tionary noise. This misleading impression created by the con-
ventional theory is due to the very special methods used in solving
the Wiener-Hopf equation.

Introducing the abbreviation

C0) = 0
C(t) = t — du(t — 1),¢ 21
and observing that
cov x(t + 1|t)

P*(t + 1)
P(t + 1; t)[cov x(é|t)]M(t + 1; 0) + QMO

MARCH 1960 / 43

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 010 ---
the matrices occurring in equation (31) and the covariance

matrix of x(¢ |t) are found after simple calculations. We have,
for allt = 0,
iC(t)
Dt; t+ 1)A*(t) = AG C(t)
Ci(t) — 1C2(t)
Dt; t+ 1)O*(t + 1; (+ 1; 2)
1 C(t) — tC2(t) C(t) — C(t) — dastCr(t)
= CD — C(t) C(t) — C(t) — d33C2(t)
OY L=G) + Ct) — CU) FUCK) + st CK)
and
5 ? t —t
cov x(t|t) = Bx(d|t)x’(t\t) = GW 1 -t

To gain some insight into the behavior of this system, let us
examine the limiting case ¢ > © of a large number of observa-
tions. Then C,(é) obeys approximately the differential equation

dC\(t)/dt = C2*(t) (t>1)
from which we find

Cit) = (1 — dy3)*t8/3 + Gsa(1 — daa)? + Gast + b?/a?
(é>1) (89)

Using (39), we get further

1 1 0 0
DP*m => 0 1 0} and ®7A* =! 0
—1I md 0 1

(¢ >1)

Thus as the number of observations becomes large, we depend
almost exclusively on a*(¢|t) and ao*(é|t) to estimate a,*(¢ +
1]é + 1) and a*(¢ + ij + 1). Current observations are used
almost exclusively to estimate the noise

as*(t\t) = y(t) — a(t) = (> 1)

One would of course expect something like this since the prob-
Jem is analogous to fitting a straight line to an increasing number
of points.

As a second check on the reasonableness of the results given,
observe that the case ¢ > 1 is essentially the same as prediction
based on continuous observations. Setting ¢;; = 0, we have

a?b?(?
F%,2(t\t) = roe alt/3 (t >1; dss = 0)

which is identical with the result obtained by Shinbrot [11],
Example 1, and Solodovnikoy [14], Example 2, in their treat-
ment of the Wiener problem in the finite-length, continuous-data
case, using an approach entirely different from ours.

Conclusions

This paper formulates and solves the Wiener problem from the
“state” point of view. On the one hand, this leads to a very gen-
eral treatment including cases which cause difficulties when at-
tacked by other methods. On the other hand, the Wiener prob-
lem is shown to be closely connected with other problems in the
theory of control. Much remains to be done to exploit these
connections.

44 / marcH 1960

References

1 N. Wiener, ‘The Extrapolation, Interpolation and Smoothing
of Stationary Time Series,’’ John Wiley & Sons, Inc., New York,
N. Y., 1949.

2 L.A. Zadeh and J. R. Ragazzini, ‘‘An Extension of Wiener's
Theory of Prediction,’’ Journal of Applied Physics, vol. 21, 1950, pp.
645-655.

3 H.W. Bode and C. E. Shannon, ‘‘A Simplified Derivation of
Linear Least-Squares Smoothing and Prediction Theory,” Proceed-
ings IRE, vol. 38, 1950, pp. 417-425.

4 R.C. Booton, ‘An Optimization Theory for Time-Varying
Linear Systems With Nonstationary Statistical Inputs,’’ Proceedings
IRE, vol. 40, 1952, pp. 977-981.

5 J. H. Laning and R. H. Battin, ‘Random Processes in Auto-
matic Control,” McGraw-Hill Book Company, Inc., New York, N.Y.,
1956.

6 W.B. Davenport, Jr., and W. L. Root, ‘‘An Introduction to
the Theory of Random Signals and Noise,’” McGraw-Hill Book Com-
pany, Inc., New York, N. Y., 1958.

7 §S. Darlington, “Linear Least-Squares Smoothing and Pre-~
diction, With Applications,’ Bell System Tech. Journal, vol. 37, 1958,
pp. 1221-1294,

8 G. Franklin, ‘‘The Optimum Synthesis of Sampled-Data Sys-
tems,’’ Doctoral dissertation, Dept. of Elect. Engr., Columbia Uni-
versity, 1955.

9 A. B. Lees, ‘Interpolation and Extrapolation of Sampled
Data,” Trans. IRE Prof. Group on Information Theory, IT-2, 1956, pp.
173-175.

10 R.C. Davis, ‘On the Theory of Prediction of Nonstationary
Stochastic Processes,’’ Journal of Applied Physics, vol. 23, 1952, pp.
1047-1053.

11 M. Shinbrot, ‘‘Optimization of Time-Varying Linear Systems
With Nonstationary Inputs,’ Trans. ASME, vol. 80, 1958, pp. 457-
462.

12 M. Blum, “Recursion Formulas for Growing Memory Digital
Filters,’ Trans. IRE Prof. Growp on Information Theory, IT-4, 1958,
pp. 24-30.

13 V.S. Pugachev, ‘‘The Use of Canonical Expansions of Random
Functions in Determining an Optimum Linear System,’’ Automatics
and Remote Control (USSR), vol. 17, 1956, pp. 489-499; translation
pp. 545-556.

14 V. V. Solodovnikov and A. M. Batkov, “On the Theory of
Self-Optimizing Systems (in German and Russian),’’ Proc. Heidelberg
Conference on Automatic Control, 1956, pp. 308-323.

15 J. L. Doob, “Stochastic Processes,’ John Wiley & Sons, Inc.,
New York, N. Y., 1955.

16 M. Loéve, ‘Probability Theory,” Van Nostrand Company,
Inc., New York, N. Y., 1955.

17 R.E. Bellman, I. Glicksberg, and O. A. Gross, ‘‘Some Aspects
of the Mathematical Theory of Control Processes,’’? RAND Report
R-313, 1958, 244 pp.

18 R. E. Kalman and R. W. Koepcke, ‘Optimal Synthesis of
Linear Sampling Control Systems Using Generalized Performance
Indexes,”’ Trans. ASME, vol. 80, 1958, pp. 1820-1826.

19 J. E. Bertram, “Effect of Quantization in Sampled-Feedback
Systems,”’ Trans. AIEFE, vol. 77, II, 1958, pp. 177-182.

20 R. E. Kalman and J. E. Bertram, ‘General Synthesis Proce-
dure for Computer Control of Single and Multi-Loop Linear Sys-
tems,” Trans. AIFE, vol. 77, II, 1958, pp. 602-609.

21 C.W. Merriam, ITI, ‘‘A Class of Optimum Control Systems,”
Journal of the Franklin Institute, vol. 267, 1959, pp. 267-281.

22 RK. E. Kalman and J. E. Bertram, ‘‘A Unified Approach to the
Theory of Sampling Systems,” Journal of the Franklin Institute, vol.
267, 1959, pp. 405-436.

23 R.E. Kalman and R. W. Koepcke, ‘The Role of Digital Com-
puters in the Dynamic Optimization of Chemical Reactors,’’ Proc.
Western Joint Computer Conference, 1959, pp. 107-116.

24 R.E. Kalman, ‘Dynamic Optimization of Linear Control Sys-
tems, I. Theory,’ to appear. ;

25 SS. Sherman, ‘‘Non-Mean-Square Error Criteria,’’ Trans. IRE
Prof. Group on Information Theory, IT-4, 1958, pp. 125-126.

26 V.S. Pugachev, “On a Possible General Solution of the
Problem of Determining Optimum Dynamic Systems,’’ Automatics
and Remote Control (USSR), vol. 17, 1956, pp. 585-589.

27 G.C. Newton, Jr., L. A. Gould, and J. F. Kaiser, ‘‘Analytical
Design of Linear Feedback Controls,’’ John Wiley & Sons, Inc., New
York, N. Y., 1957.

28 O. J. M. Smith, ‘Feedback Control Systems,’’ McGraw-Hill
Book Company, Inc., New York, N. Y., 1958.

29 R&R. E. Kalman, ‘On the General Theory of Control Systems,”’
Proceedings First International Conference on Autowmatie Control,
Moscow, USSR, 1960.

Transactions of the ASME

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al

--- PAGE 011 ---
APPENDIX
RANDOM PROCESSES: BASIC CONCEPTS

For convenience of the reader, we review here some elementary
definitions and facts about probability and random processes.
Everything is presented with the utmost possible simplicity;
for greater depth and breadth, consult Laning and Battin [5] or
Doob [15].

A random variable is a function whose values depend on the out-
come of a chance event. The values of a random variable may be
any convenient mathematical entities; real or complex numbers,
vectors, etc. For simplicity, we shall consider here only real-
valued random variables, but this is no real restriction. Random
variables will be denoted by 2, y, ... and their values by &, 7,....
Sums, products, and functions of random variables are also ran-
dom variables.

A random variable x can be explicitly defined by stating the
probability that x is less than or equal to some real constant &.
This is expressed symbolically by writing

F(&) is called the probability distribution function of the random
variable zx. When F,(&) is differentiable with respect to &, then
fA) = dF,()/dé is called the probability density function of =.

The expected value (mathematical expectation, statistical average,
ensemble average, mean, etc., are commonly used synonyms) of
any nonrandom function g(x) of a random variable z is defined by

Bg(2) = Btoa = f° o@arce) = f°, oeyceae (40)

As indicated, it is often convenient to omit the brackets after
the symbol #. A sequence of random variables (finite or infinite)

{x(t)} =...,2(—1), 2(0), 2(1),... (41)

is called a discrete (or discrete-parameter) random (or stochastic)
process. One particular set of observed values of the random
process (41)

+4 &—1), &(0), &(1),...

is called a realization (or a sample function) of the process. In-
tuitively, a random process is simply a set of random variables
which are indexed in such a way as to bring the notion of time into
the picture.
A random process is uncorrelated if
Ex(t)z(s) = Ex(t)Ex(s) (t #s)
If, furthermore,

Ex(i)x(s) = 0 (t ¥ s)

then the random process is orthogonal. Any uncorrelated random
process can be changed into orthogonal random process by re-
placing x(t) by x’(t) = x(t) — Fx(t) since then

Ex'(t)z'(s) = E[x(t) — Ex(t)]-[x(s) — Ex(s)]
= Ex(t)x(s) — Ex(t)E2(s) = 0

It is useful to remember that, if a random process is orthogonal,
then

Ele(t) + 2(t),+...]? = Exh) + ExX(h)+...(4 #t ...)

If x is a vector-valued random variable with components 21, . . .,
x, (which are of course random variables), the matrix

(E(x; — Ex;)(z; — Ex;)] = E(x — Ex)(x’ — Ex’)
= covx (42)

is called the covariance matrix of x.

Journal of Basic Engineering

A random process may be spec’fied explicitly by stating the
probability of simultaneous oceurrene> »f any finite number of
events of the type

wh) S &,..., c(t,) S &5 (a #.
Pr{(z(i) S &,.. +, 2(tn) S &n)] = Pee....y 2ctm(Es +) En) (48)

where Fyra),..., z(tn) is called the joint probability distribution
function of the random variables x(t), ..., x(t,). ‘The joint
probability density function is then

” &,) = OF nc) teoes 2(tn)/O81, coe &,

provided the required derivatives exist. The expected value
Eg[x(t), ..., 2(t,)] of any nonrandom function of n random varia-
bles is defined by an n-fold integral analogous to (40).

A random process is independent if for any finite 4) ~... ¥ ty,
(43) is equal to the product of the first-order distributions

Pr[w(h) S$ &]..~. Pri(t,) S &)

If a set of random variables is independent, then they are obvi-
ously also uncorrelated. The converse is not true in general. For
a set of more than 2 random variables to be independent, it is not
sufficient that any pair of random variables be independent.

Frequently it is of interest to consider the probability distribu-
tion of a random variable 2(t,4:) of a random process given the
actual values &(4), ..., &(¢,) with which the random variables
x(t), ..., 2(1,) have occurred. This is denoted by

.. ¥£1,), ie,

Secu)... 2(tn( Ei,» »

fe: Sec),. ee -2(tng)( Es, eeey Ent )dEns 12
- Fecs...v2ttm( bry «+ y En) ane

which is called the conditional probability distribution function of
(tnt) given x(4),..., (t,). The conditional expectation

E{g[x(tn)]|2(), . - + 2(t,)}

is defined analogously to (40). The conditional expectation is a
random variable; it follows that

E(B {gle(tnn) a(t), . . ., 2(ta)}] = Bf gleltns))}

In all cases of interest in this paper, integrals of the type (40)
or (44) need never be evaluated explicitly; only the concept of the
expected value is needed.

A random variable x is gaussian (or normally distributed) if

1 (= ot)

f.{§) = 2 E(x — En)

1
[2rE(« — Ex)2]'7 *P [-

which is the well-known bell-shaped curve. Similarly, a random
vector x is gaussian if

f(®) = E 3 (& — Bx)'C-UE — Bx) |

1
(2m)""(det Cy72 “XP
where C—! is the inverse of the covariance matrix (42) of x. A
gaussian random process is defined similarly.

The importance of gaussian random variables and processes is
largely due to the following facts:

Theorem 5. (A) Linear functions (and therefore conditional ex-
pectations) on a gaussian random process are gaussian random
variables.

(B) Orthogonal gaussian random variables are independent.

(C) Given any random process with means Ex(t) and covariances
Eix(t)x(s), there exists a unique gaussian random process with the
same means and covariances.

MARCH 1960 / 49

Downloaded From: http://fluidsengineering.asmedigitalcollection.asme.org/pdfaccess.ashx? url=/data/journals/jfega4/27220/ on 05/03/2017 Terms of Use: http://www.asme.org/al
