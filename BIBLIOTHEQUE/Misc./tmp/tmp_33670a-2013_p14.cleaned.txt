                           Algorithm 2 Pseudocode for computing a stochastic gradient using our estimator. See text for
                           meaning of the functions f , g  and h .
                                                     Ï† Ï†         Ï†
                           Require: Ï† (Current value of variational parameters)
                             g â†0
                             for l is 1 to L do
                                 xâ†RandomdrawfromdatasetX
                                  â†Randomdrawfrompriorp()
                                 Î¶ â†Randomdrawfrompriorp(Î¶)
                                 g â†g+ 1âˆ‡ f (x,g (,x),h (Î¶))
                             endfor        L Ï† Ï†        Ï†        Ï†
                             return g
                           where Âµ and Ïƒz are yet unspeciï¬ed functions of x. Since they are Gaussian, we can parameterize
                                   z
                           the variational approximate posteriors:
                                                        e
                                          qÏ†(Î¸)    as   Î¸ = Âµ +ÏƒÎ¸Î¶                      where    Î¶ âˆ¼ N(0,I)
                                                              Î¸
                                                        e
                                        q (z|x)    as   z = Âµ +Ïƒ                        where     âˆ¼ N(0,I)
                                         Ï†                    z     z
                           With  we signify an element-wise product. These can be plugged into the lower bound deï¬ned
                           above (eqs (21) and (22)).
                           In this case it is possible to construct an alternative estimator with a lower variance, since in this
                           modelp (Î¸),p (z),q (Î¸)andq (z|x)areGaussian,andthereforefourtermsoff canbesolved
                                   Î±      Î¸      Ï†          Ï†                                                Ï†
                           analytically. The resulting estimator is:
                                              L      ï£« J                                                             ï£¶
                                           1 X       ï£­1X                 (l) 2      (l) 2     (l) 2             (i) (i) ï£¸
                              L(Ï†;X)'            NÂ·           1+log((Ïƒ ) )âˆ’(Âµ ) âˆ’(Ïƒ )                +logp (x z )
                                          L            2                 z,j        z,j       z,j           Î¸
                                             l=1         j=1
                                             J                                       
                                       +1X 1+log((Ïƒ(l))2)âˆ’(Âµ(l))2âˆ’(Ïƒ(l))2                                               (24)
                                          2                 Î¸,j        Î¸,j       Î¸,j
                                            j=1
                            (i)      (i)                                           (i)      (i)
                           Âµ   and Ïƒ    simply denote the j-th element of vectors Âµ   and Ïƒ   .
                            j        j
                                                                          14
