                                                           0.150                                                                                                                                                                        0.18
                                                                                                       1.50                                         0.25                                     3  125                                     0.16
                                                           0.125                                                                                                                             −
                                                                                                       1.25                                                                                   10
                                                                                                                                                    0.20                                      y 100                                     0.14
                                                           0.100                                       1.00
                                                          elocity                                     elocity                                     elocity0.15                                 Accurac75                                elocity0.12
                                                          V0.075                                      V                                           V                                                                                    V
                                                                                                       0.75                                                                                   for                                       0.10
                                                          MAE0.050                                    MAE                                         MAE0.10                                        50                                    MAE
                                                                                                       0.50
                                                                                                                                                    0.05                                         25                                     0.08
                                                           0.025                                       0.25                                                                                   Iterations
                                                                                                                                                                                                                                        0.06
                                                           0.000     SRC   NON    PRE   SOL32          0.00    SRC    PRE    NON SOL128             0.00   SRC    PRE   NON SOL4                  0    SRC    SOLDIV  SOL5                      SRC    NON    SOL16
                                                              (a) Unsteady wake                         (b) Buoyancy-driven                      (c) Advection-diffusion                          (d) CGsolver                            (e) 3D wake
                                                                                                                                                                                                              0.6
                                                            0.8                                                          0.6
                                                           ement                                                        ement                                                                               elocity
                                                           v                                                            v0.5                                                                                V             SRC
                                                                                                                                                                                                            of0.4
                                                            0.6                                                          0.4                                                                                              NON
                                                           Impro                                                        Impro                                                                               Freq.         PRE
                                                           Error0.4                                                     Error0.3                                                                            of0.2         SOL32
                                                                                                                         0.2                                                                                Error
                                                           elocity0.2                                                   elocity                                                                             L2
                                                           V                                                            V0.1
                                                            0.0               SOL   SOL  SOL   SOL                       0.0                                                                                      ×1          ×2         ×4          ×8         ×16
                                                                  NON   PRE      4     8    16    32                             PRE   NON    SOL2  SOL4  SOL8  SOL16 SOL32  SOL64 SOL128                                         Reynolds Number
                                                         (f) Unsteady wake, look-ahead                                         (g) Buoyancy-driven, look-ahead                                               (h) Unsteady wake, frequency error
                                                        Figure 4: (a)-(e) Numerical approximation error w.r.t. reference solution for unaltered simulations
                                                        (SRC)andwithlearnedcorrections. The models trained with differentiable physics and look-ahead
                                                        achieve signiﬁcant gains over the other models. (f,g) Relative improvement over varying look-ahead
                                                        horizons. (h) A frequency-based evaluation for the unsteady wake ﬂow scenario.
                                                        to produce the pressure ﬁeld p, we instead target the learning objective to produce an initial guess,
                                                        which is improved by a regular CG solver until a given accuracy threshold is reached.
                                                        This goal can be reached by directly minimizing the right-hand side term ∇ · u, similar to physics-
                                                        basedlosstermsproposedinavarietyofstudies[43,52]. Alternatively,wecanemployadifferentiable
                                                        CGsolverandformulatethe learning goal as minimizing the same residual after n steps of the CG
                                                        solver (similar to the SOLn models above). While the physics-based loss version reduces the initial
                                                        divergence more successfully, it fares badly when interacting with the CG solver: compared to the
                                                        SOLversion, it requires 63% more steps to reach a desired accuracy. Inspecting the inferred solutions
                                                        reveals that the former model leads to comparatively large errors near boundaries, which are small for
                                                        each grid cell but signiﬁcantly inﬂuence the solution on a large scale. The SOL version immediately
                                                        receives feedback about this behavior via the differentiable solver iterations. I.e., the differentiable
                                                        solver provides a look-ahead of how different parts of the solution affect future states. In this way, it
                                                        can anticipate problems such as those in the vicinity of boundary conditions.
                                                        Three-dimensional Fluid Flow                                             Lastly, we investigate a 3D case of incompressible ﬂow. The
                                                        overall setup is similar to the unsteady wake ﬂow in two dimensions outlined above, but the third
                                                        dimension extends the axes of rotation in the ﬂuid from one to three, yielding a very signiﬁcant
                                                        increase in complexity. As a result, the ﬂow behind the cylindrical obstacle quickly becomes chaotic
                                                        and forms partially turbulent eddies, as shown in Fig. 1. This scenario requires signiﬁcantly larger
                                                        models to learn a correction function, and the NON version does not manage to stabilize the ﬂow
                                                        consistently. Instead, the SOL16 version achieves stable rollouts for several hundred time steps and
                                                        successfully corrects the numerical inaccuracies of the coarse discretization, improving the numerical
                                                        accuracy of the source (SRC) simulation by more than 22% across a wide range of conﬁgurations.
                                                        5         Ablations and Discussion
                                                        Weperformed an analysis of the proposed training via differentiable physics to highlight which
                                                        hyperparameters most strongly inﬂuence results. Speciﬁcally, we evaluate varying look-ahead
                                                        horizons, different model architectures, training via perturbations, and pre-computed variants.
                                                        Future Look-Ahead For systems with deterministic behavior, long rollouts via differentiable
                                                        physics at training time yield signiﬁcant improvements, as shown in Fig. 4f and 4g. While training
                                                        with a few (1 to 4) steps yields improvements of up to 40% for the buoyancy-driven ﬂow scenario,
                                                        this number can be raised signiﬁcantly by increasing the look-ahead at training time. A performance
                                                        of more than 54% can be achieved by 64 recurrent solver iterations, while raising the look-ahead to
                                                                                                                                                              7
