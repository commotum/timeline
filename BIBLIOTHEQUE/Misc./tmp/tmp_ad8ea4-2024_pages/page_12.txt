                             A RotationAngleDistributionDetails                                                                    Figure 8 illustrates the disturbance to each di-
                             A.1        Rotation Angle Distribution                                                           mensional distribution caused by PI(Chen et al.,
                                                                                                                              2023) ,YaRN(Peng et al., 2023) and our method
                             Figure 6 illustrates the complete rotary angle dis-                                             whenthecontext window of the model is extended
                             tributions of the 6th and 22nd dimensions when the                                               to 8k and 16k. Our method achieves the lowest
                             numberofintervals is set to 360.                                                                 disturbance to the distribution.
                                   0.004                                                                                            1.0
                                                                                                                                    0.8
                                   0.003                                                                                            0.6
                                  equency0.002                                                                                      0.4
                                  r
                                  F0.001                                                                                           Disturbance0.2
                                   0.000                                                                                            0.0
                                   0.006                                                                                            0.8
                                                                                                                                    0.6
                                   0.004                                                                                            0.4
                                  equency
                                  r                                                                                                Disturbance
                                  F0.002                                                                                            0.2
                                                                                                                                    0.0
                                   0.000                                                                                                   0         10        20       30        40        50        60
                                            0        50       100      150       200      250       300      350                                                      Dimension
                                                                        Rotation Angle                                                                   Interpolation          YaRN          Ours
                                                Pre-Trained L=4K               Interpolation(s=2) L0=8K
                                                Extraplolation L0=8K                                                          Figure 8: Illustration of the impact of PI, YaRN and
                                                                                                                              our method on each dimensional distribution. Upper:
                             Figure 6: Complete rotary angle distributions of 6th and                                         Disturbance when the context window is extended to
                             22nd dimensions when the number of intervals is set to                                           8k. Lower: Disturbance when the context window is
                             360.                                                                                             extended to 16k.
                             A.2        Disturbance of Different Method                                                       B ExperimentalDetails
                               Figure 7 illustrates the disturbance to each dimen-                                            B.1       Experimental Setup
                             sional distribution caused by interpolation and ex-                                             We use 8 A100 GPUs and adopt ZeRO3 (Rajb-
                             trapolation when the context window of the model                                                 handari et al., 2020) strategies during the training
                             is extended to 8k and 16k. Interpolation and extrap-                                             stage, and use AdamW (Loshchilov and Hutter,
                             olation exhibit advantages in different dimensions,                                              2019) optimizer with β = 0.9 and β = 0.999. We
                                                                                                                                                                       1                      2
                             respectively.                                                                                                                                         −5
                                                                                                                              set the learning rate to 2 × 10                            without warmup
                                                                                                                              andweightdecay. Whenextendingthecontextwin-
                                                                                                                              dowto8k,wespentapproximately6hourstraining
                                    1.0                                                                                       LLaMA-7Bandapproximately10hourstraining
                                                                                                                              LLaMA2-13B. When extending the context win-
                                   Disturbance0.5                                                                             dowto16k,wespentapproximately 7 hours train-
                                    0.0                                                                                       ing LLaMA-7Bandapproximately11hourstrain-
                                                                                                                              ing LLaMA2-13B. Both training and testing are
                                    0.6                                                                                       accelerated by FlashAttention-2 (Dao, 2023).
                                    0.4
                                   Disturbance0.2                                                                             B.2       Additional Experimental Results
                                    0.0                                                                                       B.2.1         RULERBenchmark
                                           0        10        20        30        40        50        60
                                                                      Dimension                                              TheRULER(Hsiehetal.,2024)benchmarkisem-
                                                            Extrapolation          Interpolation                              ployed to evaluate the long-context retrieval capa-
                             Figure 7: Illustration of the impact of interpolation and                                        bilities of models, with the performance of differ-
                             extrapolation on each dimensional distribution. Upper:                                           ent methods on this benchmark presented in Table
                             Disturbance when the context window is extended to                                               8. Although the retrieval performance on short
                             8k. Lower: Disturbance when the context window is                                                texts has decreased, all methods have enhanced
                             extended to 16k.                                                                                 the model’s ability to retrieve information from
                                                                                                                      7299
