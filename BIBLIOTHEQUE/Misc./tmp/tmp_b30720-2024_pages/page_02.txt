                  a                                                                                   bd
                       A simple problem                                                                   AlphaGeometry                                                 Solution
                                                                                                                           S                                                                 A
                                               A                                                                           Symbolic
                                                                                                                            deduce               Solved!
                                                                                                                                      Not
                                                                                                         Construct                 solved
                            BC B D C
                     “Let ABC be any triangle with AB = AC. 
                       Prove that ∠ABC = ∠BCA.” 
                                                                                                          c Language model
                  e IMO 2015 P3                                                                                                    f Solution
                                                                                                                                                                                                                  AAA
                     “Let ABC be an acute triangle. Let                               A
                     (O) be its circumcircle, H its                                                                                                                                                                          QQQ
                     orthocenter, and F the foot of the                                          Q                                                                                                                    O2
                                                                                     O
                     altitude from A. Let M be the                                    1   O2                                                                                                                    O                   K
                                                                                                       K                                                                                                         1
                     midpoint of BC. Let Q be the point                             OOO                          Alpha-                                                                                       OOO
                     on (O) such that QH ⊥ QA and let K                                                       Geometry                                                                                           HHH
                     be the point on (O) such that KH ⊥                              H                                                                                                                   DD              EE
                     KQ. Prove that the circumcircles                                                                                                                                                                   GGG
                     (O ) and (O ) of triangles FKM and                            M    F          C                                                                                           B
                        1           2                                                                                                                                                                        M     F          C
                     KQH are tangent to each other.” 
                 Fig. 1 | Overview of our neuro-symbolic AlphaGeometry and how it solves                                       midpoint of BC”. The proof consists of two other steps, both of which make use 
                 both a simple problem and the IMO 2015 Problem 3. The top row shows how                                       of the midpoint properties: “BD = DC” and “B, D, C are collinear”, highlighted in 
                 AlphaGeometry solves a simple problem. a, The simple example and its diagram.                                 blue. The bottom row shows how AlphaGeometry solves the IMO 2015 Problem 
                 b, AlphaGeometry initiates the proof search by running the symbolic deduction                                 3 (IMO 2015 P3). e, The IMO 2015 P3 problem statement and diagram. f, The 
                 engine. The engine exhaustively deduces new statements from the theorem                                       solution of IMO 2015 P3 has three auxiliary points. In both solutions, we arrange 
                 premises until the theorem is proven or new statements are exhausted.                                         language model outputs (blue) interleaved with symbolic engine outputs to 
                 c, Because the symbolic engine fails to find a proof, the language model                                      reflect their execution order. Note that the proof for IMO 2015 P3 in f is greatly 
                 constructs one auxiliary point, growing the proof state before the symbolic                                   shortened and edited for illustration purposes. Its full version is in the 
                 engine retries. The loop continues until a solution is found. d, For the simple                               Supplementary Information.
                 example, the loop terminates after the first auxiliary construction “D as the 
                 medallist on a test set of 30 classical geometry problems translated 
                 from the IMO as shown in Fig. 2.
                                                                                                                                                            Number of solved problems in IMO-AG-30
                                                                                                                                    30 
                 Synthetic theorems and proofs generation                                                                                                                                                 25.0           25.9
                 Our method for generating synthetic data is shown in Fig. 3. We                                                                                                           22.9
                 first sample a random set of theorem premises, serving as the input                                                20                                      19.3
                 to the symbolic deduction engine to generate its derivations. A full                                                           Average IMO
                                                                                                                                                  contestant
                 list of actions used for this sampling can be found in Extended Data                                                   15.2
                 Table 1. In our work, we sampled nearly 1 billion of such premises in                                                                       14.3
                 a highly parallelized setting, described in Methods. Note that we do                                               10        10.0
                 not make use of any existing theorem premises from human-designed                                                Number of solved problems
                 problem sets and sampled the eligible constructions uniformly  
                 randomly.
                    Next we use a symbolic deduction engine on the sampled prem-                                                     0 
                                                                                                                                            Previous      Honorable        Bronze          Silver   AlphaGeometry        Gold
                 ises. The engine quickly deduces new true statements by following                                                      state of the art  mentions        medallist      medallist                     medallist
                 forward inference rules as shown in Fig. 3b. This returns a directed                                                   (Wu’s method)
                 acyclic graph of all reachable conclusions. Each node in the directed                                         Fig. 2 | AlphaGeometry advances the current state of geometry theorem 
                 acyclic graph is a reachable conclusion, with edges connecting to its                                         prover from below human level to near gold-medallist level. The test 
                 parent nodes thanks to the traceback algorithm described in Methods.                                          benchmark includes official IMO problems from 2000 to the present that  
                 This allows a traceback process to run recursively starting from any                                          can be represented in the geometry environment used in our work. Human 
                 node N, at the end returning its dependency subgraph G(N), with its                                           performance is estimated by rescaling their IMO contest scores between 0 and 
                 root being N and its leaves being a subset of the sampled premises.                                           7 to between 0 and 1, to match the binary outcome of failure/success of the 
                 Denoting this subset as P, we obtained a synthetic training example                                           machines. For example, a contestant’s score of 4 out of 7 will be scaled to 0.57 
                 (premises, conclusion, proof) = (P, N, G(N)).                                                                 problems in this comparison. On the other hand, the score for AlphaGeometry 
                    In geometry, the symbolic deduction engine is deductive database                                           and other machine solvers on any problem is either 0 (not solved) or 1 (solved). 
                 (refs. 10,17), with the ability to efficiently deduce new statements from                                     Note that this is only an approximate comparison with humans on classical 
                                                                                                                               geometry, who operate on natural-language statements rather than narrow, 
                 the premises by means of geometric rules. DD follows deduction rules                                          domain-specific translations. Further, the general IMO contest also includes 
                 in the form of definite Horn clauses, that is, Q(x) ← P1(x),…, Pk(x), in                                      other types of problem, such as geometric inequality or combinatorial geometry, 
                 which x are points objects, whereas P1,…, Pk and Q are predicates                                             and other domains of mathematics, such as algebra, number theory and 
                 such as ‘equal segments’ or ‘collinear’. A full list of deduction rules                                       combinatorics.
                                                                                                                                                                         Nature | Vol 625 | 18 January 2024 | 477
