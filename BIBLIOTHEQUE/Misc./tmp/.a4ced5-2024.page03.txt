                                                                     H. Yang, Z. Li, X. Wang et al.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Theoretical and Applied Mechanics Letters 14 (2024) 100527
                                                                     Fig.                   1.  Architecture                                                                              of  the                              IFactFormer.                                                                 Note                           that                       the                   quantities                                                  of  Ì†µÌ±Ñ ‚àïÌ†µÌ∞æ‚àïÌ†µÌ±â and                                                                        Ì†µÌºÖ ‚ãÖ, ‚ãÖ                             are               depended                                                    on                the                   number                                          of  multi-head                                                                   attention,                                                 where                                  Ì†µÌ∞ø is  the                                      number                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (  ) 
                                                                     of          iterations                                                and                      Ì†µÌ±õ = 3 is  the                                                     number                                          of  dimensions.                                                                        The                      details                                   of  position                                                    encoding                                                are                   presented                                                  in  Appendix                                                             A  .  
                                                                     kernel                                  size                            1 , Ì†µÌ±á                                       is         utilized                                               as  the                                         lifting                                      layer                                  Ì†µÌ±É ,  yielding                                                                   the                        sin-                                                        Table                              1  
                                                                                                                                                  (                            )                                                                                                                                                                                                                                                                                                                                                                                        The                    training                                         hyperparameters                                                                                     for                 all               data-driven                                                           models.                                         
                                                                     gle                Ô¨Åeld                               Ì†µÌ±£ ( Ì†µÌ±•, 0ŒîÌ†µÌ±† ) .  Then,                                                                                    the                        single                                     Ô¨Åeld                               subject                                            to  iterative                                                                  updates                                                 
                                                                     Ì†µÌ±£ ( Ì†µÌ±•, 0ŒîÌ†µÌ±† ) ‚Ü¶ Ì†µÌ±£ ( Ì†µÌ±•, 1ŒîÌ†µÌ±† ) ‚Ü¶ ‚ãØ ‚Ü¶ Ì†µÌ±£ ( Ì†µÌ±•, Ì†µÌ∞ø ŒîÌ†µÌ±† ) via                                                                                                                                                                                                                implicit                                              factorized                                                          attention                                                                                              Epochs                                                                Batch                                                                       Learning                                                                                Scheduler                                                                              Decay                                                                        Decay                           
                                                                     layers,                                   which                                       are                     modeled                                                    as  a  learnable                                                                              integration                                                                operator.                                                     Finally,                                                                                                                                                            size                                                                        rate                 (  lr  )                                                           of         lr                                                                          period                                                                       factor                        
                                                                     the                  projection                                                           layer                               Ì†µÌ±Ñ (a  three-layer                                                                                        MLP)                                  is  utilized                                                       to  derive                                                   the                      out-                                                                   30                                                                    2                                                                           0.0001                                                                                  StepLR                                                                                 50000                                                                           0.7              
                                                                     put.                      DiÔ¨Äerent                                                    from                              the                     factorized                                                        attention,                                                       the                     IFactFormer                                                                      models                                           the                     
                                                                     iterations                                                   of  the                                   attention                                                      layer                                as  a  numerical                                                                                   solver                                     grounded                                                         in  the                                    
                                                                     Euler                             method:                                                                                                                                                                                                                                                                                                                                                                                                                                                          with                          predeÔ¨Åned                                                               energy                                          levels                                  of  Ì†µÌ∞∏ (1) = 1 . 242477 and                                                                                                                               Ì†µÌ∞∏ (2) = 0 . 391356 
                                                                                                                                                                                     IFactFormer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0                                                                                                                                        0 
                                                                     Ì†µÌ±£ Ì†µÌ±•, Ì†µÌ±ô + 1 ŒîÌ†µÌ±† = Óà∏                                                                                                                                                         Ì†µÌ±£ Ì†µÌ±•, Ì†µÌ±ôŒîÌ†µÌ±†                                                                                                                                                                                                                                                                                                         [55,56]                                           .   Furthermore,                                                                             to  mitigate                                                                 aliasing                                               errors                                     arising                                         from                                nonlin-                                            
                                                                                               [                                                     ]                                                                                        [                                                        ] 
                                                                            (                                                   )                                                                                                                         (                                       )                                                                                                                                                                                                                                                                     ear                  advection                                                         terms,                                     Fourier                                           modes                                        at  high                                        wavenumbers                                                                                 are                     truncated                                                       
                                                                                                                                                              = Ì†µÌ±£ Ì†µÌ±•, Ì†µÌ±ôŒîÌ†µÌ±† + ŒîÌ†µÌ±† Óà∏FactFormer Ì†µÌ±£ Ì†µÌ±•, Ì†µÌ±ôŒîÌ†µÌ±† ,                                                                                                                                                                                                                                                                                                   (12) 
                                                                                                                                                                                                                                                                                                                                [                                                        ] 
                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                   (                                       )                                                                                                                (                                       )                                                                                                                                                                                   following                                                    the                      two-thirds                                                           rule.                             
                                                                     where                                   ŒîÌ†µÌ±† = 1‚àï Ì†µÌ∞ø represents                                                                                                                 the                       assumed                                                     step                           size                          of  each                                             iteration                                                   in                                                                    The                      DNS                              data                              undergo                                                   Ô¨Åltering                                                to  generate                                                                   large-scale                                                              Ô¨Çow                               Ô¨Åelds                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          3 
                                                                     latent                               high-dimensional                                                                                                    space.                                       Here,                                   a  single                                               attention-based                                                                                         integral                                                                             at            grid                            resolutions                                                                 of  32                                               using                              a  sharp                                                spectral                                                Ô¨Ålter                                 with                                a  cutoÔ¨Ä
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ‚àí3 
                                                                     operator                                               is  employed,                                                                         with                              shared                                          parameters                                                                  implemented                                                                             across                                      all                                                 wavenumber                                                                          of  Ì†µÌ±ò                                 = 10 [36]                                                      .   The                           time                              step                           is  conÔ¨Ågured                                                                            at  10                                                 and                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          c 
                                                                     layers                                during                                        the                      iterative                                                process.                                                                                                                                                                                                                                                                                                                     data                         are                       recorded                                                       every                                    200                            steps.                                    Forty-Ô¨Åve                                                           random                                                  velocity                                                 Ô¨Åelds                                   
                                                                                          This                        implicit                                               iterative                                                 approach                                                        eliminates                                                             the                      need                                to  store                                              inter-                                                                are                  employed                                                            as  initial                                                   conditions,                                                                and                          numerical                                                            solutions                                                      are                      saved                                    
                                                                     mediate                                             quantities                                                         from                               the                      forward                                                pass                            for                    back                              propagation,                                                                          signif-                                                                   for                600                          time                             points                                      after                             the                      Ô¨Çow                             Ô¨Åelds                                  reach                                   statistical                                                     stability.                                                  Con-                              
                                                                     icantly                                     reducing                                                     the                       model‚Äôs                                               parameter                                                              count.                                       Consequently,                                                                                   training                                                                              sequently,                                                        the                       Ô¨Åltered                                              direct                                     numerical                                                             simulation                                                               (fDNS)                                           data,                                 with                               
                                                                     can                    be  conducted                                                                            with                             a  constant                                                          storage                                           cost                         related                                          to  the                                  number                                               of                                             dimensions                                                               of   45 √ó 600 √ó32 √ó32 √ó32 √ó3, can  be  utilized                                                                                                                                                                                                                                                              for                     training                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [                                                                                                                                                                        ] 
                                                                     iterations.                                                      Moreover,                                                           some                                studies                                        [42,48‚Äì50]                                                                 have                              also                        shown                                        that                        this                                                     and                      testing                                         datasets.                                                    These                                     datasets                                                 consist                                          of  velocity                                                               Ô¨Åelds                                  in  three                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            3 
                                                                     implicit                                          iterative                                                  method                                                 helps                                  alleviate                                                    the                       overÔ¨Åtting                                                                phenomenon                                                                                                             directions                                                      at  32                                         resolution                                                       for                     600                          time                              points                                      across                                      45  groups.                                                              The                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 rms 
                                                                     that                      occurs                                       when                                   the                     model                                       is  too                                deep.                                                                                                                                                                                                                                                                     large-eddy                                                          turnover                                                     time                               Ì†µÌºè,  calculated                                                                        as  Ì†µÌºè ‚â° Ì†µÌ∞ø ‚àïÌ†µÌ±¢                                                                                     ‚âà0 . 2 , where                                                                    Ì†µÌ∞ø
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     rms                                                                                      I                                                                                                                                         I 
                                                                                          4.           Numerical                                                          results                                    of  three-dimensional                                                                                                          homogeneous                                                                          isotropic                                              turbu-                                                                  represents                                                        the                      integral                                               scale                               and                         Ì†µÌ±¢                                denotes                                           the                      root-mean-square                                                                                                     of  
                                                                     lence.                             In  this                                        research,                                                      we  assess                                                         the                       performance                                                                           of  the                                     IFactFormer                                                                                                       velocity.                                               The                         time                             step                           size                        ŒîÌ†µÌ±° between                                                                   successive                                                           time                             points                                      is  set                              at  
                                                                     method                                           in  simulating                                                                             three-dimensional                                                                                                       incompressible                                                                                       HIT,                              compar-                                                                                 0 . 2 Ì†µÌºè.  For                                           all                   data-driven                                                                   approaches,                                                                      velocity                                               Ô¨Åelds                                   from                               the                       Ô¨Åve                          pre-                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (                                                                                                                )
                                                                     ing                  it  with                                      FNO,                                 FactFormer                                                                   and                        DSM.                                                                                                                                                                                                                                                                               ceding                                     time                              points                                       Ì†µÌ±à , Ì†µÌ±à , Ì†µÌ±à , Ì†µÌ±à , Ì†µÌ±à                                                                                                          are                  used                              to  predict                                                         the                      velocity                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1  2  3  4  5 
                                                                                          The                      study                                employs                                                 incompressible                                                                                    HIT                       through                                               direct                                 numerical                                                          sim-                                                        Ô¨Åeld                          at             the                     sixth                            time                            point                               Ì†µÌ±à                    and                      subsequent                                                                Ô¨Åelds                                are                    forecasted                                                          in              an                 
                                                                                                                                                                                                                                                                                                                                                                                      3                                                                                                                                                                                                                                                                                                                                                                        6 
                                                                     ulation                                       (DNS)                                     within                                       a  cubic                                         domain                                              of  size                                    (2œÄ) , operating                                                                                      at  a  Taylor                                                                                          autoregressive                                                                               manner.                                                 Hence,                                          there                                are                      a  total                                     of  26,775                                                       input-output                                                                        
                                                                     Reynolds                                                   number                                                Ì†µÌ±ÖÌ†µÌ±íÌ†µÌºÜ ‚âà 100 . A  grid                                                                                                resolution                                                           of  2563 cells                                                                      is  utilized                                                                                       pairs                           for                   45                   groups,                                           with                             80% allocated                                                                             for                   training                                               and                        20% for  testing.                                                                                    
                                                                     with                         periodic                                                  boundary                                                          conditions                                                             for                    accurate                                                   representation                                                                                   [4,51]                                        .                                                       For                   a  fair                                   comparison,                                                                          the                       training                                                 hyperparameters                                                                                                   for                     all                    data-                                 
                                                                     Spatial                                     discretization                                                                           is  accomplished                                                                                      using                                the                    pseudo-spectral                                                                                       method,                                                                               driven                                    models                                            are                      listed                                 in  Table                                                1  .  The                                    AdamW                                                   optimizer                                                        [57]                             is  uti-                                  
                                                                     and                     temporal                                                         integration                                                                  is  conducted                                                                              employing                                                                 the                         second-order,                                                                                                               lized                           to  minimize                                                                       the                       training                                               loss,                            with                               the                       relative                                             mean                                    square                                          er-                   
                                                                     two-step                                               Adams-Bashforth                                                                                                   scheme                                              for                    numerical                                                            stability                                                [52‚Äì54]                                                  .   To                                                  ror                 adopted                                                   as  the                                      loss                         function                                                   and                          the                       step                            learning                                                  rate                           scheduler                                                         
                                                                     maintain                                                 statistically                                                               steady                                      turbulence,                                                                 large-scale                                                            forcing                                         is  applied                                                     to                                             (StepLR)                                                is  employed                                                                        to  adjust                                                    lr  during                                                    the                      training                                                process.                                                For                        the                      
                                                                     stabilize                                            the                       velocity                                                spectrum                                                        at  the                                     lowest                                         two                           wavenumber                                                                              shells,                                                                    IFactFormer                                                                    and                        FactFormer                                                                   models,                                              we                    employ                                             a  two-layer                                                                2D                    convo-                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     3
