        440              14.  ALGORITHMIC  STATISTICS
           357 Prove that this family (of all Hamming balls) satisfies conditions (l)-(3)
        above.
           (Hint for (3):  Let A be a ball of radius a, and let c be a number less than #A. 
        We need to cover A by balls of cardinality c or less.  Without loss of generality we 
        may assume that a ^ n/2.  Indeed, if a > n/2, then we can cover A by two balls 
        Ao, A\ of radius n/2 (the set of all n-bit strings can be covered by two balls of radius 
        n/2, whose centers are the all-zero sequence and all-one sequence).  Assuming that 
        the statement holds for Aq and A\, we cover both Ao  and A\  and then join the 
        obtained families of balls.  As the cardinality of both Ao,Ai  is not more than that 
        of A, we are done.
          Let b be the maximal integer in the interval 0 • • • n/2 such that the cardinality 
        |H|  of a ball of radius  b does not  exceed c.  We will  cover A  by Hamming balls 
        of radius b.  When we increase the radius of the ball by one,  its size increases at 
        most n + 1 times.  Therefore, \B\ ^ c/(n + 1), and it suffices to cover A by at most 
        poly(n)|A|/|F?| balls of radius b.
          Cover all the strings that are at distance at most b from the center of A by one 
        ball of radius b that has the same center as A.  Partition the remaining points into 
        spheres of radii d — b + 1,..., a:  the sphere of radius d consists of all strings  at 
        Hamming distance exactly d from the center of A.  As the number of those spheres 
        is at  most n,  it suffices,  for every d €  (b, n/2],  to cover a sphere of radius d by at 
        most poly(n)|S'|/|H| balls of radius b.
          Fix d and a sphere S of radius d 6  (b, n/2].  We will show that for some f  a 
        small family of balls whose centers are at distance /  from the center of S covers S. 
        Let /  be the solution to the equation b + f(l — 2b/n) = d rounded to the nearest 
        integer.  Consider any ball В of radius b whose center is a distance /  from the center 
        of S.
          We claim that a fraction at least 1/ poly(n) of points in В belong to S.  Indeed, 
        let  X  and у denote the centers of S and В,  respectively.  Let P denote the set of 
        all indexes i from 1 to n where у coincides with x  (i.e., Xi = yi), and let Q stand 
        for the complement of P.  Choose a set of (b/n)\P\  indexes from P and another 
        set  of (b/n)\Q\  indexes from Q.  Then flip the bits of у with chosen indexes.  The 
        resulting string y'  is  at  distance  (b/n)\P\ + (b/n)\Q\  — b from у  and  at  distance 
        f  — (b/n)f + (n—f)(b/n) — d from x.  Thus y' belongs to the intersection of В and S. 
        The number of strings y' that can be obtained in this way equals (f^ n^) ((n-^b/n)) • 
        Up to a factor poly(n) this number equals
                  2fh(b/n,l — b/n) + (n—f)h(b/n,l—b/n)      ^nh(b/n,l—b/n)
        On the other hand, the cardinality |i?| of a ball of radius b is equal to this number 
        as well, up to a factor poly(n).
          Thus every ball В of radius b with center at distance /  from x covers at least 
        \B\/poly(n) of points from S.  Choose such a ball В at random.  All points z € S 
        have the same probability of being covered by B.  As each ball В covers \B\ / poly(n) 
        of points  from  S,  this  probability  is  at  least  |^|/(|*5'| poly(77.)).  Hence  there  is  a 
        polynomial p such that p(n)\S\/\B\ random balls of radius b with centers at distance 
        /  from x cover S with positive probability.
           358  Consider the family A that consists of all Hamming balls.  Prove that 
        there exists a string x for which the set P'£■ is much smaller than the set Px.  (The
