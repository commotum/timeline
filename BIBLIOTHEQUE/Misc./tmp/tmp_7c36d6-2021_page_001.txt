                              Latent Execution for Neural Program Synthesis
                                   XinyunChen                      DawnSong                  YuandongTian
                                   UCBerkeley                      UCBerkeley             Facebook AI Research
                           xinyun.chen@berkeley.edu       dawnsong@cs.berkeley.edu         yuandong@fb.com
                                                                Abstract
                                Program synthesis from input-output (IO) examples has been a long-standing
                                challenge. While recent works demonstrated limited success on domain-speciﬁc
                                languages (DSL), it remains highly challenging to apply them to real-world pro-
                                gramminglanguages, such as C. Due to complicated syntax and token variation,
                                there are three major challenges: (1) unlike many DSLs, programs in languages
                                like C need to compile ﬁrst and are not executed via interpreters; (2) the program
                                search space grows exponentially when the syntax and semantics of the program-
                                minglanguage become more complex; and (3) collecting a large-scale dataset of
                                real-world programs is non-trivial. As a ﬁrst step to address these challenges, we
                                propose LaSynth and show its efﬁcacy in a restricted-C domain (i.e., C code with
                                tens of tokens, with sequential, branching, loop and simple arithmetic operations
                                but no library call). More speciﬁcally, LaSynth learns the latent representation
                                to approximate the execution of partially generated programs, even if they are in-
                                complete in syntax (addressing (1)). The learned execution signiﬁcantly improves
                                the performance of next token prediction over existing approaches, facilitating
                                search (addressing (2)). Finally, once trained with randomly generated ground-
                                truth programs and their IO pairs, LaSynth can synthesize more concise programs
                                that resemble human-written code. Furthermore, retraining our model with these
                                synthesized programs yields better performance with fewer samples for both Karel
                                and C program synthesis, indicating the promise of leveraging the learned program
                                synthesizer to improve the dataset quality for input-output program synthesis (ad-
                                dressing (3)). When evaluating on whether the program execution outputs match
                                the IO pairs, LaSynth achieves 55.2% accuracy on generating simple C code with
                                tens of tokens including loops and branches, outperforming existing approaches
                                without executors by around 20%. 1
                        1   Introduction
                        Programsynthesis from input-output (IO) pairs, also called programming by example (PBE), requires
                        high-level reasoning and remains a challenging problem for deep models. Unlike Natural Language
                        Processing (NLP) [5, 16] and perceptual tasks such as Computer Vision (CV) [14, 22], the mapping
                        from IO pairs to the program itself is hard to model. Many works attempt to learn a direct mapping
                        from training samples, but often found that it is already difﬁcult to achieve a low training error, and
                        generalization to new problems is even harder. Alternatively, one might choose to formulate program
                        synthesis as a search problem: to ﬁnd the program that satisﬁes IO pairs. Unfortunately, the search
                        space of programs is often vast and highly non-smooth, i.e., a small perturbation of the program often
                        leads to a complete change of the output.
                        While there are many previous works on programming by example tasks [6, 17, 9], they mainly focus
                        on Domain Speciﬁc Languages (DSLs), and cannot be easily applied to popular general-purpose
                        programminglanguages. Forexample,tosynthesizeCprograms,weneedtodealwithbothhigh-level
                           1The code is available at https://github.com/Jungyhuk/latent-execution.
                        35th Conference on Neural Information Processing Systems (NeurIPS 2021).
