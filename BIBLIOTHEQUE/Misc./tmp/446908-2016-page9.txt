                     RankInpGNodes(G)                                                       eÔ¨Écient modiÔ¨Åcation of Dijkstra‚Äôs shortest path algorithm
                      foreach v ‚àà V(G):                                                     for DAGs (by considering nodes in topological order) to re-
                          v.out := 0, v.in := 0, v.score := 0                               turn the maximum score path. A constant string expression
                      foreach v ‚àà V(G) in topological order:                                ConstantStr(s) is assigned a low score proportional to the
                          foreach (v,vi) ‚àà E(G):                                                                                  2
                              v.out := Max(v.out, v .out + œÜ (v,v ))                        length of the constant string: |s| ‚àó , where we set  = 0.1
                                                           i           Œ∑     i              for our experiments. A substring expression corresponding
                      foreach v ‚àà V(G) in reverse topological order:                                                                                      2
                          foreach (v ,v) ‚àà E(G):                                            to an output substring s is assigned a higher score: |s| ‚àóŒ∫,
                                       i                                                    where we set Œ∫ = 1.5 for our experiments.
                              v.in := Max(v.in, vi.in + œÜŒ∑(vi,v))
                      foreach v ‚àà V(G):                                                       Theorem 1         (Soundness).        The LearnProgram algo-
                          v.score := v.in + v.out                                           rithm is sound, i.e. the program e learnt by the algorithm
                      return v with the highest v.score                                     from a set of input-output examples {(œÉ = (vi,¬∑¬∑¬∑ ,vi),oi)}
                                                                                                                                        i      1        k   s   i
                                                                                            always produces the corresponding output when evaluated on
                  œÜ (v ,v ) := Œ£           |v [id] ‚àí v [id]|                                the example inputs: ‚àÄi : JeK      =oi.
                   Œ∑   1  2        id‚ààI(v )  2         1                                                                   œÉ      s
                                         1                                                                                  i
                Figure 16:       The ranking algorithm for assigning                          Theorem 2         (Completeness). The LearnProgram al-
                                                                                            gorithm is complete, i.e. if there exists an L           string ex-
                scores to the nodes of an InputDataGraph G.                                                                                        s
                                                                                            pression that is consistent with the given set of input-output
                                                                                            examples, the algorithm is guaranteed to learn the expression
                |s| denotes the length of output string, k is the size of G,                given suÔ¨Écient input-output examples.
                                              4n
                which is bounded by O(|i|        ).                                         8.    EXPERIMENTS
                7.3     RankingofDagExpressions                                               WenowpresenttheexperimentalevaluationofBlinkFill
                   Wenowdescribe the ranking strategy used by BlinkFill                     on 207 real-world string transformation tasks and compare
                to select the desirable expression amongst the large num-                   it with FlashFill. We then present an evaluation to show
                ber of expressions represented by a Dag. The key idea is to                 that the intersection of InputDataGraphs does not lead to
                Ô¨Årst prefer token sequences that have larger contexts around                quadratic blowup in practice. Finally, we present the scala-
                them as they are more likely to correspond to the desired                   bility of learning InputDataGraphs with increasing number
                transformation logic. The algorithm then computes the best                  of input strings. The experiments were performed on a 6-
                concatenation of substring expressions in a Dag using Dijk-                 core Intel Xeon 3.5GHz processor with 32 GB RAM.
                stra‚Äôs algorithm. There are several other alternative rank-                   Implementation: We have implemented the inductive
                ing strategies. One ranking strategy is to use Occam‚Äôs razor                synthesis algorithm for the string transformation language
                principle to prefer shortest and simplest token sequences,                  of BlinkFill in C# as an add-in for Microsoft Excel as well
                                                                                            as a Web app1. The implementation also supports casing
                which has previously been shown to perform quite poorly                     transformations such as lowercase to propercase etc., but
                on this dataset [27]. Another strategy is to use machine                    we omit them from the technical section (¬ß6) for clarity of
                learning techniques to learn a ranking function over features               the novel ideas in the semi-supervised learning technique.
                of the expressions based on observed preferences. We com-                     Benchmarks: The 207 benchmarks were obtained from
                pare our ranking strategy with this machine learning based                  the Excel product team and online help forums.                These
                ranking in FlashFill in ¬ß8.2. It is important to note that                  benchmarks constitute a super-set of the benchmarks used
                ranking only aims to reduce the number of examples needed                   for learning the ranking function in FlashFill [27] and
                to learn the transformation and does not have any eÔ¨Äect                     comefromthesuite of 235 FlashFill benchmarks. We cat-
                on the completeness of the synthesis algorithm. Since our                   egorize the 235 benchmarks into 5 categories: 1) Substring:
                synthesis algorithm is complete, a user can always provide                  88 benchmarks that require only the substring expressions,
                additional examples to learn the intended transformation in                 2) Concat: 92 benchmarks that need concatenation of mul-
                case ranking fails to learn it from fewer examples.                         tiple substring and constant string expressions, 3) MulCol:
                   Ranking Substring Expressions We now describe the                        27 benchmarks that need concatenation of substrings from
                RankInpGNodes algorithm that assigns scores to nodes in                     multiple columns, 4) Conditionals: 18 benchmarks that
                an InputDataGraph G to Ô¨Ånd token matches with longest                       need conditionals, and 5) Loops: 10 benchmarks that need
                contexts. The algorithm maintains two scores for each node                  loops. Since BlinkFill currently does not support condi-
                v ‚àà V(G): v.in for incoming score and v.out for the outgoing                tional and loop learning, we only consider 207 benchmarks
                score. The v.in score corresponds to the number of nodes                    for the evaluation.     Each benchmark consists of 6 to 10
                from which there exists a path to v, whereas the v.out score                input-output examples. We automate the user interaction
                captures the numberofnodesthatarereachablefromv. The                        model by incrementally providing input-output examples to
                algorithm also uses the node distance function œÜŒ∑ to assign                 the two systems until the learnt program generates the ex-
                higher scores to nodes that are farther (in terms of string in-             pected output for all input strings.
                dices) to prefer longer token matches. Finally, the algorithm                 Baseline: We compare the performance of BlinkFill
                returns the node v with the highest score v.in+v.out. For                   with that of FlashFill. For a fair performance comparison,
                the nodes in expressions pÀú and pÀú from Figure 12, the rank-
                                              l       r                                     weremoveconditional and loop learning from FlashFill so
                ing algorithm assigns highest score to node v25 (correspond-                that the two domain-speciÔ¨Åc languages are comparable and
                ing to token match (‚Äù,‚Äù,1,End)) and v           (corresponding to
                                                             18                             only consists of concatenate expressions over constant string
                token match ($,1,Start) ) respectively.                                     expressions and substring expressions.
                   RankingDagPathsTherankingalgorithmÔ¨Årstassigns
                a score to each individual edge of the DAG, and then uses an                1http://cleandata.azurewebsites.net/
                                                                                      824
