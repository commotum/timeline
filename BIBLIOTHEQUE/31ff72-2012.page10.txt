                                                                                                  Input v1     Output
                                                                                                  6-3-2008     Jun 3rd, 2008
                                                                                                  3-26-2010    Mar 26th, 2010
                                                                                                  8-1-2009     Aug 1st, 2009
                                                                                                  9-24-2007    Sep 24th, 2007
                                                                                      Figure 10: Formatting dates using examples.
                                                                                     Weencode the background knowledge concerning months
                                                                                  in a table Month with two columns MN and MW, where each of
                                                                                  the columns constitutes a candidate key by itself. The table
                                                                                  is populated with 12 entries: (1,January), ..., (12,December).
                                                                                  WealsomaintainatableDateOrdwithtwocolumnsNumand
                                                                                  Ord, where the Ô¨Årst column constitutes a primary key. The
                                                                                  table contains 31 entries (1,st), (2,nd), (3,rd), ..., (31,st).
                             (a)                             (b)                  The desired transformation is represented in Lu as :
              Figure 9: User interface of our programming-by-                     Concatenate(SubStr(Select(MW,Month,MN = e1),
              example Excel add-in. (a) and (b) are the screen-                           pos(StartTok,,1),3),ConstStr(‚Äú ‚Äù),e2,
                                                                                          Select(Ord,DateOrd,Num = e ),ConstStr(‚Äú, ‚Äù),e )
              shots before and after clicking the Apply button.                                                         2                    3
                                                                                  wheree =SubStr2(v ,NumTok,1),e = SubStr2(v ,NumTok,
                                                                                          1              1              2              1
              example, for dates we have the knowledge that month 2               2), and e3 = SubStr2(v1,NumTok,3).
              corresponds to the string February, or for phone numbers               The expression concatenates the following strings: the
              we have the knowledge that 90 is the ISD code for Turkey.           string obtained by lookup of Ô¨Årst number token of v1 in table
              This background knowledge can be encoded as a set of rela-          Month, the constant string whitespace, the second number
                                                                                  token of v , the string obtained by lookup of second number
              tional tables in our framework (once and for all). This allows                1
              the synthesis algorithm for L to learn transformations over         token of v1 in table DateOrd, the constant string ‚Äú, ‚Äù, and
                                            u                                     the string corresponding to third number token of v1.
              strings representing these data types. We now present some             Unfortunately, it is not possible to encode semantics of
              examples from Excel help-forums where users were strug-             data-typeswithinÔ¨Ånitedomainsusingrelationaltables. One
              gling with performing manipulations over such strings.              such data-type is numbers, which often entail rounding and
                 Example 7      (Time Manipulation). An Excel user                formatting transformations [17].
              needed to have spot times (shown in column 1 in Figure 9(a))        7.    EXPERIMENTS
              converted to the hh:mm AM/PM format (as shown in col-
              umn 2 in Figure 9(a)). The Excel user posted this problem              We have implemented the inductive synthesis algorithm
              on a help-forum to which an expert responded by providing           for the transformation language L in C# as an add-in for
              the following macro:     TEXT(C1,"0000")+0                                                              u
                                                                                  Microsoft Excel Spreadsheet system as shown in Figure 9.
              When we showed this example to a team of Excel experts in           Wehard-code a few useful relational tables of our own (such
              a live presentation, it drew a response: ‚ÄúThere are 40 diÔ¨Äer-       as the one that maps month numbers to month names),
              ent ways of doing this!‚Äù. When we asked them to describe            while also allowing the user to point to existing Excel tables
              any one of those ways, we got the response ‚ÄúI don‚Äôt exactly         to be used for performing the transformation.
              remember how to do it. I will have to investigate‚Äù.                    Benchmarks: We report experimental results on a set
              We encode the background knowledge concerning time in               of 50 problems collected from several Excel help-forums and
              a table Time with three columns 24Hour,12Hour and AMPM,             the Excel product team (including all problems described in
              wheretheÔ¨Årstcolumnconstitutesaprimarykey,andsodoes                  this paper). Out of these 50 problems, 12 problems can be
                                                                                  modeled in the lookup language L whereas the remaining
              the combination of the second and third columns. The table                                               t
              is populated with 24 entries: (0,0,AM), ..., (11,11,AM),            38 of them require the extended language Lu. The detailed
              (12,12,PM), (13,1,PM), ..., (23,11,PM). The desired                 description of these 50 problems can be found in [16].
                                                                                     EÔ¨Äectiveness of data structure D : We Ô¨Årst present
              transformation can be represented in our language as:                                                         u
                                                                                  the statistics about the number of expressions in L       that
              Concatenate(Select(12Hour,Time,b1),ConstStr(‚Äú : ‚Äù),                                                                        u
                 SubStr(v ,‚àí3,‚àí1),ConstStr(‚Äú ‚Äù),Select(AMPM,Time,b )              are consistent with the user-provided set of input-output
                          1                                               1       examples for each benchmark problem in Figure 11(a). The
                whereb1 ‚â° (24Hour = SubStr(v1,pos(StartTok,,1),‚àí3)).             Ô¨Ågure shows that the number of such consistent expressions
                 The SubStr expression in b1 computes the substring of                                                                     10
              the input between the start and 3rd character from end, to          are very large and are typically in the range from 10       to
                                                                                     30
              compute the hour part of the time in column v . This hour           10 . Figure 11(b) shows that the size of our data structure
                                                               1                  D to represent this large number of expressions typically
              string is then used to perform lookup in table Time to com-           u
              puteits corresponding 12Hour format and AMPM value. These           varies from 100 to 2000, where each terminal symbol in the
              lookup strings are then concatenated with the minute part           grammar rules of the data structure contributes a unit size
              of the input string and constant strings : and whitespace.          to the size of the data structure.
                                                                                     EÔ¨Äectiveness of ranking: Use of a ranking scheme en-
                 Example 8      (Date Manipulation). An Excel user                ables users to provide fewer input-output examples to auto-
              wanted to convert dates from one format to another as shown         mate their repetitive task. Hence, the eÔ¨Äectiveness of our
              in Figure 10, and the Ô¨Åxed set of hard-coded date formats           ranking scheme can be measured by the number of examples
              supported by Excel 2010 do not match the input and output           required for the intended program to be ranked as the top-
              formats. Thus, the user solicited help on a forum.                  most program. In our evaluation, all benchmark problems
                                                                              749
