                              {0}    ^     {1}           {2}           {3}           {4}          {5}     $     {6}                       {0}    ^      {1}          {2}           {3}           {4}           {5}    $     {6}
                                                                                                                                                                               α    α
                                          α    α
                                                                     α   α    αn   αn              αs   αs    “lb”   lb”                                                        α   α    αn   αn              αs   αs   “g”    g”
                                                                           (a)                                                                                                           (b)
                                                      Figure 6: The InputDataGraph for the input strings (a) "1 lb" and (b) "23 g".
                           GenInpDataGraph({(v1,··· ,v1),··· ,(vn,··· ,vn)})                                                               GenerateInputGraph(s: Input string)
                                                               1            k               1             k
                            for i = 1 to k:                                   1            n                                           1 V=∅, E=∅
                                  G :=GenGraphColumn({v ,··· ,v })                                                                     2 id = string2Id[s]
                                     i    S                                   i            i
                            return           1≤i≤kGi                                                                                   3 foreach i ∈ range(0, len(s)+3):
                                                                                                                                       4          V = V∪vi
                           GenGraphColumn({(s ,··· ,s )})                                                                              5          I(vi) = { (id,i) }
                                                             1            n                                                                                         ∧
                            G:=GenGraphStr(s )                                                                                         6 L((v0,v1) = {( ,1)}
                                                              1
                            for i = 2 to n:                                                                                            7 L((vlen(s)+1,vlen(s)+2) = {($,1)}
                                  G:=Intersect(G,GenGraphStr(s ))                                                                      8 foreach i ∈ range(1,len(s)+1):
                                                                                            i
                            return G                                                                                                   9          foreach j ∈ range(i+1,len(s)+2):
                                                                                                                                     10                 leftIdx = i, rightIdx = j-1
                       Figure 7: The GenInpDataGraph algorithm for con-                                                              11                 E = E∪(vi,vj)
                                                                                                                                     12                 c    = s[leftIdx..rightIdx]
                       structing the input graph for a set of n input rows                                                                               s
                                                                                                                                     13                 L((v ,v )) = {(c ,GetMId(c ,s,i))}
                       each consisting of k strings.                                                                                                           i    j               s                  s
                                                                                                                                     14                 foreach τ ∈ T ∧Match(τ,c ):
                                                                                                                                                                                                      s
                                                                                                                                     15                       L((vi,vj)) = L((vi,vj)) ∪ (τ,GetMId(τ,s,i))
                       to construct the graphs for individual strings and then uses                                                  16 return (V,E,I,L)
                       the intersection algorithm (§5.2) to intersect these graphs to
                       compute the graph consisting of all logical patterns that are                                                 Figure 8: The generateInputGraph algorithm for con-
                       shared across the set of column strings.                                                                      structing the input graph for an input string s.
                           The GenGraphStr algorithm for constructing the input
                       graph for an input string s is shown in Figure 8. The algo-
                       rithm ﬁrst creates len(s) + 1 number of nodes for denoting                                                    takes the union of the labels of the corresponding nodes I(v )
                       diﬀerent indices of the input string, and two special nodes                                                                                                                                                    i
                                                                                                                                     andI(v ). For each edge (v ,v ) ∈ E and edge (v ,v ) ∈ E ,
                       v and v                      for denoting the start and end tokens re-                                                     j                               i    k          1                     j    l        2
                         0            len(s)+2                                                                                       the algorithm adds an edge ((vi,vj),(vk,vl)) to the new set
                       spectively. The labeling function I labels each node vi with                                                  of edges E. The edge labeling function L(((v ,v ),(v ,v )))
                       (id,i), where id denotes the unique string identiﬁer for s. For                                                                                                                           i    j       k    l
                       each node pair (v ,v ), the algorithm adds an edge with the                                                   labels each edge with the token set that is common to both
                                                    i    j                                                                           sets L((vi,vk)) and L((vj,vl)). The worst-case complexity
                       labeling function L such that L(vi,vj) consists of all token                                                                                          4
                       matches that match the substring s[i..(j − 1)]. The com-                                                      of the algorithm is O(n ), where n is the length of the in-
                                                                           2                                                         put strings. However, in practice, we do not see a quadratic
                       plexity of the algorithm is O(n ) (by using hash lookup for                                                   blowup in the graph size after the intersection algorithm as
                       GetMId), where n is the length of the input string s.                                                         shown in §8.3. The key reason behind this is the fact that
                       5.2        Intersection of InputDataGraphs                                                                    even though the two initial InputDataGraphs are complete
                                                                                                                                                     2
                           The intersection of two InputDataGraphs results in an                                                     with O(n ) edges, a lot of these edges do not remain after
                       InputDataGraph that consists of all patterns that are com-                                                    the intersection operation because of the strong constraint
                       montobothgraphs. Formally,theintersectionoftwographs                                                          that token match (τ,k) should be the same for both the
                       G = (V ,E ,I ,L ) and G = (V ,E ,I ,L ) is deﬁned as                                                          intersecting edges. For example, the token match ("a",1)
                          1          1     1    1     1              2           2    2     2    2                                   (matching the ﬁrst occurrence of constant string "a") can
                       G=Intersect(G ,G )=(V,E,I,L), where
                                                     1      2                                                                        not match with the token match (”a”,2) (the second occur-
                                                                 V = {(v ,v )|v ∈ V ,v ∈ V }                                         rence of "a"). As a result, the InputDataGraph obtained af-
                                                                             i    j     i       1     j       2
                                 E = {((v ,v ),(v ,v ))|(v ,v ) ∈ E ,(v ,v ) ∈ E }                                                   ter intersection becomes very sparse in the number of edges.
                                               i   j        k    l        i    k         1      j    l        2                          TheInputDataGraph for the intersection of graphs for the
                                      I((v ,v )) = I (v ) ∪ I (v ),∀v ∈ V ,v ∈ V
                                             i    j           1    i        2    j        i       1     j       2                    strings "1 lb" and "23 g" is shown in Figure 9. The inter-
                                 L(((vi,vj),(v ,v ))) = {(τ,k)|(τ,k) ∈ L1((vi,v ))                                                   sected graph consists of 6 nodes and 5 edges. Note that the
                                                      k    l                                                 k
                                  ∧(τ,k) ∈ L ((v ,v ))}∀(v ,v ) ∈ E ,(v ,v ) ∈ E                                                     nodelabels in the ﬁgure only show the string indices and not
                                                    2      j    l           i    k         1      j    l        2                    the string ids for brevity. The InputDataGraph obtained af-
                           The Intersect algorithm creates the Cartesian product                                                     ter intersecting the graphs for the set of input strings {"1
                       of the nodes in the two graph V and V to create the nodes V                                                   lb", "23 g", "4 tons", "102 grams", "75 kg"}alsoconsists
                                                                          1           2
                       for the new graph G. The node labeling function I((vi,vj))                                                    of same number of nodes and edges. The InputDataGraph
                                                                                                                             820
