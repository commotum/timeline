                                                                                                                                                                                                                                                                                                                                                                        Theoretical                                                       and                      Applied                                         Mechanics                                                       Letters                                   14                 (2024)                                    100527                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                Contents                                                 lists                        available                                                     at  ScienceDirect                                                                                         
                                                                                                                                                                                                                                                                                                                  Theoretical                                                                                                                   and                                              Applied                                                                                       Mechanics                                                                                                                   Letters                                                                           
                                                                                                                                                                                                                                                                                                                                                                                       journal homepage: www.elsevier.com/locate/taml 
                                                                     An                             implicit                                                                                  factorized                                                                                                       transformer                                                                                                                          with                                                   applications                                                                                                                             to  fast                                                                  prediction                                                                                                          of  
                                                                     three-dimensional                                                                                                                                                                                 turbulence                                                                                                                
                                                                                                                                                                          a  , b                                                                                              a                                                                                                   b                                                                                                                                                     a  ,  ∗ 
                                                                     Huiyu                                               Yang                                                              ,       Zhijie                                              Li  ,Xai                                                            Wang                                                  , Jianchun                                                                                      Wang                                                  
                                                                     a  
                                                                           Department                                              of  Mechanics                                                      and                  Aerospace                                           Engineering,                                                  Southern                                      University                                          of  Science                                        and                   Technology,                                                 Shenzhen                                         518055,                                      China                           
                                                                     b  
                                                                           College                            of  Mathematics                                                               and                  Informatics,                                                 South                         China                           Agricultural                                                 University,                                           Guangzhou                                                 510642,                                      China                          
                                                                     a  r  t  i c  l  e                                                                                                       i  n  f  o                                                                                                                                                                    a  b  s  t  r  a  c  t  
                                                                     Keywords:                                                                                                                                                                                                                                                                                              Transformer                                                             has                   achieved                                              remarkable                                                          results                                 in  various                                                 ﬁelds,                               including                                                its              application                                                        in  modeling                                                           dynamic                                             sys-                     
                                                                     Transformer                                                                                                                                                                                                                                                                                            tems                        governed                                                by               partial                                  diﬀerential                                                       equations.                                                    However,                                                  transformer                                                           still                   face                      challenges                                                     in            achieving                                                 long-term                                                  
                                                                     Operator                                      learning                                                                                                                                                                                                                                                 stable                             predictions                                                        for                 three-dimensional                                                                                          turbulence.                                                         In  this                                paper,                                  we                  propose                                         an                implicit                                        factorized                                                  transformer                                                            
                                                                     Turbulence                                                simulation                                                                                                                                                                                                                                   (IFactFormer)                                                                    model,                                    which                                enables                                       stable                              training                                         at            greater                                    depths                                   through                                         implicit                                       iteration                                           over                        factorized                                                  at-               
                                                                     Incompressible                                                               turbulence                                                                                                                                                                                                                tention.                                      IFactFormer                                                              is  applied                                               to  large                                       eddy                           simulation                                                      of  three-dimensional                                                                                                     homogeneous                                                                       isotropic                                            turbulence                                                       
                                                                                                                                                                                                                                                                                                                                                                            (HIT),                              and                      is  shown                                           to            be               more                            accurate                                            than                        the                   FactFormer,                                                             Fourier                                      neural                                 operator,                                              and                      dynamic                                             Smagorinsky                                                                 
                                                                                                                                                                                                                                                                                                                                                                            model                                (DSM)                                    in  the                               prediction                                                     of  the                              velocity                                          spectra,                                         probability                                                        density                                      functions                                                of  velocity                                                     increments                                                         and                       
                                                                                                                                                                                                                                                                                                                                                                            vorticity,                                           temporal                                               evolutions                                                     of  velocity                                                    and                      vorticity                                           root-mean-square                                                                                         value                             and                      isosurface                                                   of  the                              normalized                                                          
                                                                                                                                                                                                                                                                                                                                                                            vorticity.                                           IFactFormer                                                                can                     achieve                                          long-term                                                   stable                                predictions                                                          of  a  series                                                   of  turbulence                                                                    statistics                                            in  HIT.                                      Fur-                        
                                                                                                                                                                                                                                                                                                                                                                            thermore,                                                IFactFormer                                                               showcases                                                     superior                                           computational                                                                         eﬃciency                                                   compared                                                    to  the                              conventional                                                                  DSM                            in  large                                      
                                                                                                                                                                                                                                                                                                                                                                            eddy                         simulation.                                                         
                                                                                          1.           Introduction.                                                                    Recent                                         advancements                                                                                 in  turbulence                                                                          simulations                                                                 have                                                            incorporating                                                                           self-attention,                                                                             cross-attention,                                                                                       and                         a  series                                            of  point-wise                                                                           
                                                                     been                           signiﬁcantly                                                                        inﬂuenced                                                                by  the                                          integration                                                                  of  machine                                                                     learning                                                                                 multilayer                                                         perceptrons                                                                    (MLPs).                                              Hao                           et  al.                             [28]                             designed                                                    a  general                                                     neu-                            
                                                                     (ML)                            techniques                                                             [1–3]                                 .   These                                   advancements                                                                                 predominantly                                                                                   fall                    into                        two                                                      ral                operator                                                  transformer                                                                    capable                                              of  ﬂexibly                                                          encoding                                                      diﬀerent                                                   types                                of  
                                                                     categories:                                                          one                       that                        supplements                                                                       traditional                                                           turbulence                                                             models                                          by                 learn-                                                                input                              functions                                                       and                           input                                  features.                                                    While                                      transformer-based                                                                                                        operator                                                    
                                                                     ing                  closures                                              and                         subgrid                                            discretization                                                                            [4–8]                                  ,   and                        another                                              that                         employs                                                                                approaches                                                               have                              demonstrated                                                                               competitive                                                                   outcomes                                                        in  various                                                        bench-                                        
                                                                     pure                         deep                                 learning                                                   to  approximate                                                                                          the                        systems                                                governed                                                         by  Navier-                                                                                               marks,                                      their                              substantial                                                              memory                                                   demands                                                      often                                render                                         them                                 impracti-                                                     
                                                                     Stokes                                   equations                                                        [9–18]                                         .   While                                   ML-enhanced                                                                              turbulence                                                             models                                          exhibit                                                                       cal                 for                    application                                                                  in  high-dimensional                                                                                                                  PDEs.                                     To  overcome                                                                             the                       issues                                    
                                                                     higher                                    accuracy                                                     compared                                                            to  traditional                                                                            turbulence                                                                models,                                               they                              still                                                      mentioned,                                                               Li  et  al.  [29]                                                                               introduced                                                                 a  factorized                                                                       transformer                                                                       (Fact-                                     
                                                                     cannot                                      avoid                                    substantial                                                                computational                                                                                     costs.                                   In  contrast,                                                                   the                        purely                                                                       Former)                                              built                              on  an  axial                                                                   factorized                                                           kernel                                        integral,                                                  providing                                                           an  ef-  
                                                                     data-driven                                                               approaches,                                                                    known                                          as  operator                                                              learning,                                                   often                               require                                           min-                                                           ﬁcient                                   low-rank                                                     alternative                                                             surrogate                                                       modeling.                                                          The                         FactFormer                                                                   signif-                                    
                                                                     imal                         reliance                                              on                  domain-speciﬁc                                                                                         knowledge,                                                                   enabling                                                  not                      only                           the                     ﬂex-                                                          icantly                                      reduces                                              peak                               memory                                                    usage                                    and                         marks                                       the                      ﬁrst                           application                                                                 of  
                                                                     ible                    design                                       of  structures                                                                      to  simulate                                                                various                                           physics                                            processes                                                       modeled                                                                                  transformer-based                                                                                                    operator                                                 in             simulating                                                            three-dimensional                                                                                                     PDEs.                                  How-                                 
                                                                     by              partial                                         diﬀerential                                                                equations                                                          (PDEs)                                           but                        also                          the                       ability                                       to  predict                                                                                        ever,                            the                      FactFormer                                                                   still                       faces                                challenges                                                             in  achieving                                                                      satisfactory                                                                 re-                   
                                                                     eﬃciently                                                       and                         rapidly                                          compared                                                           to  traditional                                                                          numerical                                                          methods.                                                                                                               sults                         in  terms                                                of  accuracy                                                                 and                         stability                                               when                                   making                                             long-term                                                          predic-                                         
                                                                                          Among                                         various                                              network                                                    structures,                                                              the                       transformer                                                                      [19]                              ,   entirely                                                                              tions                           of  3D                                   turbulence.                                                                  This                             is  because                                                           turbulence                                                               is  a  chaotic                                                                 system                                          
                                                                     based                                on  the                                         attention                                                      mechanism,                                                                        has                        been                                extensively                                                                  applied                                              and                                                         characterized                                                                          by  vortices                                                                 of  various                                                            scales,                                        making                                               long-term                                                           precise                                           
                                                                     exhibits                                          remarkable                                                                     performance                                                                            in  ﬁelds                                                  like                          computer                                                           vision                                       [20–                                                              prediction                                                        a  particularly                                                                           challenging                                                                   task.                            
                                                                     22]                    and                         natural                                           language                                                      processing                                                              [23–25]                                                 .   Consequently,                                                                                 there                                 has                                                                           In            this                        paper,                                      we                     propose                                                an  implicit                                                              factorized                                                          transformer                                                                    (IFact-                                       
                                                                     been                           an  increasing                                                                           trend                                  recently                                                in  attempts                                                                to  apply                                                 the                     transformer                                                                                                   Former)                                              model                                        for                     fast                        prediction                                                             of  three-dimensional                                                                                                                      homogeneous                                                                                  
                                                                     to           simulate                                                    physical                                                  processes                                                         governed                                                        by  PDEs                                                    [26–34]                                                   .   Cao                           et  al.                                                               isotropic                                                 turbulence                                                                   (HIT).                                          IFactFormer                                                                            enables                                                  stable                                        training                                                    at  
                                                                     [26]                         conceptualized                                                                                    a  linearized                                                               transformer                                                                   without                                             softmax                                              as              a  learn-                                                                        greater                                       depths                                        through                                                implicit                                             iteration                                                 over                            factorized                                                         attention.                                                       This                           
                                                                     able                       Petrov-Galerkin                                                                                         projection                                                          and                         proposed                                                     the                     Galerkin                                                  transformer,                                                                                                     network                                               structure                                                       signiﬁcantly                                                                          enhances                                                          the                          accuracy                                                        and                            stability                                                  
                                                                     the                  ﬁrst                         transformer-based                                                                                                       learnable                                                      operator.                                                     Li  et  al.                                         [27]                             introduced                                                                                             of            transformer-based                                                                                                        operator                                                    for                     long-term                                                           predictions                                                                  of  HIT,                                            com-                                 
                                                                     the                  operator                                                   transformer                                                                     framework,                                                                     an  encoder-decoder                                                                                                                 architecture                                                                                                    pared                                to  traditional                                                                           dynamic                                                     Smagorinsky                                                                           model                                       (DSM)                                         in  large                                              eddy                               
                                                                               ∗ Corresponding                                                                                 author.                                      
                                                                                          E-mail                              address:                                        wangjc@sustech.edu.cn                                                                                                                      (J.                Wang)                                    .   
                                                                     https://doi.org/10.1016/j.taml.2024.100527                                                                                                                                                                                                                         
                                                                     Received                                            13                March                                    2024;                               Received                                               in  revised                                                 form                           5  May                                  2024;                               Accepted                                                6  May                                  2024                             
                                                                     Available                                             online                                  13                May                          2024                             
                                                                     2095-0349/© 2024                                                                                                 The                      Author(s).                                                    Published                                                   by                Elsevier                                         Ltd                   on                behalf                                 of  The                                  Chinese                                         Society                                      of  Theoretical                                                                     and                     Applied                                          Mechanics.                                                         This                        is  an                         open                           access                                 article                                 
                                                                     under                             the                   CC                  BY                  license                                   (  http://creativecommons.org/licenses/by/4.0/                                                                                                                                                                                                                                  )    
