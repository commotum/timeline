                                                                                                                       TheSurprising Effectiveness of Test-Time Training for Few-Shot Learning
                                                                                                                                                                                      Examples Generators + Annotations from the training set
                                                                                                                                                                                                     Category

                                                                                                                                                                                                     Extension, Lines

                                                                                                                                                                                                     Summary

                                                                                                                                                                                                     Connecting blocks with colored lines

                                                                                                                                                                                                     Description

                                                                                                                                                                                                     In the input we see randomly placed blocks and we need to 
                                                                                                                                                                                                     connect them to their horizontal or vertical neighbors with lines 
                                                                       )
                                                                                                                                                                                                     of the same color.
                                                                  3

                                                                                                                                                                                                                                                                                                                                            Generated Generators
                                                                       s
                                                                   
                                                                       n
                                                                                Examples Annotations from the training set
                                                                  n
                                                                       o
                                                                                                                                                                                                    def generate(diff_lb: float, diff_ub: float) -> dict:

                                                                       i
                                                                       t
                                                                                                                                                                                                        # set the size limits

                                                                  o
                                                                                                                                                                                                                                                                                                                             def generate(diff_lb: float, diff_ub: float) -> dict:

                                                                       a
                                                                  i
                                                                                                                                                                                                        dim_bounds = (3, 30)

                                                                                                                                                                                                                                                                                                                                 # set the size limits

                                                                       r
                                                                                    Category

                                                                  t
                                                                                                                                                                                                        # get the possible colors for the blocks

                                                                       e
                                                                                                                                                                                                                                                                                                                                 dim_bounds = (4, 30)

                                                                                    Extension, Lines

                                                                  a
                                                                       n
                                                                                                                                                                                                        colopts = remove(8, interval(0, 10, 1))

                                                                                    Summary
                                                                                                                                                                                                                                     # get the possible colors for the blocks

                                                                  t
                                                                       e
                                                                                                                                                                                                        # get random size for the canvas

                                                                                    Connecting blocks with colored lines

                                                                                                                                                                                                                                                                                                                                 colopts = remove(2, interval(0, 10, 1))

                                                                       g
                                                                                                                                                                                                        h = unifint(diff_lb, diff_ub, dim_bounds)

                                                                                    Description

                                                                                                                                                                                                                                                                                                                                 # get random size for the canvas

                                                                        
                                                                  n
                                                                                                                                                                                                                                                                                          LLM
                                                                                                                                                                                                        w = unifint(diff_lb, diff_ub, dim_bounds)

                                                                                    In the input we see randomly placed blocks and we need to 
                                                                       e
                                                                                                                                                                                                                                                                                                                                 h = unifint(diff_lb, diff_ub, dim_bounds)

                                                                  e
                                                                       g
                                                                                    connect them to their horizontal or vertical neighbors with lines                                                   # get random background color

                                                                                                                                                                                                                                                                                                                                 w = unifint(diff_lb, diff_ub, dim_bounds)

                                                                       a
                                                                                    of the same color.
                                                                                                                                                                                                        ...

                                                                                                                                                                                                                                                                                                                                 # pick a random color for the background

                                                                       t
                                                                  m
                                                                                                                                                                                                        return {'input': gi, 'output': go}

                                                                       s
                                                                                                                                                                                                                                                                                                                                 ...

                                                                        
                                                                                                                                                                                                                                                                                                                                 return {'input': gi, 'output': go}

                                                                  g
                                                                       o
                                                                                                                                                                    L
                                                                       w
                                                                  u
                                                                       t
                                                                                                                                                                         L
                                                                       (
                                                                  A
                                                                                                                                                                             M
                                                                                                                                                                                                                   Generated Annotations
                                                                                                                                                                                                     Category

                                                                                                                                                                                                     Recoloring, Lines

                                                                                                                                                                                                     Summary

                                                                                                                                                                                                     lines are re-colored to red while blocks kept the same

                                                                                                                                                                                                     Description

                                                                                                                                                                                                     In the input, there are blocks and full lines from edges to edges. 
                                                                                                                                                                                                     The lines are re-colored to red while the blocks are kept the same.
                                          Figure 12. Two-stage generation using an LLM: First, we prompt the LLM to generate a task description using few-shot prompting.
                                          Then, we generate the new generator based on existing task pairs and the newly created description.
                                          Toget the task descriptions, we manually created seed descriptions for 10 training tasks. These seed descriptions were then
                                           used to generate descriptions for the training and validation tasks through few-shot prompting. To increase diversity of
                                           tasks, we use task descriptions with hierarchical fields (category, summary, and description). The process of getting these
                                           descriptions is provided in Appendix D.1.
                                           Instead of jointly generating task descriptions and function generations, we additionally deployed a two-stage approach
                                          (Figure 12 ) described as following:
                                                                                                                                                                           ′
                                                                                                                                                                        s ∼LM(s ,s ,...s )                                                                                                                                                                                                                         (4)
                                                                                                                                                                                                         1         2                    m
                                                                                                                                                                           ′                                                                                                             ′
                                                                                                                                                                       g ∼LM(s ,g ,s ,g ,...,s ,g ,s )                                                                                                                                                                                                             (5)
                                                                                                                                                                                                         1          1         2         2                       m m
                                          This approach first generates a task description s′ and then conditions the generator creation on both existing task pairs
                                           and the new description. In total we collected 6426 generators with these LLM based approaches. We provide qualitative
                                           samples from these LM generated tasks in Figure 16.
                                           (c) Geometric Transformations                                                                                Finally, our synthetic tasks are enhanced through various geometric transformations,
                                           such as basic transformations (rotations, reflections, random shift and size scaling), pattern operations (random patching,
                                           tiling, and repetition), color permutations, and composite transformations involving sequential application of multiple basic
                                           transformations. These transformations are applied in three ways:
                                                   • Input grids only: (x,y) → (t(x),y)
                                                   • Output grids only: (x,y) → (x,t(y))
                                                   • Both input and output: (x,y) → (t(x),t(y))
                                          We use all the transformations given in Appendix C.1, and some additional transformations given in Table 3. In the
                                           fine-tuning case, different from TTT, we apply augmentations to only inputs, only outputs or both. These transformations
                                           are applied randomly to variants of tasks with 30% of the time.
                                          Table 3. We provide the additional augmentations use in our data generation for fine-tuning with their function signature and description.
                                                                                                   AugmentationName                                                                    Description
                                                                                                   Repeat(direction, n)                                                                Rotates a grid in horizontal or vertical direction by n
                                                                                                                                                                                       times.
                                                                                                   DropoutOutput                                                                       Randomlydeletes some patches of the output grids.
                                                                                                   DropoutInput                                                                        Randomlydeletes some patches of the input grids
                                                                                                                                                                                                                               14
