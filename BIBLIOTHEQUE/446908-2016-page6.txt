                                                                                                                                                      token match. For example, for the input string "Mumbai,
                                                                                                                                                      India", the position expression (", ",1,End) returns the in-
                                                                                                                        $                             dex 9 and matches the substring ", ", whereas the position
                             {0,0}      ^         {1,1}               {2,3}               {3,4}               {5,5}               {6,6}               expression (l,‚àí1,End) returns the index 14 and matches the
                                                                                                                                                      substring "ndia". For abbreviating the initials of Ô¨Årst and
                                                                 Œ±       Œ±                                                                            last names in Example 2, a possible L expression is: e ‚â°
                                                                                                                                                                                                                               s                               2
                                                              Œ±     Œ±      Œ±n     Œ±n                      Œ±s     Œ±s                                   Concat(f1,ConstantStr(‚Äù.‚Äù),f2,ConstantStr(‚Äù.‚Äù)), where
                                                                                                                                                      f1 ‚â° SubStr(v1,(C,1,Start),(C,1,End)) and f2 ‚â°
                          Figure 9: The intersection of InputDataGraphs for                                                                           SubStr(v1,(C,‚àí1,Start),(l,‚àí1,Start)).
                          strings "1 lb" and "23 g".                                                                                                  6.2         DAGDataStructure
                          for the six input strings in Example 1 is shown in Figure 14,
                          which consists of 40 nodes and 32 edges.
                          6.        STRINGTRANSFORMATIONS                                                                                                              {0}             {1}             {2}             {3}             {4}             {5}
                              In this section, we describe the String Transformation
                          Language Ls of BlinkFill and the Dag data structure used
                          to succinctly represent a large number of L                                                expressions
                                                                                                                 s
                          that are consistent with a given set of input-output exam-
                                                                                                                                                                                                      ‡∑• ‡∑•
                          ples.       The DSL and the data structure are similar to the                                                                                                               Ì†µÌ≤ë Ì†µÌ≤ë
                                                                                                                                                                                ‡∑•
                          corresponding DSL and data structure of FlashFill at the                                                                                              Ì†µÌ≤ë
                                                                                                                                                                               ‡∑•
                          top-level, but the key diÔ¨Äerence is in the representation of                                                                                        Ì†µÌ≤ë
                          position expressions in the substring expressions, which are
                          deÔ¨Åned using the token match expressions from the edges of                                                                  Figure 12: The Dag data structure for representing
                          the InputDataGraph data structure.                                                                                          a set of string expressions to generate the string
                          6.1         String Transformation Language L                                                                                "India" from an input string "Mumbai, India".
                                                                                                                          s
                              TheDSLforBlinkFillisshowninFigure10(a)withthe
                          key diÔ¨Äerences from FlashFill highlighted. The top-level                                                                        The Dag data structure is used to succinctly represent a
                          string expression e is a concatenation of a Ô¨Ånite list of sub-                                                              large number of Ls expressions that are consistent with a
                          string expressions [f1,¬∑¬∑¬∑ ,fn]. A substring expression f can                                                               given set of input-output examples. The syntax of the Dag
                          either be a constant string s (denoted by ConstantStr(s))                                                                   data structure is shown in Figure 11(a). The set of top-level
                          or a substring extraction expression that is deÔ¨Åned using                                                                   concatenate expressions are represented using paths in the
                          two position logics p and p , which correspond to the left                                                                  Dag in a way similar to their Dag based representation in
                                                                 l             r                                                                      FlashFill. The key diÔ¨Äerence is in the way the substring
                          and right indices in the input string vi respectively. The
                          position logic expression p is either a constant integer value                                                              expressions are represented as a pair of two independent sets
                          k or a token match expression. The token match expression                                                                   of InputDataGraph nodes on the Dag edges.
                                                                                                                                                          Aset of L expressions is represented using a Dag consist-
                          (œÑ,k,Dir) returns the start index (Dir = Start) or the end                                                                                         s
                                                                                                                                                      ing of a set of nodes Œ∑Àú, a start node Œ∑s, a Ô¨Ånal node Œ∑f, a set
                          index (Dir = Start) of the token match (œÑ,k).                                                                                               Àú
                              The semantics of Ls is shown in Figure 10(b). The envi-                                                                 of edges Œæ, and a mapping function W that maps each edge
                                                                                                                                                             Àú
                          ronment state œÉ maps the input variables vi to their corre-                                                                 Œæ ‚àà Œæ to a set of substring expressions. The set of substring
                          sponding string values. The semantics of a concatenate ex-                                                                  expressions f consists of either a constant string expression
                                                                                                                                                                                                                                                             0
                                                                                                                                                      or a set of substring expressions SubStr(v ,{pÀú } ,{pÀú } ),
                          pression is to recursively evaluate each individual substring                                                                                                                                                  i       j j         k k
                                                                                                                                                                                                                                                        0
                                                                                                                                                      where the set of position expressions {pÀú } and {pÀú }                                                     are
                          expression fi and then concatenate them. The semantics                                                                                                                                                   j j                  k k
                          of a constant string expression ConstantStr(s) is to simply                                                                 represented as independent sets. A set of position expres-
                          return the constant string s. The semantics of a substring                                                                  sions pÀú consists of either a constant position or a set of
                                                                                                                                                                                                   e
                          expression SubStr(vi,pl,pr) is to Ô¨Årst evaluate index posi-                                                                 InputDataGraph nodes V.
                          tions l = p and r = p , and then return the corresponding                                                                       The semantics of the Dag data structure is shown in Fig-
                                              l                     r                                                                                                                                                          s                                    f
                          substring s[l..r], where s = œÉ(vi). The semantics of the con-                                                               ure 11(b). A path from the start node Œ∑ to the Ô¨Ånal node Œ∑
                          stant position expression ConstantPos(k) is to return k if                                                                  in the Dag represents a Concat(f1,¬∑¬∑¬∑ ,fn) expression, where
                          k > 0 and len(s)+k otherwise. The semantics of a token                                                                      the substring expressions fi are obtained from the edges Œæi
                          match expression (œÑ,k,Start) (resp. (œÑ,k,End)) is to return                                                                 on the path. The semantics of a set of substring expres-
                                                                                                            th                                                                                       0
                                                                                                                                                      sions SubStr(v ,{pÀú } ,{pÀú } ) is to Ô¨Årst independently eval-
                          the start index (resp. end index) of the k                                             occurrence of                                                   i       j j         k k
                          the match of token œÑ in the string s.                                                                                       uate the set of left and right position expressions, and then
                              A possible L expression to perform the desired trans-                                                                   compute the set of substring expressions corresponding to
                                                       s
                          formation of extracting country names in Example 1 is:                                                                      the cross-product of the set of position expressions. The set
                          e1 ‚â° Concat(SubStr(v1,(", ",1,End),(l,‚àí1,End)). The ex-                                                                     of constant string and constant position expressions have ex-
                          pression e extracts the substring from the input string v                                                                   pected semantics as shown in the Ô¨Ågure. Intuitively, the se-
                                             1                                                                                          1
                                                                                                                              st                                                                                                      e
                          whose left index is the end position of the match of 1                                                  con-                mantics of a set of InputDataGraph nodes V is to return the
                          stant string ", " (comma followed by a whitespace) and the                                                                  set of token matches on the edge labels for all incoming and
                                                                                                                                                                                                              e                                            e
                          right index is the end position of the match of last lowercase                                                              outgoing edges to nodes v ‚àà V. For each node v ‚àà V and
                                                                                                                                             821
