

===== PAGE 1 =====
Seppo Linnainmaa

ALGORITMIN KUMULATIIVINEN PYORISTYSVIRHE

YKSITTAISTEN PYORISTYSVIRHEIDEN TAYLOR-KEHITELMANA

Pro gradu-tutkielma - ohjaaja professori M.Tienari

Tapiola 1970


===== PAGE 2 =====
YHTEENVETO

Algoritmien kumulatiivista pyéristysvirhetta liuku-
van pilkun aritmetiikassa pyritdin analysoimaan kehit-
timilld taémi yksitt#isten pytristysvirheiden Taylor-
kehitelméksi. Td&hiin tarkoitukseen esitetddn sekd ana-
lyyttinen ett& tietokoneelle soveltuva menetelma.
Yksittiiselle suhteelliselle pyéristysvirheelle konst-
ruoidaan tilastollinen malli. Sovellutuksina kdsitel-
lain pienalgoritmia a*-b* = (a+b)-(a-b) sekaé Horner-
shemaa' ja Gause-Jordanin matriisinkdéntialgoritmia.
Sovellutuksiin liittyvdt ohjelmat on ajettu IBM 7094-
tietokoneella.

II


===== PAGE 3 =====
SISALLYS

Yhteenveto Serer er ree a ti
Sisdllys os 6 DOR RRO MEMS NEOs Rac eweReCeReeee TIT
1. Johdanto Perr er rere eee ee
2. Pyéristysvirheen kdsite ete ccecerercccee
3. Suhteellisen pyéristysvirheen jakautuma
- Mantissaosan pyéristysvirhe ee
- Suhteellisen pytristysvirheen jakautuma
pyoristavassa aritmetiikassa seceeses 7
- Suhteellisen pytristysvirheen jakautuma
katkaisevassa aritmetiikassa ace eceee 9
4. Pyéristysvirhe laskutoimitusten yhteydessa 10
- Yhteen- ja vdahennyslasku Heel eeloww ee ee 10
- Kerto- ja jakolasku Serer ee 12
5. Pytéristysvirheen Taylor-kehitelma eenene 15
6. Taylor-sarjan analyyttinen kehittiminen 19
7. Taylor-sarjan kertoimien maé&rittdminen
tietokoneohjelmalla see e mene eneeenes 24
- Kertoimienlaskualgoritmi L i TERES 24
- Algoritmia L vastaava FORTRAN IV-
aliohjelmaryhma were weer eer eneeeeeees 28
- Yksikkthiirién menetelmi eee ec eesceee 32
8. Pienalgoritmit a*-c*:n laskemiseksi ani 34
9. Horner-shema SSS ee 40
- Taylor-sarjan analyyttinen méarittaminen 40
- Toisen asteen kertoimet pence rcccceree 42
- Nollakohtien lahekk&isyyden vaikutus
kertoimiin © See eels Sete ee eee eee eee 46
10. Matriisin ké4dntd Sharabelaice we & odkanereinillieimiedkin ie 52
Liite: Algoritmi L FORTRAN IV-ohjelmana see §=658
Kiytettyja merkintéja Ce wee eesec scene cesees 61
Viiteluettelo a 8 seine en wr ecemmeremecee BF

PEN

III


===== PAGE 4 =====
1.  JOHDANTO

Tietokoneiden mahdollistaman suuren laskentano-
peuden johdosta on tullut valttdmattémaiksi pyrkia
selvittémaiin pytristysvirheiden vaikutuksia, koska
niiden merkitys kasvaa nopeasti perdékkdisten laskutoi-
nitusten miurdn kasvaessa [1].

Kysymyst& lahestyttiess& on lihtikohtana tosiasia,
etta algoritmissa tapahtuva kumulatiivinen pydris-
tysvirhe on perdisin kussakin erillisessd laskutoi-
mituksessa syntyvisté yksittdisesta pyéristysvirhees-
ta. Naéiden avulla on pyritty laskemaan yldrajoja ku-
mulatiiviselle pyéristysvirheelle. Laajoissa algo-
ritmeissa on ollut pakko tyytyd melko karkeisiin ar-
vioihin t&élle ylirajalle [10].

Useissa tapauksissa tieto keskimédrdisesté vir-
heest& ja sen vaihtelualttiudesta olisi hyédyllisem-
pi kuin virheen yliraja. Tiussd tarkoituksessa on
py6ristysvirheita pyritty selittdméan tilastollis-
ten jakautumien avulla. Professori Henrici on mm.
teoksessaan 'Elements of Numerical Analysis' [4]
laajalti lahestynyt kysymyst4 téltd kannalta. Han
kisittelee piiiasiassa kiinteiin pilkun aritmetiikkaa.
Seuraavassa esityksessé pyritéin tekemiéin vastaavia
huomioita liukuvan pilkun aritmetiikasta.


===== PAGE 5 =====
2. PYORISTYSVIRHEEN KASITE

Mielivaltainen nollasta eroava kymmenjarjestel-
min reaaliluku voidaan esittd# muodossa

z= 40.d,4,4,... °10° , (261)

missd d..,d.,,-.. ovat numeroita, d_.,7 0 ja p on ko-
konaisluku. Osaa

m = £0.d.d,d,... (2.2)

kutsutaan luvun z mantissaosaksi ja silld& tarkoi-
tetaan lukua

m = 4(d,°10'+4.,°10 +4.,°10 + ... )- (2.3)

Osaa 10° kuteutaan eksponenttiosaksi, 10 on kanta-
luku ja p on eksponentti.

Tietokoneissa kantalukuna b on luvun 10 sijasta
useimmin jokin kahden potenssi (esim. 2‘ = 2,
2° = 8 tai 2* = 16). Myés télléin luku voidaan esit-
ta vastaavassa muodossa [4] ,[7]

g=m-b’ = +40.d,d,d,... -b?, a, #0, (2.4)

"

missd d..,4.,,... ovat b-kantaisen lukujdrjestelman
numeroita. Tdlléin mantissalla m tarkoitetaan lukua

m = ¢(d_,-b +2..°b +d.50b + «2. ). (2.5)
Ehdosta d., #4 0 seuraa
bis |m[ <1. (2.6)

Mantissaosaan mahtuu tietokoneessa rajoitettu
miard, t kpl, numeroita, jolloin luku zg koneesta


===== PAGE 6 =====
riippuen joko katkaistaan tai pyéristetHin '‘oikein'
muotoon

2" = 40.d.4,...d,°b" (2.7)

Tata muotoa kutsutaan liukuvan pilkun esitykseksi
ja lukua z* liukuluvuksi.
Pyéristetyn ja tarkan luvun erotusta

r= 2*-% (2.8)

kutsutaan absoluuttiseksi pytristysvirheeksi. Kos-
ka absoluuttisen pyéristysvirheen suuruus liukulu-
kujen yhteydessé riippuu ratkaisevasti itse luvun

z suuruudesta, on usein kiyt&nnéllisempdé tarkas-
tella suhteellista pyéristysvirhetta

se, (2.9)

jolloin

z* = 2(1+e) . (2.10)


===== PAGE 7 =====
3. SUHTEELLISEN PYORISTYSVIRHEEN JAKAUTUMA

Mantissaosan pyéristysvirhe

Suhteellisen pytristysvirheen tilastollisen ja-
kautuman selvittimiseksi on syyt# tarkastella aluk-
si pelkistHin mantissaosaa. Merkitsemme pytériste-
tyn luvun z* mantissaosaa m*:lla, jolloin

& = m*-m (3.1)

on mantissaosan absoluuttinen pytristysvirhe.
Olkoon

u=bdb* (3.2)
eli
u = 0.00...01°b° (3.3)

esitettyni muodossa (2.7). Mikili pydéristys on suo-
ritettu 'oikein', on voimassa

“jus ec iu. (3.4)

Intuitiivisesti pidetddin selvind, ett& pytris-
tysvirhe on satunnainen luku ja siis tilastollisel-
ta jakeutumaltaan tasai- fats)
sesti jakautunut vélilld “i
[-4u,iu]. Satunnaisuus
on tosin ndenndisté: jos
otamme uudelleen alkupe-
rdisen luvun ja pybris-
taimme sen, saamme uudel-



===== PAGE 8 =====
leen saman pyéristysvirheen [4]. Tasainen jakautuma
antaa kuitenkin hyvin tilastollisen mallin, jonka
avulla voidaan tarkastella pyéristysvirheiden kdayt-
taytymisté pitkissé laskutoimitussarjoissa.

Tilastollisen jakautuman tiheysfunktiolla f(x)
tarkoitetaan Ax:114 jaettua todenndkéisyytté sille,
etté muuttujan arvo on x:n ja x¢#Ax:n vdlilldé, kun
Ax on Hdrettiémin pieni[2]. Pytristysvirheen € ja-
kautuman tiheysfunktio on muotoa

Oo, x<-4u
f.(x) =4e, -susx< iu (3.5)
Oo, x>tju,

miss& c on eris vakio.
Kokonaistodenndktisyys on yksi, joten

flte(x)ax = cu =1, (3.6)

misté&

‘ (3.7)

-1
Sey
Ndin saatu virheen tiheysfunktio on havainnol-
listettu kuvassa 1.
Virheen itseisarvolle saamme tiheysfunktioksi

Oo, x<0
f(x) = = ; O<xeiu (3.8)
Oo, x>m.

Useissa tietokoneissa k&ytetédin oikean pytris-
tyksen sijasta katkaisevaa aritmetiikkaa [6], jol-
loin pyéristysvirhe

é' = -|m*-m| = (m*-m)-sign m (3.9)

on tasaisesti jakautunut vdlillad [-u,0]. Funktio


===== PAGE 9 =====
sign x médritelldadn

-1, x<0O
signx={0, x=0 (3.10)
1» x>O.

Pytristysvirheen ¢' tiheysfunktioksi saamme

0: 5 x<-u
tex) = (2, -u<x<0 (3.11)
0, x>oO.

Tarvitsemme viel# itse mantissan jaksautuman pys-
tyaiksemme laskemaan suhteellisen pytristysvirheen
jakautuman. Tuntuisi luonnolliselta olettaa, etté
|m| olisi tasaisesti jakautunut vdlill4 [b‘,1). On
kuitenkin todettu, ettei tima pidi paikkaansa [3].
Jos tarkastelemme suurta joukkoa reaalimaailman kym-
menjairjestelmin lukuja, esimerkiksi fysikaalisia va-
kioita, voimme todeta, ett# niist& on noin 30% yk-
k6sellé alkavia.

Jonkinlaisen teoreettisen selvityksen taélle ti-
lanteelle antaa samoin La (%)
ilmeisend pita&dmimme to-
siasia, ettd kun kaikki
reaalimaailman luvut 3
kerrotaan tietylla va-
kiolla, niiden ensin-
méaisten numeroiden ja-
kautuma ei muutu. Tahdn
nojaamalla voidaan m:n
tiheysfunktiolle johtaa
kuvassa 2 havainnollistettu kaava [8]

t
OA 4.0

kuva 2

Qo, x<b"

£,(%) = ies » Waxed (3.12)

0 , kel.


===== PAGE 10 =====
a a

Tima tiheysfunktio antaa ykkéselld alkavien lukujen
esiintymistodenniktisyydeksi J. 'f,,(x)dx = log,2 = 0.30,
miki vastaa kokeellista tulosta.

Suhteellisen pytristysvirheen jakautuma
pyéristivissd aritmetiikassa

Kun kirjoitamme suhteellisen pydristysvirheen e
lausekkeen (2.9) mantissa- ja eksponenttiosan avul-
la, saamme kaavojen (2.4) ja (3.1) perusteella

* ‘a «pH? . «bP
e = Soe. om ee (3.13)

Johdamme nyt e:n itseisarvon le| = |€/m| tiheys-
funktion.

Kahden toisistaan riippumattoman satunnaismuut—
tujan 7 ja § suhteen 4 =7/t tiheysfunktio saadaan
kaavasta [2]

f, (2) = J) xf,(2x)f,(x)ax , (3.14)

kun 5°>0. MikHli oletamme, ettd &€ ja m ovat riip-
pumattomia, miki tuntuu luonnolliselta simakin suu-
rilla t:n arvoilla, saadaan |e|:n tiheysfunktioksi
_ kaavan (3.14) perusteella

Oi vs z<0

“2 4 2:(b-1
Qx-desmrptt = GARE + 062 <0
fe(s) =4 2. 1 _4 1 2 (3.15)
. LSS * S sit-sl-

fu < 2 s sub
O! 5 z>tub.

5

Saamme tdst& |e|:n ylirajakei [10]
je| <jub. (3.16)

Kun viel& oletamme e:n jakautuman olevan symmet-
rinen origon suhteen, miki myis tuntuu ilmeiseltaé,


===== PAGE 11 =====
saamme e:n tiheysfunktioksi

abeint izi + 4a
f,(2) = telstra gu<|z|sgub (3.17)
0, |zl>gub .

Tam4 on havainnollistettu kuvassa 3a kymmenjarjes-
telmin tapauksessa.
£,) £.(z)

++ 0.39"10 ++ 0.39440"

z
5 o wit 40 5 out

kuva 3a kuva 3b

Satunnaismuuttujan keski- eli odotusarvo saa-
daan kaavasta [2]

E(§) = [7 xf(x)dx (3.18)
ja varianssi kaavasta
p(t) = Ji [x-B(5)l’ t(x) ax. (3.19)

Varianssin neliéjuuri, keskihajonta D(§) kuvaa muut-
tujan arvojen keskimédrdista poikkeamaa keskiarvosta.
Saamme kaavojen (3.18) ja (3.19) avulla e:n odo-

tusarvoksi ja varianssiksi

Hy = Ble) = 0, Of = D'(e) = gpBa(b?-1). (3.20)

Seuraavassa taulukossa on varianssin arvoja kantalu-
vun b eri arvoilla.

b On fu
2 0.1803
8 1.262
10 1.791
16 | 3.832
64 41.02



===== PAGE 12 =====
-9-

Suhteellisen éristysvirheen jakautuma
katkaisevassa aritmetiikassa

Katkaisevassa aritmetiikassa saamme yhtéilista
(2.9) kaavojen (2.4) ja (3.11) perusteella suhteel-
liselle pytristysvirheelle lausekkeen

2*-2 _ (m*-m)-b° _ m*-m 2
e=4= abr" Gaten we ier | 8821

Kun oletamme ¢:n ja |mizn olevan riippumattomia,
saamme kaavan (3.14) perusteella e:n tiheysfunk-
tioksi (kuva 3b)

(oO, meme

fox-desc et - ta's|-4-a] >

f.(2) = 4 or a ee (3.22)
w*"u'x-dn b* ~ Ub-in bd’
-us2:20
oO, 270

\

Kaavojen (3.18) ja (3.19) perusteella saamme
odotusarvoksi ja varianssiksi

Ha= B(e) = BORE) ,
Gi= D’(e) = -B(e)| HPs1) + Be) ; (3/23)

Seuraavassa taulukossa on odotusarvoja ja varians-
seja kantaluvun eri arvoilla.

b Ufa oO; /u*

2 0.7213 . 0.2010
“Y =—!,60$7

8 -1.683 2.216

10 -1.954 3.346

16 -2.7 05 8.011

32 ct eH

4 -7.574 106.7



===== PAGE 13 =====
4. PYORISTYSVIRHE LASKUTOIMITUSTEN YHTEYDESSA

Yhteen- ja vihennyslasku

Kahden liukuluvun yhteenlaskun tarkkuuteen vaikut-
taa ratkaisevasti yhteenlaskettavien lukujen eksponent-
tien p, ja p, keskiniinen ero Ip,-p,! [10].

MikHli p.= p,, on yhteenlasku varsin suurella to-
denndkiisyydelld tarkka. Ainoan poikkeuksen muodostaa
tapaus, jossa saadaan muistinumero mantissojen vasem-
manpuoleisimpia numeroita yhteenlaskettaessa. Tdlléin
joudutaan vadhiten merkitsevastd numerosta luopumaan,
koska mantissa edelleen saa sisilti#i korkeintaan t nu-
meroa. Samaan tilanteeseen saatetaan joutua myds, kun
Pp. ja p. ovat likimain yht&suuret. Tdm# on kuitenkin
sita epitodenndkijisempia mit suurempi |p, -p,| on.

Kun |p, -p,! = 1, kohdistuu mielenkiinto lahinnd tapeauk-
siin, joissa luvut ovat erimerkkiset ja niiden itseisar-
vot niin l&helld toisiaan, ett# tulosta joudutaan 'siir-
timidn vasemmalle*, jolloin pdistiin tarkkaan tulokseen.

D.W. Sweeneyn suorittamassa tutkimuksessa [8] |p, -p,joli
kidytinnin yhteenlaskuissa nolla 33-56%:n ja yksi 12-27¢:n
todenndkéisyydelld kantaluvun saadessa arvot 2-64. Oi-
kealle siirtojen todennikiisyys oli vastaavasti 20-2%
ja vasemmalle siirtojen 20-11%.

Eksponenttien eron kasvaessa vihenee tarkan lasku-
toimituksen todennikitisyys ja edell& johdetut mallit
pyéristaévdlle ja katkaisevalle aritmetiikalle pitivit
varsin hyvin paikkansa. Tami paikkansapitivyys loppuu
|P, -p,|:n ylitt&éessé4 arvon t. TH11léin luvuista itseis-
arvoltaan pienempi muodostaa sellaisenaan pyéristysvir-
heen. Nd&iden tapausten suhteellinen osuus kaikista
yhteenlaskuista on kuitenkin niin pieni, ettei


===== PAGE 14 =====
-11-

niilld& ole suhteellisen pytjristysvirheen jakautumaan
nerkittivida vaikutusta, kunhan huomioimme tapauk-
set, joissa toinen yhteenlaskettava on nolla, jol-
loin laskutoimitus on tarkka. Toinen operandi on
edelld mainitun tutkimuksen mukaan tarkka noin 8%
todenndktjisyydella.

Koska suhteellisen pytristysvirheen jakautuma
riippuu |p,-p,|:n jakautumasta, sille on mahdotonta
johtaa t#ysin yleispitevdi mallia. Jonkinlaisen
keskivertomallin muodostaminen tosin on mahdollis-
ta. T&lléin tullee kysymykseen lahinnd professori
Tienarin ehdottama malli: kun

(2,+2,)" = (2, +2,)+(1+e) ’ (4.1)

missa& e on suhteellinen pytristysvirhe, kirjoite-
taan e muotoon

e = d-e' , . (4.2)

missd e' noudattaa edell& johdettua jakautumaa ja
satunnaismuuttuja 46 saa arvon 0 todennikjisyydella
p sek& arvon 1 todenndkiisyydelld i-p. Luku p edus-
taa tdlléin todenndktisyytté tarkalle laskutoimi-
tukselle. Merkitsemme seuraavassa niin saatavan
ein jakautuman odotusarvoa 1,:114 ja varianssia
52114.

Virheen e yliraja voidaan méuéritéd yleispitevis-
ti. Perustuen epdyhtdliihin (2.6) ja (3.4) saadaan
yhtdlosté (3.13) pydristivdlle aritmetiikalle [7]

le! = [E\ stun. (4.3)

Katkaisevalle aritmetiikalle saadaan vastaavasti
jel < ub. (4.4)

Eréiss&# koneissa joudutaan jo ennen laskutoimi-
tusta pydristimiiin eksponentiltaan pienempdH ope-


===== PAGE 15 =====
=i 4D ws

randia. T&lldéin saadaan ylirajoiksi ©

le] s yu(b+1) (4.5)
pyorist&vassa ja

je| s u(b+1) (4.6)

katkaisevassa aritmetiikassa [10].

Kaikki yhteenlaskua koskeva koskee mnyés vahennys-
laskua, koska ndiden ero voidaan tulkita lukujen
etumerkkien vaihteluksi. ,

Kerto- ja jakolasku

Kahden liukuluvun vdlinen kertolasku suoritetaan
laskemalla eksponentit yhteen ja kertomalla mantis-
sacsat keskendinm. Kun

(2,°2,) = z,*zs(1+e) , (4.7)
voidaan todeta pyéristysvirheen e noudattavan joh-
dettua jakautumaa, so. pytrist&dvissd aritmetiikassa
jakautumaa (3.17) ja katkaisevassa jakautumaa (3.22).

Jakolaskussa vastaavasti vihennetdiin eksponentit
toisistaan ja mantissaosat jaetaan keskendan. Myés
osamaarin pydristysvirhe e noudattaa annettua ja-
kautumaa, kun merkitsemme

(By = E14). (4.8)

Merkitsemme seuraavassa kerto- ja jakolaskun
pyéristysvirheen odotusarvoa.4:114 ja varianssia
or:11a4. Tallin

[+r = May a= on e (4.9)


===== PAGE 16 =====
- 13 -

Johdetun mallin pit&vyys kerto- ja jakolaskussa
testattiin algoritmin 5 avulla.

Algoritmi S (Satunnaisalgoritmi). Algoritmi suo-
rittaa satunnaisia laskutoimituksia 2t numeron tark-
kuudella katkaisten tulekeet: t numeron mittaisiksi
ja luetteloiden syntyneet pyéristysvirheet. Jos
tuloksen eksponentti ylittd& itseisarvoltaan puo-
let suurimmasta mahdollisesta eksponentista max|pl,
sen itseisarvoa pienennetiéiin 4 -max|p| :114.ylivuo-
tojen ehk#isemiseksi. Algoritmi kdyttdé& vektoria
LUKU(1) ,LUKU(2),...,LUKU(4100). Merkintaé A<SAT{B,
C,...,2} tarkoittaa, ett& A:n arvoksi sijoitetaan
joukon {B,C,...,2} satunnaisesti valitun alkion arvo.

$1. [Alkuasetukset.] Vektorin LUKU kymmenen ensin-
maisen alkion arvoksi sijoitetaan tunnettuja va-
kioita: m , Neperin luku, Eulerin vakio, kultai-
nen suhde jne. N<-10 (N on kéytéssd olevan
taulukon osan suurin indeksi).

$2. [Laskutoimituksen valinta.] I<-SAT{1,2,...,N},
Je-SAT{1,2,...,N}, SX<-SAT(S3,54,55,56}, —>SX.

S83. [Yhteenlasku.] TULOS<—LUKU(I)+LUKU(J), —>S7.
S4. [Vahennyslasku.] TULOS<—LUKU(I)-LUKU(J), —>S7.
85. [Kertolasku.] TULOS<-LUKU(I)-LUKU(J), ->S7.

S6. [Jakolasku.|] Jos LUKU(J) = 0, --S2. Muuten
TULOS<—LUKU(I) /LUKU(J).

87. [Etumerkin valinta.] SIGN<SAT{-1,1},
TULOS<-SIGN*TULOS.

88. [Py$ristysvirheen kirjaus.| Pyéristd mantissa
t numeron mittaiseksi, luetteloi pytristysvir-
he ja pienennd tarvittaessa eksponenttia.

89. [Tulosalkion valinta.] Jos N< 100, H<-N+1,K<-N,
muuten K<-SAT({1,2,..,N}.

$10.[fuloksen talletus.|] LUKU(K)<-TULOS. Jos testi-
tuloksia halutaan lisd##, —»-S2, muuten algorit-
mi pdittyy. i


===== PAGE 17 =====
- 14 -

Testitulosten lukumiirdksi mé#rdttiin 10000 seka&
pyoristivalle etti katkaisevalle aritmetiikalle,
jolloin saatiin riittdévaé kuva pytristysvirheiden ja-
kautumasta. Summan ja erotuksen pyéristysvirhei-
den jakautumalle algoritmi S ei antanut mielekista
mallia, koska eksponenttien jakautumaan ei kiinni-
tetty erityista huomiota. Sen sijaan tulon ja osa-
méirin pytristysvirheiden jakautumalle saatiin mal-
li, joka vastaa teoreettista mallia. Tulokset on
esitetty pyéristiville aritmetiikalle kuvassa 4a
ja katkaisevalle kuvassa 4b.

Testikoneena oli IBM 7094, jonka aritmetiikan
kantalukuna on kaksi ja t = 27 (simuloitaessa pyé-
ristavddé aritmetiikkasa jouduttiin asettamaan t = 26).
Mallin hyvé pit&évyys osoittaa omalta osaltaan myés
jakautuman (3.12) patevyyttaé kaksijirjestelmainkin
yhteydessd. T&td# jakautumaahan kiytettiin pytris—
tysvirheen teoreettista jakautumaa johdettaessa.

havaintojen
lukum.

kuva 4b


===== PAGE 18 =====
5. PYORISTYSVIRHEEN TAYLOR-KEHITELMA

Suoritettaessa perikkiiisid laskutoimituksia liit-
tyy jokaiseen laskutoimitukseen oma pytristysvir-
heensé. Na&iden yksittédisten pytristysvirheiden yh-
teisvaikutusta kutsutaan kumulatiiviseksi pyéris-
tysvirheeksi. Jos tarkastelemme esimerkiksi kah-
den pytristetyn luvun a* ja b* jakolaskua, saamme

(ac) a(i+e (1+ e.)

DF b 1+e,

"

2(14e,) (14e,) (1-e,+et-er+ ... )
b a

= Fl 1+e, -e. +e. -e, 6, +€,€. -e,e (5.1)
-e,e,e.te,e,+e,e2-e2+ ... )

jolloin E. edustaa kumulatiivista suhteellista pyé-
ristysvirhetté. Kuten taéssé esimerkissi# voidaan
kumulatiivinen pyéristysvirhe E, aina lausua yksit-
taisten pytristysvirheiden Taylor-kehitelmanid, so.
muodossa

E, = Een LA +7 ans e.e,+ <e*) ’ (5.2)
T 5

missd <e°) tarkoittaa e,:den suhteen vihintéin kol-
mannen asteen termeji ja a:t algoritmin alkuarvois-
ta riipuvia vakioita. Kutsumme sarjaa (5.2) seu-
raavassa (E,e)-sarjaksi.

Kun merkitsemme (E,e)-sarjan k:nnetta osasummaa,
80. e,:den suhteen k:nnen asteen summaa EY :lla,
saamme yhtdélin (5.2) muotoon

>

E, = Ec+EC+ >. (5.3)


===== PAGE 19 =====
- 16 =

Toisen ja korkeamman asteen termien vaikutus ku-
nulatiiviseen pytjristysvirheeseen on yleensd mer-
kityksetin yksittdisten pytristysevirheiden e; suu-
ruusluokan pienuuden johdosta, joten kaéytdnnéssaé
voidaan E,:n lauseke ilmoittaa ensimmaisen asteen
termiensé avulla [9], so.

E,= EC. (5.4)

n

Kumulatiivisen pytristysvirheen jakautuma voi-
daan johtaa yksitt#isten pyéristysvirheiden jakau-
tumien avulla. Jos satunnaisluvut f) $:5..+)6m ovat
toisistaan riippumattomia ja niiden odotusarvot
OVAt His Uageees Um Ja varianssit 9, oL,...,0, , on
satunnaismuuttujan

& = af, ta,b,t 22. +anbm (5.5)
odotusarvolle ja varianssille voimassa | 4)

E(E) = @U+O yt coe Bn lng (5.6)
D*(£) ~ aor+aici+ ... +8h0%. (5.7)

Todennikéisyyslaskennan keskeisen raja-arvovaitta-
min nojalla §:n jakautuma lisdkei lihestyy ns.
normaalijakautumaa (kuva 5)
min ldhestyessé diretinta [2].
Normaalijakautuman maé-
rittaévat yksikdsitteisesti
sen odotusarvo ja varianssi.
Sille on ominaista mm., etta
68.3% havaituista satunnais-
luvuista poikkeaa vdihemmin
kuin varianssin neliéjuuren
eli keskihajonnan verran odotusatvosta.
Pytristysvirheet eivaét yleens&# ole tHysin riip-
pumattomia toisistaan, mutta niiden viliset riip-
puvuudet ovat niin vadhdisid, etta kaavoja (5.6)
ja (5.7) kHyttimilld saadaan riittévid arvioita



===== PAGE 20 =====
-17 -

kumulatiivisten pyéristysvirheiden jakautumille yk-
sittdisten pyéristysvirheiden jakautumien avulla [4].
Oikein pyéristavissé aritmetiikassa on kaavan (5.6)
perusteella myts kumulatiivisen pydristysvirheen
odotusarvo nolla.

Pitkissd laskusarjoissa voidaan nojata normaali-
jakautumaan myts médritettiesséi kdytinndllisid yla-
rajoja py$ristysvirheille. WNormaali jakautumassa
sijoittuu 99% kaikista havainnoista la&hemm&ksi odo-
tusarvoa kuin 2.57606, mised o on normaalijakautu-
man keskihajonta. Selkeind esimerkkind voidaan
tarkastella perdkkdisten kertolaskujen kumulatii-
vista pyéristysvirhetté oikein pytristaévassé arit-
metiikassa.

Tuloa

P = Th;

vastaa liukuvan pilkun aritmetiikkea kdyttadvissé
koneessa, kun alkuarvot h,, i = 0,..., HW oletetaan
tarkoiksi,

P* = P(14E,.) = Mh W(14e;) ~ Tin. (14Ze.) 5

miss kukin e; on yksittH#isessi kertolaskussa syn-
tynyt pytristysvirhe.

Jos kertolaskut on suoritettu binddriaritmetii-
kassa, on virheiden e;, i = 1,...,H odotusarvo 0
ja varianssi 0.1803u* kaavan (3.20) perusteella.
Saamme E,:n odotusarvoksi ja varianssiksi kaavo-
jen (5.6) ja (5.7) avulla

E(E,) = 0, D*(E,) = H-0.1803u" ,
jollain siis og. varmuudella
|E,| < 2.576-VE-0.1803u* = 1.09VHu .

fri Wilkinson [10] on pad&tynyt kaytanntn yldrajana
tulokseen VNu, miki vastaa varsin tarkkaan edelld


===== PAGE 21 =====
- 18 -

johdettua tulosta. Teoreettiseksi yldrajaksi saa-
daan

|E,| < 4Nub ,

joten varsinkin suurilla N:n arvoilla saataisiin
varsin epdrealistinen ylirajan arvo ilman tilas-
tollista jakautumaa tai empiirisid& kokeita.

Kasitellyssa esimerkissd syntyivdat kaikki pyé-
ristysvirheet kertolaskujen yhteydess&. Pytris-
tysvirheet voidaan kuitenkin jakautumansa ja syn-
tytapansa perusteella jakaa esimerkiksi tyyppeihin

1. alkuarvojen pyéristysvirheet
(keskiarvo ,, varianssi 62)

2. summan ja erotuksen pyéristysvirheet
(keskiarvo u,, varianssi 0;)

3. tulon ja osamfurdn pyéristysvirheet
(keskiarvo 1, , varianssio;),

Olkoot yhtélissé# (5.2) e:,,¢:,,-.+,e:, tyyppid 1,
Sieeee Gi, tyyppid 2 ja e.,.,+--,e., tyyppid 3 ole-
via pyéristysvirheité. Td&lléin E,:n odotusarvo

ja varianssi voidaan kaavojen (5.4), (5.6) ja (5.7)
mukaan lausua muodossa

ik L m
E(E,) ~ E(E,) = Lanitit2 Bnitet) nite » (5-8)
jet ket Let
D(E,) = D(E,) = fetiot +Paiyo +P eno . (5.9)
gui juke grt
Esimerkiksi jakolaskun (5.1) pytristysvirheelle E.
E(E.) ~ Ur , D°(E.) ~ 202402.

Mikéli alkuarvot oletetaan tarkoiksi, on yhtilis-
si (5.8) U.= 0 ja yhtdliéssd (5.9) of= 0. Pytris-
tavassé aritmetiikassa M,= Us = Uy = 0.


===== PAGE 22 =====
6. TAYLOR-SARJAN ANALYYTTINEN KEHITTAMINEN

Algoritmin laskutoimitusten lukumdirim kasvaessa
on yh vaikeampaa saada selville Taylor-kehitelmin
kertoimia. Algoritmin rakennetta analysoimalla on
kuitenkin mahdollista laskea analyyttisesti ylei-
sid lausekkeita kertoimille.

Kaikki algotitmit muodostuvat alkeislaskutoimi-
tuksista, joissa jokin operaatio kohdistetaan kor-
keintaan kahteen operandiin. Olkoon q, erdin las-
kutoimituksen tulos. Td&lléin

Qn = Qnlaira;) » (6.1)

nissé Q, tarkoittaa yleensé yhteen-,vahennys-, ker-
to- tai jakolaskua. Se saattaa tarkoittaa myis po-
tenssiin korotusta, logaritmin ottoa tms.

Tietokoneessa vastaa yhtdléé (6.1) pydristysten
vaikutukseata yhtdlé

an = Q,(az,aj;)*(1+e,) , (6.2)

missé e, on laskutoimituksen Q, yksittédinen suhteel-
linen pytristysvirhe.

Merkitsemme absoluuttista kumulatiivista pytris-
tysvirhettaé

Rn = Qn-Gn » (6.3)

jolloin suhteellinen kumulatiivinen pytristysvirhe
voidaan esittéi muodossa

E, = eS «© (6.4)


===== PAGE 23 =====
- 20 -

Jos q, on erityisesti alkuarvo, jolloin q* = qn(i+e,),
on

R, = qdne&, (6.5)
ja
E,=@n - (6.6)

Myés R, voidaan lausua yksittdisten suhteellis-
ten pyéristysvirheiden Taylor-kehitelmand

R, = Fone: +Leny €: €; + (e*) . (6.7)

Nimitdmme sarjaa (6.7) (R,e)-sarjaksi. Taylor-ke-
hitelmin yksikdsitteisyyden ja yhtdlon (6.4) perus-
teella saamme E,:n ja R,:n yhtdéldissi (5.2) ja (6.7)
esiintyville kertoimille kaikilla kysymykseen tu-
levilla i:n ja j:n arvoilla

a. = Sali, (6.9)
rt) Qn

R,voidaan E,:n tapaan esitta#a eriasteisten osasum-
miensa avulla muodossa

R, = RY +Ro 4+4e) . (6.10)

Lausekkeen Q,,(q;,q;) saamme vdliarvolauseen ja
mé#ritelmin (6.3) nojalla muotoon [4]

Q,(az aj) = an +DiRi +DyR; +4D,uR: Ri +DayR: Bj
+4D,gjRjR;)+(R) , (6.11)

missé D,; on Q,(a; »a;)en osittaisderivaatta qi:n
suhteen pisteess& q, ja D,ij vastaavasti toinen osit-
taisderivaatta samassa pisteessi. Yht&liiden (6.2),


===== PAGE 24 =====
- 21 -

(6.3),(6.10) ja (6.11) avulla saamme
Ry = DyuR;’ +DyRj” +4, es (6.12)

je
@ @) 0) a)
R, = Duki +D,B; +2Dn. aR? RY +Dri Ri Rj (6.13)

(@) ay

+4Dyj RSPR) +D.Rie, +D,jRoe. -

Tarkastelemme saatuja tuloksia kaliden pienen esi-
merkin valossa. Varsinaisissa algoritmeissa péidym-
me differenssiyhtéléihin, esimerkkind tadllaisista
sovellamme teoriaa myéhemmin Horner-shemaan.

Esimer®ki 1. Suoritetaan laskutoimitus ec = a/b,
missd a on tarkka, so. sité ei tarvitse koneessa
pyérist#a, ja b:ta vastaa koneessa b* = b(1+e.).
Voimme siis yhtdlin (6.5) perusteella merkitad
R? = R° = 0, RY = be,, R. = 0. Kaavojen (6.12) ja
(6.13) perusteella

O) a) m
R, = PRY-BRS +ce, = -ce, +ce,

rR” = gk '=ferR, +0-prR" Ri + +FrR, R” +pRie. ~prRe.
= C0@.,@,- CO,e@c «
Kaavojen (6.8), (6.9) ja (6.10) perusteella c:n
(E,e)-sarja on

E. = -@,+@, +€,-@,@,+ «2. ©

Samaan tulokseen péHdyimme aikaisemmin yhtéliissd&
(5.1), kun otamme huomioon, ett& e, = 0.

Esimerkki 2. Olkoon b*=(1n a} kun a* =a(i+e,).
Bdslla esitetyt kaavat johdettiin kahdelle operan-
dille, mutta niité voidaan soveltaa yhden operan-
din operaatioihin, kunhan osittaisderivaatat ‘'toi-
sen' operandin suhteen ajatellaan nolliksi, mik&
on luonnollista, koska tata ei esiinny laskutoimi-


===== PAGE 25 =====
- 22 -

tuksessa. Myts taétd toista operandia vastaava vir-
hetermi ajatellaan nollaksi. T&ll6in saamme

o. 1

Ry = gee, tin a +e, = e, +be,
ja
Re = do-}- dra’ ej +Le,e. = —fei +e, @, ;

missé e, on logaritmin otossa tapahtuva suhteelli-
nen virhe. J&lleen pa#&semme samaan tulokseen yh-
tHlista R, = [ln(atae,)] (1+e,)-b, kun kdytaimme hy-
viksi kaavaa ln(1+e,) = e,-e2/2+<e,).

Edellad esitetyn analyysin perusteella voimme
myis verrata suhteellisten ja absoluuttisten yksit-
tHisten pytristysvirheiden e, ja r, yhteytta kumu-
latiivisen pyéristysvirheen Taylor-kehitelmassa.

Operaation Q, aiheuttama yksittdinen absoluut-
tinen pyéristysvirhe voidaan kirjoittaa yhtéléi-
den (6.2) ja (6.11) mukaan muotoon

rn

* *
Q.(a",qj )e, (6.14)
Qn On +R: @, tDyRj ent ++

"

Taten R,:n esityksesté& pytristysvirheiden r; avul-
la, ns. (R,r)-sarjasta

R, = [auk: +1 @,.97: 3; +<r*) (6.15)
saadaan
R, = Pana e, +(e”) . (6.16)

Kun vertaamme yhtdltitaé (6.7) ja (6.16), saamme
Taylor-kehitelmin ykeikdésitteisyyden nojalla i:n
kaikilla arvoilla

Chi = qidni . (6.17)


===== PAGE 26 =====
= 23 -

Kaavan (6.8) perusteella
ani = dea a (6.18)
Ndin olemme selvittineet (E,e)-, (R,e)- ja (R,r)-

sarjojen ensimmdisém asteen termien vdliset yhtey-
det.


===== PAGE 27 =====
7. TAYLOR-SARJAN KERTOIMIEN MAARITTAMINEN
TIETOKONEOHJELMALLA

Kertoimienlaskualgoritmi L

Laskualgoritmien laajetessa alkaa myis Taylor-
sarjan analyyttinen kehittéminen tuottaa vaikeuk-
sia, koska saadut differenssiyhtaéliét monimutkais-

tuvat. Voimme kuitenkin so-

Qn Sn Mn veltaa analyyttista teoriaa
du | 0 | dub tietokonealgoritmiin, jonka

Qu-s| O | O |!
; i avulla Taylor-sarjan ensin-

maéisen asteen kertoimet voi-
daan laskea kullekin alkuar-
vojoukolle erikseen varsin
: vaikeissakin algoritmeissa.
a, | 0/0 Kertoimienlaskualgoritmi
; L perusfuu yhtélddn (6.12).
Algoritmin lahtékohtana on
kaikkien alkuarvojen ja yk-
kuva 5 sittdéisten laskutoimitusten
tulosten y,.vieminen pinoon
niiden esiintyessd ensimmiis-
ti kertaa. Nain syntyneen pinon (q,,5 4,5+++) Gy)
kukin elementti on siis joko alkuarvo tai tulos
operaatiosta, joka on kohdistunut yhteen tai kah-
teen pinossa alempana olevaan elementtiin. Ajat-—
telemme kuhunkin elementtiin q,, n = 1,.+.,N, liit-
tyvién R,:n ja e,:n kertoimet Q, ja 4, siten, etta
ehto

qa. 0/0

@)

Ry = LeoRy +) nen (7.1)

on voimassa.


===== PAGE 28 =====
- 25 -

Aluksi toteutamme yhtdélin (7.1) asettamalla o,=1,
Q@n = 0, n AN ja ya = O, n = 152,0005Ns Olkoon
an = Qu(ai,q;), missd i > j. Yht#lin (6.12) mukaan
tiytimme yhtdlin (7.1) ehdon myts sijoittamalla nyt
Que 0, Qie—Dais Q3<-Dnj ja nNn<-dx. Tama tilanne on
esitetty kuvassa 5.

Seuraavaksi nollaamme pinossa ylimpind olevan
nollasta poikkeavan Q,:n eli Qi:n. Jos esimerkik-
si qi: = Qi(aj.qa.), on tim& nollaus kaavan (6.12)
mukaan mahdollista asettamalla Qj <— 9+ ¢iDij,

Qu = Qidir ja ni~wgqi-. Nain jatketaan g,:ien nol-
laamista edeten pinossa alaspiin, kunnes koko pi-
no on kiyty lapi, so. Q,= 0, n = 1,2,...,N. Ehto
(7.1) on koko ajan voimassa, joten lopputuloksena
saadaan yhtéliéiden (6.7) ja (7.1) sekaé Taylor-ke-
hitelmaén yksikdsitteisyyden nojalla 7 -sarakkeeseen
(R,e)-sarjan ensimmdisen asteen kertoimet.

Voimme todeta, ettd algoritmin edistyess& 7, py-
syy nollana, kunnes g, otetaan nollattavaksi. Tal-
léin yn, :n arvoksi tulee Q.qn- Mikdli jaitamme tis-
sa vaiheessa kertomatta q,:114, saamme yhtdlién (6.17)
perusteellay -sarakkeeseen (R,r)-sarjan kertoimet.
Voimme siis poistaa operaatiot 9,<—-O, Mn<—-Q,qn ja
samalla koko 7-sarakkeen, jolloin algoritmin p#dt-
tyessi g-sarakkeessa on (R,r)-sarjan kertoimet.
Algoritmissa L vastaa 9,-kenttéd kentt& COEFF(n).

Algoritmin L 1.osassa luotavan pinon I:s tietue
on muotoa

[ VALUE(I) [VFloperitorert)| CORFF(I) |.
Kentaéss& VALUE on’ algoritmin alkuarvon tai las-

kutoimituksen tuloksen TYPE | operaation laatu
arvo q;, TYPE ilmoittaa

operaation Q, laadun : ecterro
viereisen taulukon mu- 2 mayeensaes

kaan, OPER1 ja OPER2- 3 | yhteenlasku
kentissi on linkit ope- * | WSkennyeteeku
randeja vastaaviin tie- 3 wersolaae
tueisiin ja COEFF-kent- 6 | Jakolasku



===== PAGE 29 =====
= 26 -

tiiin lasketaan kertoimet kuten edelld esitettiin.
TYPE- ja OPER-kenttien avulla pystytdin laskemaan
tarvittavat osittaisderivaattojen arvot.

Kun q, liittyy laskualgoritmissa laskutoimituk-
seen, siihen viitataan algoritmissa L kentién QI
avulla, joka sisH1t#H linkin q, :n viimeksi lasket-
tua arvoa vastaavaan tietueeseen (ko. tietueen pi-
noindeksin). Seuraavassa kutsutaan QI:td muuttu-
jan q, nimikkeeksi.

Algoritmi hb (Kumulatiivisen pyéristysvirheen Tay-
lor-sarjan kertoimien lasku). Algoritmi 1 jakau-

tuu kahteen osaan. Mielivaltainen laskualgoritmi,
‘algoritmi A', suoritetaan kokonaisuudessaan kayt-—
tien osaa 1, joka luo tarvittavan tietuepinon. Pi-
nolle on varattava tilaa vahintdin niin monelle tie-
tueelle kuin algoritmissa A on alkuarvoja ja lasku-
toimituksia yhteensd. Pinoindeksi I on pinon pohjal-

ta lukien ensimmiisen vapaan tietueen jarjestysnu-
mero. Osassa 2 lasketaan tuloksen q, (vastaava pi-
noindeksi N) kumulatiivisen pytristysvirheen Taylor-
kehitelmin ensimm#isen asteen kertoimet osassa 1 muodos-
tetanctietmepinon avulla..D1. on Q, :n:ogittaisderivaatta
ensimmiisen ja’ D2 toisen= operandin suhteen voimas-
saolevalla pinoindeksin K arvolla. Huom. q,:n ei
valttamattd tarvitse olla algoritmin A lopputulos.

Algoritmi L, osa 1.
L1. [Pinoindeksin alkuasetus.] I<—1.

B2. [Algoritmin A seuraava alkeistoimitus.] Jos al-
goritmi A on pdittynyt, algoritmin L osa 1 pddt-
tyy,—L12. Jos algoritmissa A otetaan k&ytttin
alkuarvo,-—-L3. Jos siind suoritetaan negatoin-
ti,—L4, jos yhteenlasku,--+L5, jos vahennyslas-
ku,—-L6, jos kertolasku,-»L7 ja jos jakolasku,
—L8. (Tami algoritmi ei huomioi muita toimituk-
sia, mutta algoritmia voidaan tarvittaessa laa-
jentaa.)


===== PAGE 30 =====
= OF =

L3. [Alkuarvo.] (Algoritmissa A otetaan kdyttdin
alkuarvo q;.) TYPE(I)<—1, VALUE(I)<q: ,—>L11.

L4. [Negatointi.] (Algoritmissa A 'q; = -@;'.)
TYPE(I)<-2, VALUE(I)<—-VALUE(QJ), —>L10.

L5. [Yhteenlasku.] (Algoritmissa A 'qi = q;+ax'-)
TYPE(I)<—3, VALUE(I) <¥ALUE(QJ)+VALUE(QK) ,—>L9.

L6. [Vahennyslasku.] (Algoritmissa A 'q: = aj;-a.'.)
TYPE(I)<4, VALUE(I)<-VALUE(QJ)-VALUE(QK) ,—>L9.

L7. [Kertolasku.] (Algoritmissa A ‘qi = qj;°q,'+)
TYPE(I)<-5, VALUE(I)<VALUE(QJ)*VALUE(QK) ,—>L9.

L8. [Jakolasku.] (Algoritmissa A 'q. = a; /ax'-)
TYPE(I)<—6, VALUE(I)<VALUE(QJ) /VALUE(QK) .—— >.

L9. [Linkki 2. operandiin.] OPER2(I)<QK.
L10. [Linkki 1. operandiin.] OPER1(I)+QJ.
L11.[Nimike kuntoon.] QI<-I, I<I+1,—>L2.

Algoritmi L, osa 2.

L12. (COEFF-kenttien alkuasetus.] Nollaa kenti&t
COEFF(K), K = 1,2,...,N-1. COEFF(N)<1, K<N.

L13.[Lyyppivalinta.] Mene askeleeseen LX, missd&
X = 13+TYPE(K).

L14. [Alkuarvo.] —»L21.

L15.[Negatointi.] COEFF(OPER1(K) )<—@O0EFF(OPER1(K) )
-COEFF(K), COEFF(K)«—O (koska negatointi on
tarkka toimitus), —L21.

L16. [Yhteenlasku.] Dim1, D2<-1, —>L20.
117. [Vahennyslasku.] Di<1, D2<— -1, —-L20.

L18.[Kertolasku.] D1<VALUE(OPER2(K)),
D2<-VALUE(OPER1(K)), —>L20.

L19.[Jakolasku.] D1<1/VALUE(OPER2(K)),
D2<— -VALUE(OPER1(K) ) /VALUE(OPER2(K) ) #*2.


===== PAGE 31 =====
- 28 -

L20. [COEFF-kenttien kisittely.|
COEFF(OPER1(K) )<—COEFF(OPER1(K))+D1#COEFF(K) ,
COEFF (OPER2(K) )<—-COEFF(OPER2(K) )+D2*COEFF(K) .

L21. [Indeksin vaihennys.) K<—-K-1. Jos K>0, —L13.

L22. [Sarjatyypin valinta.] (Jos halutaan (R,r)-sar-
jan kertoimet, algoritmi loppuu téhiin.)
COEFF (K)<—COEPF(K) #VALUE(K), K = 1,2,...,N.
(Jos halutaan (R,e)-sarjan kertoimet, algorit-
mi padttyy tahin.) COEFF (K)<—COEFF(K) /VALUE(N) ,
K = 1,2,...,N. Algoritmi L padttyy tahiin
(COEFF-kentissd on (E,e)-sarjan kertoimet).1

Algoritmia L vastaava FORTRAN IV - aliohjelmaryhmé

Ohjelmoitaessa algoritmia L IBM 7094:lle FORTRAN IV-
kielelld on algoritmiin viela tehty lisdys: mikéli
laskutoimitus on varmasti tarkka, se huomioidaan oh-
jelmassa vaihtamalla TYPE- kentin etumerkki miinuk-
seksi. TH1lléin tulevat kysymykseen tapaukset, joissa

- operaatio on negatointi (ei merkitysté, kos-
ka kerroin nollautuu joka tapauksessa)

- yhteen- tai vahennyslaskun operandi on nolla

- kertolaskun operandi tai jakaja on itseis-
arvoltaan yksi

- lopputuloksen arvo on nolla.

Timi tieto saattaa olla tarpeellinen miédrdéttiessd
kumulatiivisen pyéristysvirheen jakautumaa, koska
erdissd algoritmeissa (esimerkiksi matriisin kddn-
niésesi) nditi tapauksia on ratkaisevasti enemman
kuin satunnaisuuden perusteella voitaisiin olettaa.

Lis&ksi ohjelman avulla voidaan ‘mai#riti' tietty
laskutoimitus tarkaksi tai epitarkaksi, jolloin
edellé luetelluilla tapauksilla ei ole vaikutusta
TYPE-kentéin etumerkkiin.


===== PAGE 32 =====
- 29 -

FORTRAN-ohjelma on ryhmé aliohjelmia, jotka on
liitetty yhdeksi monihaaraiseksi function-aliohjel-
maksi, jotta tietuepinon tilanvarausta ei tarvitsi-
si midritelld uudelleen jokaisen algoritmin A al-
keistoimituksen aikana. Seuraavassa esitellaiin ta-
hain aliohjelmaryhmifn, ‘ryhméan L' kuuluvat alioh-
jelmat.

Nimikkeet QI, QJ, QK,ja QN ovat kokonaismuuttu-
jia. Eriised kutsuissa esiintyvélla kokonaismuut-
tujalla E ei ole merkitysté; sen arvoksi tilee nolla.

Ryhmiin L aliohjelmat

LBEGIN Kutsu: E = LBEGIN(VALUE,TYPE,OPER1,OPER2,

COEFF ,M)

Kutsun on esiinnyttavé pdaohjelmassa en-
nen muiden ryhmin L aliohjelmien kutsuja. Alioh-
jelmaryhmé saa tiedon taulukoiden VALUE(M) ,TYPE(M),
-+-,COEFF(M) sijainnista. Pinoindeksille I anne-
taan alkuarvo i.

TYPE, OPER1 ja OPER2 ovat piiiohjelmassa méari-
teltyja4 kokomais+, VALUE ja COEFF reaalilukutaulu-
koita. Kokonaisluku M ilmoittaa kaikkien taulukoi-
den ulottuvuuden.

LNAME Kuteu: QI = LNAME(VAL) ,

Kaikki algoritmin A alkuarvot on ilmoitet-
tava td1l4 kutsulla ryhmélle L. Alkuarvon, reaali-
luvun VAL, nimikkeeksi asetetaan QI. Aikwarvo: kat-
sotaan epitarkaksi, so. siihen liittyy pytristys-
virhe (TYPE(QI):ksi tulee +1).

LNAMEX Kutsu: QI = LNAMEX(VAL)
Kuten LNAME, mutta alkuarvo katsotaan tar-—
kakesi (TYPE(QI):ksi tulee -1).

LNEG Kutsu: QI = LNEG(QJ)
Muuttuja, jonka nimike on QJ, negatoidaan.
Negaation nimikkeeksi asetetaan QI.


===== PAGE 33 =====
- 30 -

LADD Kutsu: QI = LADD(QJ,QK)
Muuttujat, joiden nimikkeet ovat QJ ja QK,
lasketaan yhteen. Tuloksen nimike on QI.

LADDX Kuteu: QI = LADDX(Qd,QK)
Euten LADD, mutta laskutoimitus katsotaan
aina tarkaksi.

LADDN Kutsu: QI = LADDN(QJ,QK)
Kuten LADD, mutta laskutoimitus katsotaan
aina epditarkaksi.

LSUB Kuteu: QI = LSUB(QJ,QK)

Muuttuja, jonka nimike on QK, vaéhennetéan
mnuuttujasta, jonka nimike on QJ. Erotuksen nimike
on QI.

LSUBX Kutsu: QI = LSUBX(QJ,QK)
Kuten LSUB, mutta laskutoimitus katsotaan
aina tarkaksi.

LSUBN Kutesu: QI = LSUBN(QJ,QK)
Kifen LSUB, mutta laskutoimitus katsotaan
aina epdtarkaksi.

LMUL Kutsu: QI = LMUL(QJ,QK)
Muuttujat, joiden nimikkeet ovat QJ ja QK,
kerrotaan kesken#in. Tulon nimike on QI.

LMULX Kuteu: QI = LMULX(Qd,QK)
Kuten LMUL, mutta laskutoimitus katsotaan
aina tarkaksi.

LMULN Kutsu: QI = LMULN(QJ,QK)
Kuten LMUL, mutta laskutoimitus katsotaan
aina epitarkaksi.

LDIV Kutsu: QI = LDIV(QJ,QK)
Suoritetaan jakolasku. QJ on jaettavan,
QK jakajan ja QI osaméariin nimike.

LDIVX Kutsu: QI = LDIVX(Qd,QK)
Kuten LDIV, mutta laskutoimitus katsotaan
sina tarkaksi.


===== PAGE 34 =====
231 =

LDIVN Kutsu: QI = LDIVN(QJ,QK)
Kuten LDIV, mutta laskutoimitus katsotaan
aina epitarkaksi.

LEND Kutsu: K = LEND(QN)

Muuttujan, jonka nimike on QN, (R,r)-sar-
jan kertoimet lasketaan kenttiin COEFF(1) ,COEFF(2),
...,COEFF(QN). COEFF(QN+1) =...= COEFF(M) = 0.

LREL Kutsu: K = LREL(@OEFIC,M)

Edeltévised LEND-kiskyssé mainitun muuttu-
jan (nimike QN) (E,e)-sarjan kertoimet lasketaan
kenttiin COEFIC(1) ,COEFIC(2)5...,COEFIC(QN).

COEFIC on pédohjelmassa médritelty reaaliluku-
taulukko, jonka ulottuvuus on M. Voi olla myés
COEFIC = COEFF.

LABS Kutsu: K = LABS(COEFIC,M)
Kuten LREL, mutta COEFIC-taulukkoon tule-
vat (R,e)-sarjan kertoimet.
Jos LEND-kuta@wa seuraa,seki LREL- ett&# LABS-kut-
su, ei niisti ensimm¥iselle saa olla COEFIC = COEFF.

Itse aliohjelmaryhmit L on esitetty liitteessd.
Esimerkkind sen kiytiésté ohjelmoimme pienalgorit-
min a?-c? = (a+c)*(a-c). Olkoon muuttujan VA ar-
vo a ja muuttujan VC arvo c. Tdlldim saamme a*—-c':n
(E,e)-sarjan kertoimet kenttiin COEFF(1) ,COEFF(2),
-e+,COEFF(Q) esimerkiksi ohjelmalla

INTEGER 1(10) ,61(10) ,62(10) ,A,C,Q
REAL ¥(10) ,COEFF(10)
LBEGIN(V,T,01,02,COEFF,10)
LNAME(VA)

LNAME(VC)
LMUL(LADD(A,C) , LSUB(A,C))
LEND(Q) +LREL( COEFF, 10)

HOA rH
"


===== PAGE 35 =====
- 32 -

Aliohjelmaryhmin L muodostama rakenne arvoineen
ohjelman suorituksen jilkken on esitetty kuvassa 6,
kysymysmerkilld merkittyj& kenttid ohjelma ei ole
kasitellyt.

indeksi , V 10102COEFF, nimikkeet
10 [ ie] |
6 [ iL? ]
5
4 tit :
5 i ate Blt r| 4 Lf 1Q
2 Lec il? ? [-#e b-.-.---. Je

kuva 6

Yksikkijhdirién menetelma

Algoritmin L varjopuolena on, ett& sen kaytté
vaatii paljon muistitilaa, koska jokaiselle aigo-
ritmin vadlitulokselle on muodostettava oma tietu-
eensa. Tilan saéastimiseksi voidaan kaytt#a profes-
sori Tienarin esittiméd yksikkthiiritn menetelmad’',
joka puolestaan kaéyttaé& runsaasti enemmin koneaikaa,
koska algoritmi on t&lléin laskettava lipi kerran
futakin yksittiistaé pyéristysvirhettaé kohden. Yk-
sikkéhiirién menetelm4é varten ei voida luoda ryh-
mia L vastaavia yleisid aliohjelmia.

Yksikkthéirién menetelmin periaatteena on, ettd
algoritmin tuloksen 4G, ‘tarkka' arvo iasketaan kak-
sdibtarkkaa aritmetiikkaa kadytta#en, jolloin voidaan
asettaa yhtdlissd (5.2) E, = 0. Timin jilkeen an-
netaan vuorollaan kullekin yksittdiselle suhteel-
liselle pyjristysvirheelle suuruusluokkaa b‘ oleva
arvo. Kun algoritmi lasketaan 'vuorossa'oleva vir-


===== PAGE 36 =====
“ 33 =

he e; huomioon ottaen uudelleen lapi, saadaan tu-
lokseksi qi. Koska muut yksitt#iset virheet ovat
nollia, saamme yhtdlén (5.2) muotoon

Ey = OBniCi - (7.2)

Tiedimme, ettaé E, = (q*-aq,)/ax. Samoin tiedém-
me e,:n suuruuden, joten kaavan (7.2) perusteella
voimme ratkaista a,:n kaavasta

a,,= Uae (7.3)

Vastaavalla tavalla saadaan a, ratkaistuksi kai-
killa i:n arvoilla.

Esimerkkind yksikkthiirién menetelmisté ohjelmoin-
me jilleen pienalgoritmin a*-¢? = (atc)*(a-c). ER-
muuttujan arvona on suuruusluokkaa b™‘ oleva luku,
ja virhekertoimet tulevat muuttujien COEFF(1),...,
COEFF(5) arvoiksi (haluttaessa ne voitaisiin tulos-
taa heti kun kukin niisté& on laskettu). Taulukko
E ajatellaan valmiiksi nollatuksi.

REAL COEFF(5)
DOUBLE PRECISION A,C,QA,QC,QX,QN,E(5)
QX = (A+B) #(A-C)
QXER = QX*ER
DO 10 I = 1,5
E(I) = ER
QA = Aw(1.+E(1))
Qc = C#(1.4+E(2))
QN = (QA+QC)#(1.+E(3)) ®(QA-QC) #(1.+E(4)) #(1.+E(5))
COEFF(I) = (QN-QX)/QXER
10 E(I) = 0.

Algoritmin L ja yksikkéhiirién menetelmin anta-
mat tulokset ovat -likimain yhté tarkkoja tarkkuu- ~-
den véhentyess& laskutoimitusten lukumidrdn kasvaes-
aa. Mikili timi tarkkuus ei riitH#, voidaan algorit-
mi L ohjelmoida kiytt&miiin kaksOistarkkaa aritme-
tiikkaa, jolloin lasketut arvot ovat ratkaisevasti
tarkempia.


===== PAGE 37 =====
8. PIENALGORITMIT a*-c* :N LASKEMISEKSI

Esimerkkind pyéristysvirheen Taylor-sarjan kéy-
tosta pyrimme selvittémaain sen avulla, kumpi lau-
sekkeen a?-c* kahdesta mahdollisesta laskutavasta,

1. a@-c® = (atc) +(a-c) (8.1)
vai

2. a’-c = a-a-c-c (8.2)

on edullisempi.

Algoritmien yksinkertaisuuden vuoksi voimme las-
kea niiden Taylor-sarjat luvussa ‘5 esitetylld taval-
la. TH1lléin

1.  ((a*+e*)* +(a*-c*)* )*

{fa(t+e,)+c(1+e. )] (1+e,) [a(t+e,)-c(1+e.)] (1+e,)}(1+e,)
= a’-c*+2a"e,-207e,+(a°-0") e,4+(a-c')e,+(a’ -c)e, + (e*) (8.3)

(a- o*) (1+748re, ~zHie, +e, +0, +8 =+ (e*))

= (a-c)(14E,)

ja
2. ((a*sa*)* -(c* +e*)* )*
= {a(1+e,)a(1+e,)] (1+e,)-[e(1+e, )e(1+e,)] (1+e,)} (1+e,)
= a'—c" +2st0,-2c'e.48" e,-c"e, +( ac") e, +(e") (8.4)

(v- einem ~ ise. tae sxe, te, + (e*))
(ac) (14E,) * rs

miss& e, ja e. ovat alkuarvojen a ja c pyéristys-
virheit#, e,,e, ja e, tulon sek# e,,e, ja e, sum-
man tai erotuksen pyéristysvirheit#. Edelld (kuva 6)
totesimme tapauksessa i algoritmin L johtavan sa-
maan Taylor-kehitelmidn kuin (8.3).


===== PAGE 38 =====
= 35 -

Oletamme, ett |a|>le/, mik& ei ole oleellinen
rajoitus. Jos tarkastelemme suurimpia mahdollisia
virheit#, saamme

max(E,) = (arernaraor®) -max(e) , (8.5)
max(E,) ~ (2 +241) -max(e) , (8.6)

mised max(e) tarkoittaa suurinta mahdollista yksit-
taéistaé pyéristysvirhetta. Esimerkiksi pyéristivas-
si aritmetiikassa, jossa pytristykset suoritetaan
laskutoimituksen jailkeen, on yhtdléiden (3.17) ja
(4.3) perusteella max(e) = iub.

Yhtdltiden (8.5) ja (8.6) perusteella max(E,)<max(E,)
eli tapa 1 on edullisempi, kun

2|a? -c?| < a* +c* (8.7)

eli, koska |al>ici, kun
|S 8) <3 ~ 1.7302 . (8.8)

Jos pyrimme selvittdmiiin, kumpi laskutavoista
on suuremmalla todenniktéisyydell& edullinen, mei-
dain on tarkasteltava virheiden odotusarvoja ja va-
riansseja. Kaavojen (5.8) ja (5.9) perusteella

E(E, ) ba 2u,+2ust+py ’ (8.9)
E(E, ) = 2uatlst Ur 5 (8.10)
D(E,) = ete 6, +203 +07 (8.11)
D(E,) = ate i+ of +8 toot . (8.12)

Yksinkertaistamme tehtivdd olettamalla, ettd
aritmetiikka on pyéristivd, jolloin E(E,) =E(E,)=0.
Tapa 1 on tdlléin edullisempi, kun D(E,) < D(E,) eli

(a? -c7)*0; < 2a707a? “ (8.13)

Kun |al=lc| , on a*-c*= 0 ja tapa 1 on edullisem-


===== PAGE 39 =====
- 36 -

pi. Muulloin, ellei lal» lcl, onoj~o7. Talldin
tapa 1 on kaavan (8.13) mukaan edullisempi, mikali

Fe

- <j2+¥3 ~ 1.932 . (8.14)

Kun a:n ja c:n eksponenttien erotus on>t, on
(a*tce*)* =a* . (8.15)

Myés eksponenttien erotuksen arvolla t yhtélé
(8.15) on voimassa, kunhan c:n mantissan itseis-
arvo <4. Koska ain mantissan itseisarvo on kaa-
van (2.6) mukaan <1, voimme todeta yhta&lén (8.15)
olevan voimassa aina, jos

lal-

Laskutapa 1 supistuu siis télléin muotoon ara. Ta-
vassa 2 voimme vastaavasti korvata c:n nollalla,

ar
co

> a = 20. (8.16)

jos

Koska 2-b'>V2-b", kun b22 ja +21, riittéd ehto
(8.16) molemmissa tavoissa takaamaan, ettwi c:114
ole vaikutusta lopputulokseen. Kaavoissa (8.3)

ja (8.4) tHmi merkitsee, ett&é c,e,,e, ja e, voi-
daan korvata nollalla, jolloin laskutavat paéatyvat
samaan tulokseen eiki siis kumpikaan ole toistaan
edullisempi.

Saatujen tulosten testaamiseksi laskettiin a*-c*:n
arvoja satunnaisilla a:n ja c:n arvoilla. Tulosten
luetteloimiseksi ne jaettiin |a/c|:st& riippuviin
luokkiin, valilla [1,2) toiseksi merkitsevimmén ja
v4lilld [2,100000) merkitsevimman (desimaali)nume-
ron perusteella. Kussakin luokassa suoritettiin
noin 300 laskutoimitusta kummallakin tavalla. Kaik-


===== PAGE 40 =====
99008 e0gor 2009)

lore

Pars 008: gogo

sdugued Q49- gay oe
tdwased (3-6) «(2+8) ——

e) ~ 2

Iarel



===== PAGE 41 =====
- 38 -

ki laskutoimitukset suoritettiin binddériaritmetii-
kassa (b = 2) viidelld erilaisella numeroiden lu-
kumddrdlla (t = 5,10,15,20 ja 25).

Testin tulos on histogrammana kuvassa 7, jossa
abskissana on la/cl:n arvo ja oordinaattana prosent-
tinen osuus suoritetuista laskutoimituksista. Ehed
viiva ilmaisee, monessako prosentissa tapa 1 oli
parempi ja katkoviiva vastaavan prosenttimaédrin ta-
vasta 2. Lopuissa tapauksissa tuwlos oli molemmil-
la tavoilla laskettuna sama. j|a/c|:n edelld mai-
nitut arvot Y2-b” ja 2b° on merkitty histogrammei-
hin pystyviivoilla.

Voimme todeta tavan 1 todella olevan edullisem-
pi, kun |a/c!| <2. Mitd& lihempiind |al ja ic| ovat
toisiaan, sitd todenndkéisempad on, ettdé laskuta-
vat 1 ja 2 johtavat eri tukoksiin. Kun |a/cl > 2,
ei suoritetun testin perusteella voida sanoa, etti
tapa 2 olisi merkittdvasti parempi.

Samaan tulokseen piéitymisen todennikijisyys py-
syy |a/cl:n kasvaessa likimain vakiona aina rajaan
V2-b° asti. ‘Timdn jalkeen alkaa olla yhd todennd-
kéisempéd, ettd laskutavat antavat saman tuloksen.
Kuten kaavan (8.16) perusteella voitiin odottaa,
ei eriivid tuloksia saatu, kun |a/c| oli >2b*.


===== PAGE 42 =====
9. HORNER=SHEMA

Taylor-kehitelmin analyyttinen mé#rittiminen

Horner-shema on algoritmi, jolla lasketaan po-
lynomin

p =a, x"+a,x4 ... +a .x+a, » & #0, (9-1)

arvo pisteessd x. Se kirjoitetaan tavallisesti
muotoon [4]

qa.

q.
Kun hajoitamme algoritmin (9.2) yksittHisiin las-
kutoimituksiin, saamme sen muotoon

a.
Bn +KQn-1 5 Ww Tysewg ll «

(9.2)

Gor = Ao
Gna = ¥On-ve (9.3)
Gre = AntGns » Hoe Wgscaygl «

Sovellamme ta&hin algoritmiin analyyttisté4 menetel-
mia kumulatiivisen pyéristysvirheen Taylor-sar jan
kertoimien laskemiseksi.

Kaavan (6.12) perusteella saamme

(a)

Rae = QninX@, +XReiatQni@ns
(9.4)

a

Raa

(oh)
a,e, FRB tQuOn2 Ly

missa e, on x:n ja e, a,:n pyéristysvirhe sekad e,,
ja e,.n:nnen iteraatiokierroksen kerto- ja yhteen-
laskun pyéristysvirheet.


===== PAGE 43 =====
= 40 =

Sijoittamalla yht&ltisté (9.4) edellinen jalkin-
maiseen saamme ensimmdisen asteen differenssiyh-
tilon

RO, = ER st Qe Or +n On $XQnisOntGisenr » (9.5)
jonka alkuarvona on Ro. = ae, eli a,:n absoluutti-
nen pyéristysvirhe.

Muotoa

X, = OX.tb, » Ko = Do (9.6)
olevan differenssiyht#lin ratkaisu on [4]
x, = fab; , (9.7)

joten saamme differenssiyhtdlin (9.5) ratkaisuksi

@

Raa = frat: +) x'age; +P x" qe. (9.8)
Z i ist
+fx™gir@is ’ Te: DQiprevacerg ll os
ad

Vastaavasti saadaan

a)
Run = XQo.0,+XAe Co +XQo.€14
a)

isa

i +P x"'G. 20 ‘ NE QyewegN «
Tarkastelemme erityisesti algoritmin lopputulok-

sen p = q,, pybristysvirhettad R,,. Otamme ki#yttéin
nerkinnat

ol; = xa,
i

pie Dou

5 (9.10)
yee ECR a)o5

Merkinndlld :, takoitamme siis polymomin p (N-i):nnen
asteen termid ja 4;,:114 (N-i):nnen ja sit& korkeam-
man asteen termien summaa. Kun toteamme, ettd

a..=ajx” , (9.11)
Je
saamme £;:lle myés lausekkeen

fi = xq, . (9.12)


===== PAGE 44 =====
-~41-

Erityisesti
Px = Ps (9.13)
Polynomin p derivaatan p' arvo on
p! = Na,x"+(N-1)a,x"+ ... +2a,.x48,,. (9.14)

Huomaamme, ett& y, on polynomin xp' (N-i):nnen ja
sit& korkeamman asteen termien summa, erityisesti

yx = xp! . (9.15)

Voimme lausua y,:n myés muodossa
yi= L(W-i)oy+2 (1-3) = (W-i)p; +2; » (9-16)
re pe Fe
erityisesti
h-t

Y= Vou = 2 fi = Tegra (9-17)

Saamme yhtdlén (9.8) yhtaéloiden (9.10), (9.12)
ja (9.17) avulla muotoon

a

Rus= Vues +} oe: 4] peseirtd pilin » N22, (9.18)

josta yhtdlén (6.4) perusteella saamme polynomin p
(E,e)-sarjaksi

@) Ny. N a
Eva = He, +) Se, +} Ae] Bier. , N22. (9.19)

Kaavojen (5.8) ja (5.9) mukaan saamme E., :n odotus-
arvon ja varianssin muotoon

E(Eq,) = L(y, tpoi)us +h Fas +} Ae i (9.20)
Lo Let wt

ae) _ Ay? Faye ft Batt Big?

DUEL) = Blin +08 Jor +2. Ost) Leos « (9.21)

Kun oletamme alkuarvot tarkoiksi ja laskutoimi-
tukset suoritettavaksi kiintefin pilkun aritmetiik-
kaa kdyttaen, jolloin yhteenlaskut ovat tarkkoja,


===== PAGE 45 =====
= 42 <

on yhtéléss& (9.18) e, =e; =e:.= 0, i = 0,...,N.
Kaavojen (6.17) ja (9.12) perusteella saamme yhti-
lén (9.18) t8116in muotoon

R® = Ese ais = fx" “ques = = Le Piss ( 9. 22)

7 =A

miki on Hamaikwin Henricin saama tulos. [4].

Toisen asteen kertoimet

Myts toisen asteen kertoimet Horner-sheman kumu-
latiivisen pyéristysvirheen Taylor-kehitelmissa
voidaan johtaa analyyttisesti. Kaavojen (6.13) ja
(9.3) perusteella

@ @) @y @
na = Oper OFKR yc 2t$KO, Rar st Qn Kx Cp pARR ic 2€n4

@)
Ry.

i

12) O) 9.21)
1*04+1-°R,,40+8,,€, @,.4R,€.0 «

tt

Sijoittamalla ensimméisen yht&élin toiseen saamme
ensimméisen asteen differenssiyhtélin

@) @) (ay a)
. = XR,,.+Ke, Root KQ,.@. Cn tRR as

22

Alkuarvon Ro. = 0 avulla saamme sen ratkaisuksi

R., R., =Lx"e, Ro - ath gins, Cit) xR nis , ;
it 9 . 23
+hxva: e,e; tPx"Re., ¢ RE leeeegT «

ted

Sijoittamalla t&hiin yhtdléén kaavojen (9.8) ja
(9.9) tulokset saamme

@)

Rw. = a,x"e,(e, +€,,) six Qj-ns€s tLx8; e;

tsa

+) xa ;...€; ete “Gjn@ja) (On His) HP 2 Qises Ci.

A

+hx” ‘ave, ee tda ae +p aje; (9.24)
ge

tix Gj-128)4) e+) Fx"'x'q;1)12.ss

wa jet

He SisceeN «


===== PAGE 46 =====
mar Sa

Erityisesti kaavojen (9.10) ja (9.12) perusteella

RR. = %@, (e, +e,,) LL Pin®x +) je; +L esto pjeir) (e. +4.)
m! gut Jee Jt? 4

ah puts et] m0: eth (2 Aut tha e; (9.25)
= a4 bet jee ro

+p.) eth t as Cnrein «
Kaavan
Efe, = LOH-3)¢; (9.26)
avulla saamme yhtilin (9.25) muotoon

Re. = ) (W-J)g-10.€ +L OW-3) e.8; + [(N=4) p:.

J4

+P piles euth [(N=1) A: +E Plex Gis
Jt “4 i

int N ist r
+h Toei Cpt?) Kjej Cit) Lie Cin (9.27)
ied jee tet jr0 wi
nw in tot nwt
+) Lp.0i.8), +f Feet [pe Oia
Mid
+L L pitts ‘ Ne2.
hea fed

Kaavan (9.10) perusteella

n=4 ne

LOt-3)p4 = i

Yon-3)o., = Ps(n-k-1) (N-k)ol,

= ix’p"

(9.28)

mised p" on polynomin p toinen derivaatta pistees-
sa x. Kun vield kiytimme kaavoja (9.16) ja (6.4),
saamme ;

a Aen ; ~4)% FR ; "
E; Bpr P"e.e, +E(m J)Fe- ej +Pie.0.,4] Be, &..

oaE 8; Lig e; ot) Tie. ei (9 . 29)

2p

“LU 0.0.4) [8 84.0.. aI) @..8j.2 t) Nz2.


===== PAGE 47 =====
- 44 -

Kaavojen (9.19) ja (9.29) antamat tulokset p:n
(E,e)-sarjan ensimmiisen ja toisen asteen kertoi-
mille on esitetty alla olevassa taulukossa, kun
polynomin asteluku N21.

tekija kerroinsp | ehto tekijin | ao. termien
indekseille lukumiira

8, Yn - 1
e; Obi 170 N+1
Cin Piva i-1 N
Cir Pi 1:1 N
ey ey 4x7p" - 1 (0, jos N=1)
ex ei (N-i)o: 1:0 N+1
e, ein ies ie-1 N
@. ei, Yi i=1 N
e. ej, mi, j>iz0 4(N* +N)
@..ej.2 ad je taii-je1 3(N* +3)
G18). Pir j>i21 4(N°-5)
48; Aj i>je1 4(N*-N)
G:18j2 [ries jzeiet 3(8? +5)
2,285.2 pi 9 ef. 2" 3(N* -N)

Voimme todeta ensimmaisen asteen termeja olevan
kaikkiaann3N+2 ja toisen asteen termeji 3N°+4N+2
kappaletta eli toisen asteen termien lukumdédra on
suurilla N:n arvoilla noin N-kertainen verrattuna
ensimmdisen asteen termien lukuméérdin.

Ensimméisen ja toisen asteen kertoimet edustavat
samaa suuruusluokkaa, mutta e* on suuruusluokkaa
be. Jotta toisen asteen termien vaikutus olisi
samaa suuruusluokkaa kuin ensimmdisen asteen ter-
mien, olisi siis N:n oltava suuruusluokkaa b’.
TH#lléin pySristysvirfeet ovat kuitenkin niin suu-
ria, ettei polynomin arvon laskeminen t numeron
tarkkuudella yleens& en#& ole mielekiisté tuloksen
epitarkkuuden johdosta.



===== PAGE 48 =====
= 45 -

Esimerkkind mainitusta epitarkkuudesta tarkas-
telemme polynomia p = x", missi N = b°. Koska
a, =1 jaa: =0, i= 1,.--,N, on e,,= 9 Je
@, = @i2= 0, i = 1,...,N. Kaavojen (9.20), (3.23)
ja (4.9) perusteella on Bun odotusarvo katkaise-
vassa aritmetiikassa

wy

uti-b) — 1-b
= 2N a =Thb*

Toisistaan riippumattomien satunnaismuuttujien ¢
ja 7 tulon odotusarvolle voimassa olevan yhtdlin [2]

EG”) = E(S)E() (9.30)

avulla saamme Belin odotusarvoksi katkaisevassa arit-
netiikassa

B(Ea) = 2(ix*ptest) petals +L 2 6.u")
i
Pp

(ax? N(N=1) ute (9-1) Na pay, +2 ED) 2)
2[u(1-b I 1f1-pv
~ 2s Biel ' i ™ 3/5) .

Alla olevaan taulukkoon on laskettu saatujen
odotusarvojen arvoja kantaluvun vaihdellessa.

b| ECE E(B
2| -1.44 1.04
8) -3.37 5.67
10 | =3.91 7.64
16| -5.41 14.6
64 -15.1 | 115

Kuten odotimme, edustavat E(E.,) ja E(E.,) samaa suu-
ruusluokkaa, ja niiden arvot ovat niin suuria, et-
ta virheen odotusarvo varsinkin suurilla kantalu-
vun arvoilla on moninkertainen itse polynomin ar-
voon verrattuna.


===== PAGE 49 =====
= 46 =

Polynomille p = x", missd N = ib’, saamme vas-
taavaksi taulukoksi

bd | ECE.) | E(Ex:
2 -0.36 0.07
8 -0.21 0.022
10 -0.19 0.019
16 -0.17 0.014
64 -0.12 0.0045

Toisen asteen termien vaikutus on jo selvisti en-
simmdisen asteen termien vaikutusta pienempi, mut-
ta virheen odotusarvo on viel& varsin suuri.

Saatu tulos vahvistaa yhtdléssé (5.4) esitettyi
kasityst&é, jonka mukaan toisen ja korkeamman asteen
termeilld ei ole kiytinnissd merkitysta kumulatii-
vista pytristysvirhetté tarkasteltaessa.

Nollakohtien lahekkdisyyden vaikutus kertoimiin

On tunnettua, ett& polynomin nollakohtien suh-
teellinen lahekk&isyys vaikuttaa heikentd&vdsti po-
lynomin arvon laskutarkkuuteen. Tutkimme seuraa-
vassa titdé ilmisété Taylor-kehitelmin (9.19) kertoi-
mien avulla.

Polynomin p (9.1) kerroin a; voidaan lausua nol-
lakohtien 2;, j = 1,-.-,N, avulla muodossa

i K
a. = a,(-1) D(z, 2,°+° Bide Le 1yece gH, (9.51)
drt

missdi summattavien tulojen tekijéind ovat kaikki
mahdolliset i nollakohdan kombinaatiot, jolloin
K = N!/(i!(MN-1)!).

Tarkastelemme nyt polynomia p, jonka nollakoh-
dat ovat Z) = 2;4+M, jJ = 1,...,N, ja jolle

B(x). = p(x+M) = p(x) . (9.32)


===== PAGE 50 =====
wd] «

Talléin
p(x) = a,[(x+M)-(2,4M)] +++ [(x+M)-(2,,4™)]
- = (9.33)
= A, (xen,)+++(x-2,) = Sb(x) '
joten
a. =a, (9.34)

ja kaavan (9.31) mukaan
Bi-= a.(-1) Fl(s,4M)+--(a,4M)] (9.35)
rt

Kun M kasvaa itseisarvoltaan riittiviin isoksi, ovat
%):t, ¥ ja M samanmerkkisid. |M|:n kasvaessa edel-
leen kasvaa myts

” se esi nei
|S = ae |= lad ( ere a, +Ml)ixeMl (9.356)
4 = 1,...,N, sekaé |%/pl= |a,||x+Ml"/Ipl .

Summan ja sen suurimman jdsenen itseisarvot
edustavat yleensi samaa suuruusluokkaa, joten voim-
me odottaa myts |A:/plin ja \ji/plen ja siis kaik-
kien E“:n lausekkeessa (9.19) esiintyvien kertoi-
mien kasvavan |M|l:n kasvaessa.

Nollakohtien arvot lahestyvdt toisiaan suhteel-
lisesti |M/:n suuretessa, mutta myts |x:t kaevavat,
joten on syyté tarkastella nollakohtien origosta
mitattujen absoluuttisten et&isyyksien vaikutusta
kertoimiin.

Ajattelemme kaikkien x-koordinaattien tulevan
kerrotuksi kertoimella k y-koordinaattien pysyes-
sa ennallaan. T4&lléin polynomia p vastaa polynomi
Pp, jolle

B(x) = p(kx) = p(x) . (9.37)
Yhtdlén (9.31) mukaan

A

a, = 4, (-1) Eee, + + ee) = Bia, 1= 1,26. 5H, (9.38)


===== PAGE 51 =====
- 48 -

Té#11l6in

6(&) = fa.s' =) Sexi a, kUx™ = ak p(x), (9.39)

joten yhtdléiden (9.37) ja (9.38) perusteella

a; = ka, go Se = Ofewegl » (9.40)
Edelleen

be a.x"* as ka. Kx" =

3 a i D (9.41)

ja yht&léiden (9.10) perusteella myts A/p=(/p- ja
Wb = ye, 1 = 0,...,N. Kaikki E :n kertoimet pysy-
vit siis ennallaan mielivaltaisella k:n arvolla.
Myéekd#iin y-koordinaattien kertominen vakioarvol-
la x-koordinaattien pysyessd ennallaan ei vaikuta
Euin kertoimiin, silld kp(x) = ka,(x-z,)°**(x-z,)
eli timi kertominen voidaan samaistaa a,in kerto-
miseen vakioarvolla. Voimme helposti todeta, etta

(9.42)

on riippumaton a, :sta.

Edelld saatujen tulosten perusteella Ei\:n ker-
toimet maardytyvaét yksinomaan x:n ja nollakohtien
arvojen suhteista toisiinsa. kuNohlakohtien:olles-<<~
seveamanmerkkisid Jjarldhestyessd:.toibieanyvkasva+—
yatckertoimet-yleensé itseisanvoltaan.

Tarkastellessamme tietyn polynomin p eri pistei-
té ovat erityisen mielenkiintoisia polynomin nol-
lakohtien ohella |x|:n eritté&in suuret arvot seki
piste x = 0. Yleisen&é huomiona voidaan todeta,
etté e..2n kerroin ¢./p on aina yksi.

Jos a; ei ole nolla, %“/p (i = 0,...,N) kasvaa
rajatta x:n lahestyess& polynomin nollakohtaa. Sa-
malla yleensé myts (i/p ja yi/p kasvavat rajatta.


===== PAGE 52 =====
= 49 «

Kun |x| kasvaa rajatta, ~/p—>1 ja o/p —>0,
i= 1,...,N, joten

N il
Lim Ey, = Ne, +e, +7¢.t/e:.. (9.43)
i ied

ja kertoimet riippuvat siis ainoastaan polynomin
asteluvusta.

Jos a, # 0 jaa; = 0, j>k, niin x:n laéhestyes-
si nollaa o“,/p—»1 ja ~%j/p—-0, j Ak. Kun otam-
me huomioon, etti tilltin ej. =00, j>k, smamme

lim E., = (W-k)e, +e, +Fe:. » (9.44)

iske4

joten kertoimet riippuvat yainneatebuvusta ja in-
deksin k arvosta. Tapaus k = 0, jolloin p = a,x",
on erityisen huomion arvoinen. T4&lliéin E :n lau-
seke on xin arvosta riippumatta muotoa

EN. = Ne, +e, +hei. . (9.45)

isd

Nollakohtien lihekki#isyyden vaikutusta tutkit-
tiin kokeellisesti kolmannen asteen polynomin avul-
la, jonka alkuperiiset nol-

lakohdat olivat vHliltd Lin
(-5,5) valitut satunnaiset lee
pisteet Leo
Zz, = -4.0467951 0
Zz, = 0.54756939 _
Z, = 1.9969324 40

a
3

ja alkuperHinen a,
a, = 3.9603187 . ad
Alkuperfiselle polyno- a

io 4 a 3 4 bl
Xo %
mille (kuva 8) suoritettiin NA

yhtilin (9.32) mukainen “20
siirto, kun M sai arvot 2", ~

mM = -7,-6,..+,6,7- Kulla-

kin m:n arvolla laskettiin polynomin kertoimet a, jn
a, ja a, kiytt#en kaavaan (9.31) perustuvaa kertoi-
mienlaskualgoritmia K.

kuva 8


===== PAGE 53 =====
- 50 -

Algoritmi K (Polynomin kertoimien lasku). Algorit-
mi laskee N:nnen asteen polynomin p = a.x"+a,x'"'+...
+a,x+a,kertoimet a.:n ja nollakohtien 2,, ZayeeeyZy
avulla kdyttHen apuvektoria 5,, Siyeee, Bye

K1. [Alkuasetukset.] s,—2,, i = 1,...,N, sign<«-1,

ii.

mele

K2. [Kertoimen a; lasku.] a, <a, seigne] 8; .

K3. [Seuraava kerroin.) Jos i = N, algoritmi pHit-
tyy. Muuten sigi«-sign, i«i+1, j<1.

K4. [Apuvektorin téyttd.] s)+-2;*/ 5,. Jos j=N-i+1,
kejet
—K2, muuten jej+i, —K4.1 ;

Saaduille polynomeille suoritettiin myjés yhtdlin
(9.37) mukainen supistus siten, ettd satunnainen
piste x, = 1.0768227 pysyi paitkoijiaan kaikilla m:n
arvoilla. T&lléin k sai kullakin M:n arvolla ar-
von x,/(x.+M).

Taylor-sarjan (9.19) kertoimia tutkittiin useil-
la eri x:n arvoilla, joille polynomin siirtyessa
suoritettiin vastaavat siirrot. Suoritettu supis-

tus ei odotusten mukaisesti vaikuttanut kertoimiin.
Log elkerroin! Logelkerroint

a |

kuva 9a kuva 9b

Kuvissa 9a ja 9b ndhddiin kertoimien itseisarvo-
jen logaritmit tekijéittdin pisteessa4 x, m:n vaih-
dellessa -7:st& 7:dHn. Nollakohtien ollessa eri-
merkkisid eivit kertoimet muutu oleellisesti. Kaik-
ki nollakohdat tulevat samanmerkkisiksi suunnil-


===== PAGE 54 =====
« 5 =

H Logsalkerroin| et leen m:n arvolla kaksi, jol-

. rd loin M = 4, ja alkavat td-
min jailkeen laéhestyd& toisi-
aan suhteellisesti, jolloin
kertoimien itseisarvot al-
kavat odotusten mukaan kas-

a vaa voimakkaasti. Eréiden
kertoimien etumerkki vaih-
tui tarkastelun kuluessa.

be Kuvissa 9 merkitsee ehyt
I viiva positiivista ja kat-
ana ae nee

™ koviiva negetiivista ker-
rointa.

Kuvassa 10 on vastaavas-
ti yht&ldéiden (9.20) ja (9.21) m&&rittémien E,.:n
odotusarvon ja varianssin lausekkeiden kertoimet,
jotka antavat kokonaiskuvan nollakohtien tiivisty-
misen vaikutuksesta Hornereéheman kumulatiiviseen
pytristysvirheeseen.

Myés muissa tarkastelluissa pisteissd olivat tu-
lokset vastaavanlaisia. Tosin kertoimet alkoivat
kasvaa pienintd nollakohtaa pienemmilla& x:n arvoil-
la vasta ndidenkin muuttuessa lisdyksen M vaikutuk-
sesta positiivisikei. Tdmd olikin yht&lén (9.36)
mukaan edellytyksend kertoimien kasvulle.

Vastaava koe suoritettiin my6s viidennentoista
asteen polynomilla, mutta laskentatarkkuus ei riit-
tanyt luotettavien arvojen saamiseen kertoimille.
Esimerkkind mainittakoon, ett# nollakohtien olles-
sa lihekkiimmilladin (m = 7) saatiin polynomin ar-
vokei sen eriiissd nollakohdassa 4.2-10°. Tdmakin
tosin omalla tavallaan osoittaa, etté# pytristysvir-
heet kasvavat voimakkaasti nollakohtien lihestyes-
8H toisiaan.

on De a e © SF FH

cy
Lo ied

z
FES

4

kuva 10


===== PAGE 55 =====
10. MATRIISIN KAAWTO

Kdinnettiessdé m-m-matriisi Gauss-Jordanin mene-
telmd114 [7] otetaan kiyttitn apumatriisina m«m-yk-
sikkimatriisi. Nima kaksi matriisia yhdessd muo-
dostavat m«2m-matriisin

fa) oe tw): tl [el
By Bye ee Bim Gime ee. Brom

. te] To} fo) | tea 5 tel
(A IT) x Bx B@uees Ban Baumer eel Boom

: £10.1)

a Bene ee alae. . ie anu,
mised ai) = a,, kun jsm, ay = 1, kun i = j-m ja

ai; = O muulloin. ;
Matriisin kd#nts tapahtuu algoritmin

Be et

a, = aj;- sea; , 1 = 1,...,m, i xk,
Bice j = k+1,...,k+m,
ea k= Typece st (10.2)
a, = 24, 1 = 1,...,m
bd j = m+1,...,2m

avulla. Mik#li k:nnella iteraatiokierroksella
ayj:lle ei lasketa uutta arvoa, on ay = ay. TAlldin
saamme kiiinteismatriisiksi

inetd
Oe Bees: Bice
-1
Aée= |: : . (10.3)
° ° .
Imett tmead twee

ronet Emmere © © Eni

Alkioiden indeksointi jirjestystd sopivasti vaihta-
malla on mahdollista suorittaa kHintdminen tehok-

kaammin, so. saada tulos tarkemmaksi. Seuraavas-

sa tarkastelussa titd ei ole otettu huomioon.


===== PAGE 56 =====
- 53 -

Kun hajoitamme algoritmin (10.2) yksittdisiin
laskutoimituksiin, saamme sen muotoon

aj = ay, d=1,...,m, j=1,...,2m

Qs = a/ecn”
J [e-1]

qi. = dios Bi

ja va pet ot (U=K+1 yee ktm

Qijs = ai if =Qijo

ay” = dy"=al)/ay i=t,...,m, j=me1,...,2m

)

i=1,...,m,ifk,

k=1,...,m C164)

jossa q:n indekseista ensimmainen osoittaa rivid,
toinen saraketta ja kolmas laskutoimituksen vaihet-
ta. Kuhunkin q:hun liittyy taésmilleen yksi yksit-
tdinen pytristysvirhe. Pytristysvirheiden lukumdéd-
réksi saamme tyypeitti#in

tyyppi lukumiéra
ety m-2m
» Chon (m-1) -m
eta (m-1) -m-m
ens (m=1) «m-m
ey” nen .

Kaikkiaan pytristysvirheité ja samella ensinmaisen-
asteen_termejé kumulatiivisen pytristysevirheen Tay-
lor-kehitelmissd4 on 2m*+2m’-m kappaletta.
Taylor-kehitelmin kertoimien analyyttinen mid-
rittiminen kullekin kiiaénteismatriisin alkiolle on
algoritmin (10.4) laajuuden johdosta varsin hanka-
laa, mutta kokeellisissa tarkasteluissa voidaan
kdyttaéé esimerkiksi kertoimienlaskualgoritmia L.
Esimerkiksi 10«10-matriisin arvojen ollessa valmii-
na VA-taulukossa saamme alkion 2.7 (E,e)-sarjan
taulukkoon C1 sek alkion 7.2 (E,e)-sarjan tauluk-
koon C2 ja (R,e)-sarjan taulukkoon €3 ohjelmalla

C MAARTTTELYT
REAL VA(10,10) ,¥(2200) ,¢1( 2200)
REAL €2(2200) ,C3(2200)
INTEGER A(10,10) ,2(2200) ,61(2200) ,62(2200) ,Q


===== PAGE 57 =====
= 5G

C ALKUARVOT
I=LBEGIN(V,1,01,02,C03, 2200)
DO.30 I=1,10
DO 10 J=1,10
10 A(I,d) =LNAME(VA(I,d))
DO 130) d=11, 20%
VAL=0.
IF(J-I-10) 30,20,30
' 20 VAL=1.
30 A(I,d)=LNAMEX(VAL)
C IMTERAATIOKIERROKSET 1...10
DO 50 K=1,10
DO 50 I=1,10
IF(I-K) 40,50,40
40 Q=LDIV(A(I,K) ,A(K,K))
DO 50 L=1,10
J=K+L
50 CONTINUE
C IMERAATIOKIERROS. 11
DO 60 I=1,10
DO 60 J=11,20
60 A(I,dJ)=LDIV(A(I,d) ,A(I,I))
C KERTOIMIEN LASKU
IT=LEND(A(2,17))+LREL(C1, 2200)
I=LEND(A(7,12) ) #LREL(C2, 2200) +LABS (C3 , 2200)

Yksitt#isten pytristysvirheiden lukum#drd kas-
vaa niin voimakkaasti matriisin ulottuvuuden kasva-
essa, ett algoritmi L on sovellettava kaiyttamdin
tukimuisteja, mikdli sit# aiotaan kdyttdéd suurials
Matriiseja kHtinnettHessH.

Algoritmia L hyviksi kiyttien laskettiin (E,e)-
sarjat symmetrisen 5«5-matriisin A = (a) kdunteis-
matriisin alkioille. Matriisin A satunnaislukual-
kiot olivat neljan desimaalinumeron tarkkuudella


===== PAGE 58 =====
= 55 -

0.5758 -0.1035 -0.0824 0.1051 -0.2077|
-0.1035 0.2601 -0.0850 -0.1125 0.2108

A = |-0.0824 -020850 0.3935 0.0737 -0.1073| .
0.1051 -0.1125 0.0737 0.3049 -0.1401
-0.2077 0.2108 -0.1073 -0.1401 0.3595

Kddnteiematriisikei A’ = (c;) saatiin

2.5555 -0.2655 1.0407 -0.4111 1.7821)
-0.2655 7.6127 0.2779 0.9140 -4.1777

A’ =| 1.0407 0.2779 3.2415 -0.4788 1.2193] .
-0.4111 0.9140 -0.4788 4.2070 0.7235
1.7821 -4.1777 1.2193 -0.7235 6.9063)

Saatujen Taylor-kehitelmien suurimmat kertoimet
olivat alkion c,, sarjassa virheen e2, (eli alkuarvon
a,, pydristysvirheen) seki alkion c,, sarjassa virheen
e°, (eli alkuarvon a,, pyéristysvirheen) kertoimet.
N&iden molempien arvo oli 10.7718. Noin kaksi kol-
masosaa kaikista kertoimista oli nollia.

Kokonaiskuvan saaminen yksittdisten kertoimien
perusteella on niiden lukuisuuden vuoksi varsin vai-
keaa. Tiassa suhteessa saamme paremman kisityksen
yhtdéléiden (5.8) ja (5.9) antamien keskiarvon ja va-
rianssin kertoimien avulla. T4ll&in on syyt& huo-
mioida, ett& mahdollisista virheldhteist& on m* kap-
paletta tarkkoja alkuarvoja (yksikkimatriisin al-
kiot), m-+(m-1) kappaletta muotoa O-qij. olevia ja
siten tarkkoja vihennyslaskuja geki m-(m-1) kap-
paletta muotoa qiu-l olevia tarkkoja kertolaskuja.
Néita alkuarvoja ja laskutoimituksia vastaavat yk-
sittdiset pytristysvirheet ovat nollia, joten nii-
den kertoimet, yhteens&# 3m*-2m kappaletta, on syytd
poistaa keskiarvon ja varianssin lausekkeita las-
kettaessa. Thin on varauduttu aliohjelmaryhmissi
L (vastaavat TYPE-kentdét ovat negatiivisia).


===== PAGE 59 =====
= 56 -

Esimerkkimatriisille A“ saatiin odotusarvojen
lausekkeiden kertoimiksi kahden desimaalin tarkkuu-
della, kun mainitut poistot oli suoritettu (kertoi-
met tekijéittdin jarjestyksessé 4/Us/-r)

-100/'3.68/2.52 — ~4.09/2.00/12.68 -1.00/'1.00/3.81  -1.09/0.00/3.18 ~1.00/-.00/8.65
-100/2.00/f2.8 — -s00/s.54f295  -r.00fo.0ofs3s  -1.00f-1.00/2.79 -1.00f-2.00/5.67
«! 1.00/1.00/3%1 -4.00/0. 00 //3.38 -1.00f 0.03/' aay -1.00f-2.00/2 48 -1.00//-.00/3:36
-1.00/0.00/5.18 — -1.00f-4.00f/279  -1.00/.2.00/2.48 -1.00f/2.09/4.23 -100f4.00f2.23
-1.00/-1.00/3.05  -400f19.00/3.67  -.00f-s.00fa36 -1.00f¢4.00f223 — -1.00f.4.00/293 |

Vastaavat varianssien lausekkeiden kertoimet olivat
tekijéittéin jarjestyksessi 03/0; /0;

aat/'s.s4 fia see.t4foren fr9.06 are /ess fr 2sifien fras 1430/4454 [440
seesnforexa fae. esa fiss/i9s  wreyherrofism  sa.ca/21.cofe.00 10.24 /18.07/4.4
sr6fo.51 /2A4 aoutghersofissas 196/434 fice 12.95 hans [5% tea6/2074 /4.28
naifen fiser. 32.09/r9.coftecs saasfew/e0o  1.02/462/1.05 — 56.10/a.m fred
sifu far wsifeorfim  ercfhorfisr seiefanss fost  0.59/2.65 /278 |,

Edella& esitetyistH# matriiseista voidaan tehdd
mielenkiintoisia havaintoja:

- Kaikki kertoimet orsn kertoimia lukuunotta-
matta ovat symmetrisid (so. cyj:n tietty
kerroin on sama kuin cin vastaava kerroin).

- @m kertoimet yldkolmiossa ovat pienempiad
kuin symmetriset kertoimet alakolmiossa
(paitei cin o?:n kerroin), joten muiden
kertoimien yhtdsuuruudesta johtuen ylékol-
mioon lasketut k#inteismatriisin alkiot ovat
tarkempia kuin alakolmioon lasketut.

- Varianssin kerroinmatriisin kerrointen suu-
ruusluokka on pé#ldvistéjdlld4 pienempi kuin
muualla, so. pdédlivistijim alkioiden arvot
ovat tarkempia kuin muiden alkioiden.

- etn kertoimien arvo alkioissa cj, i # j,
on m-i-j (m = 5) sekd alkiossa cm m-—-1.

- Kaikkien #,.:n kertoimien arvo on -1.


===== PAGE 60 =====
= ‘57 =

Jaitaén tassé esityksessé avoimeksi, ovatko nami
havainnot sattumia, vain kdsiteltyyn matriisiin liit-
tyvid, vai voidaanko vastaavia havaintoja tehdé ylei-
sesti. Odotusarvomatriisia koskevat havainnot voi-
daan yleist#& ainakin mielivaltaiselle 2«2-matriisil-
le, silld till$in saadaan odotusarvomatriisiksi

-1/25 ‘A eee ier =17 =1 / 2esBu
wif <a / oye =1/ 44 /1 42828

missd D = a,,a,,—-8.8,0n ko. matriisin determinantti.



===== PAGE 61 =====
- 58 -

Liite: ALGORITMI L FORTRAN IV-OHJELMANA

algoritmin ds
askel

c
Li c FUNCTION SUBPROGRAM GROUP L
c

INTEGER FUNCTION QI
ENTRY LBEGIN (VALUE, TYPE,OPER1,OPER2,COEFF,M)
INTEGER TYPE, OPER1,OPER2,QJ,QK,QN,EX
DIMENSION YALUR(M) »TYPA(H) ,OPER1(H) .CPER2(H)
DIMENS ION COEFF (M

=0

QI=0
I=1
RETURN

INITIAL VALUES

ENTRY LNAME(VAL)
TYPE(I)=1

10 VALUE(I)=VAL
GO TO 66
ENTRY LNAMEX(VAL)
TYPE(I)=-1
GO TO 10

NEGATION

ENTRY LNEG(QJ)
TYPE(I) =-2
VALUE(I) =-VALUE(QJ)
GO 76 65

ADDITION

ENTRY L&BD(QJ,QK)

IF(VALUE 93}} 20,21,20
20 IF(VALUE(QK)) 22,21,22
21 EX=1
22 TYPE(I)=3

VALUE (I) =VALUE(QJ) +VALUE(QK)

GO TO 60

ENTRY LADDX(QJ,QK)

GO TO 21

ENTRY LADDN(QJ,QK)

EX=-1

GO TO 22

L3

aaa

14

aaa

L5

aaa


===== PAGE 62 =====
L6

L7

L8

Lg

L10
L11

aaa

aaa

aaa

30
31
32

40
41
42

50
51

60

61
62
63
64
65
66

poled peo

- 59 -

SUBTRACTION

ENTRY LSUB(QJ,QK)

a rieeeier 30,31,30
ay TAREE) 32,31,32
EXk=

TYPE (I) =4

VALUE (1) =VALUE(QJ) -VALUE(QK)
GO TO 60

ENTRY LSUBX(QJ,QK)

GO TO 31

ENTRY LSUBN(QJ,QK)
EX=-1

GO TO 32

MULTIPLICATION
ENTRY LMUL(QdJ,QK

“i 40,41,40
IP(ABS (VALUE QK))-1.) 42,41,42
EX=

TYPE(I)=5

VALUE (I) =VALUE(Qd) #VALUE(QK)
GO TO 60

ENTRY LMULX(QJ,QK)

GO TO 41

ENTRY LMULN(QJ,QK)

EX=-1

GO TO 42

DIVISION

ENTRY EDT (Qi ,0E)

IF(ABS (VALUE(QK))-1.) 51,50,51
EX=1

TYPE (I) =6

VALUE (I) =VALUE(QJ) /VALUE(QK)
GO TO 60

ENTRY LDIVX(QJ,QK)

GG T6 50

ENTRY LDIVN(QJ,QK)

EX=-1

G6 TO 51

OPER2(I) =QK
IF(VALUE(I)) 62,61,62
EX=EX+1

IF(EX) 64,64,63
TYPE(I)=-TYPE(I)

EX=0

OPER1(I)=aJ

QIsI

I=I+1

RETURN


===== PAGE 63 =====
L12

L16

L17

L18

L19
L20
L21

L22

aaa

aaa

102
-'0% COEFF(K)=0.

80

81

103

104

105

106
B82
83
84

90

91
92

- 60 -

COEFFICIENTS

ENTRY LEND(QN)

DO 80 K=1,™

COEFP(K) =0.
COEPF(QN) =1.

K=QN

ITYP=IABS (TYPE(K) )
K1=OPER1(
K2=0PER2(K
GO TO (83,102,103,104, 105,106) , TYP
COEFF(K1) =COERFF(K1) -CCEFF(z)

GO TO 83
Di=1.

D2=1.

GO T6 82
Di=1.
D2=-1.

GO TO 82
Teavinuntns!
D2=VALUE(K1
GO TO 82
Di=1./VALUE(K2)

D2=-VALUE(E1) /VALUE(K2) ##2
COEFF (K1)=COEFF(K1 ie
COEFF (K2) =COEFF(K2)+D2#COEFF(K
K=K-1

IF(K) 84,84,81

I=1

QI=0

RETURN

RELATIVE OR ABSOLUTE COEFFICIENTS

ENTRY LREL(COEFIC,M)
RES=VALUE(QN)

ASSIGN 91 TO iG

GO 76 90

ENTRY LABS (COEFIC,M)
ASSIGN 92 TO IG

CONTINUE

DIMENSION COEFIC(M)

DO 92 K=1,QN :
COEFIC(K) COEFF (K) #VALUE(K)
GO 76 IG,(91,92)
COEFIC(K)=CORPIC(K) /RES
CONTINUE

~QT=0

RETURN
END


===== PAGE 64 =====
= 61 =

KAYTETTYJA MERKINTOJA

merkinté selitys sivu

* pytristyssymboli, esim. z* = 2(1+e) 3
(> sarjan jdinnéstermi, sulkeissa sarjan 15

muuttujatyyppi ja pienin jadinnister-
missi esiintyvd asteluku, esim. <e*)

~ x-koordinaattien siirto: xX = x+M 46

& x-koordinaattien lavennus/supistus: 47
z= kx :

o polynomille p «; =x"a, 40

fr polynomille p fi =)x"a; 40

y polynomille p y: =)(N-j)x"a; 40

& mantissan absoluuttinen py6ristysvirhe 4

pytristivissd aritmetiikassa
mantissan absoluuttinen pyéristysvirhe 5
katkaisevassa aritmetiikassa
fe odotusarvo; }.:alkuarvon, U;:summan ja 8,9,11,
erotuksen, -,:tulon ja osam#iriin pyd- 12,16,18
ristysvirheen odotusarvo
fol keskihajonta; 0°: varianssi; 6%:alkuar- 8,9,11,
von, 6; :summan ja erotuksen, c;:tulon 12,16,18
ja osaméardn pytr.virheen varianssi

ful

bebe] satunnaismuuttujia 7,8,16,45

a polynomin p kerroin;matriisin A alkio; 39,52
(E,e)-sarjan kerroin 15

b kidytetyn aritmetiikan kantaluku 2

ce (R,e)-sarjan kerroin;matriisin A’alkio 20,55

D Qin derivaatta operandinsa suhteen, 20

esim. D = 2Q,(qi,qj)/2da: 3
kegkihejonta;D° “azapieneal,, esim D*(e) 8

a (Rgr)-sarjan.kerroin® asi e¥lPies (28
E kumulatiivinen!suhteellinen pyér.virhe; 15
odotusarvo, esim. E(e) 8
Bg )
n

(E,e)}=sarjan i:mnen asteen-termien 15
SU BRmmMa. ei


===== PAGE 65 =====
- 62 -

(E,e) (E,e)-sarja: muotoa E, =[a.e.+ sete
oleva Taylor-kehitelma
e ykeittiinen suhteellinen pyér.virhe,
esim. z* = 2(1+e)
f tiheysfunktio
i,j,k,1,m,n,¥ ' dndekseja
k x-koordinaattien lavennus/supistusker-
roin, vrt. "*"
M x-koordinastéien:etirron misré,
vrt.n7H
m liukuluvun mantissa
Pp liukuluvun eksponentti;
polynomi p = p(x) = a.x"+a,x"+...+8xy
Q laskutoimitus, esim. voi olla Q(a,Q=a-b
q algoritmin alkuarvo tai tulos
R kumulatiivinen absoluuttinen pyér.virhe
R° . (R,e)-sarjan i:nnen asteen termien
> summa
(R,e) (R,e)-sarja: tmuotoa R, = Jc.e.+...
“!eleva Paylor-kehitelmé —
(R,r) (R,r)-sarja: muotoa R = Lairite..
OLeva:Taylor—-kehitelma
r yksittdinen absoluuttinen pyér.virhe
t liukuluvun mantissan numeroiden 1lkm.
u vb
x piste, jossa polynomin p arvo lasketaan
Z liukuluku, z = m-bP;

polynomin nollakohta

15

47

46

39
19
19
19
20

20


===== PAGE 66 =====
= 63 =

VIITELUETTELO

[1]

(2]

13]

15]

16]

{7]

[8)

ke)

BabuSka, I., Numerical Stability in Mathe-
matical Analysis, Information Processing 68,
11-23, Amsterdam, 1969

Elfving, G., Todenndkéisyyslaskenta, II lu-
ku, Otava, Helsinki, 1966

Hamming, Numerical Methods for Scientifiste
and Engineers, luku 2, McGraw-Hill, New York,
1962

Henrici, P., Elements of Numerical Analysis,
luvut 15 ja 16, Wiley, New York, 1964

Henrici, P., Discrete Variable Methods in
Ordinary Differential Equations, Wiley, New
York, 1962 ,

Hull, f. E. ja Swenson, Jd. R., Tests of
Probabilistic Models for Propagation of Round-
off Brrors, Comm. ACM, vol.9, 108-113, 1966

Isaacsson, E. ja Keller, H. B., Analysis of
Numerical Methods, luvut 1 ja 2, Wiley, New
York, 1966

Knuth, D. E., The Art of Computer Programming,
vol.2, luku 4, Addison-Wesley, New York, 1969

Tienari, M., A Statistical Model of Roundoff
Errors in Varying Lenght Floating-point Arith-
metic, Helsinki, 1970

Wilkinson, J., Rounding Errors in Algebraic
Processes, Prentice Hall, Englewood Cliffs,
N.Jd., 1963
