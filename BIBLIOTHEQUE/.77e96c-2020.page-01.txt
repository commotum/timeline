                                                                        Solver-in-the-Loop: Learning from Differentiable
                                                                                Physics to Interact with Iterative PDE-Solvers
                                                                                               1,2                                             1                                                          3                                        1                                          1
                                                                    KiwonUm                                  RobertBrand                                  Yun(Raymond)Fei                                            Philipp Holl                             Nils Thuerey
                                                                            1Technical University of Munich, 2LTCI, Telecom Paris, IP Paris, 3Columbia University
                                                                                                            kiwon.um@telecom-paris.fr, robert.brand@tum.de
                                                                                               yf2320@columbia.edu,{philipp.holl, nils.thuerey}@tum.de
                                                                                                                                                                     Abstract
                                                                                    Finding accurate solutions to partial differential equations (PDEs) is a crucial
                                                                                    task in all scientiﬁc and engineering disciplines. It has recently been shown that
                                                                                    machine learning methods can improve the solution accuracy by correcting for
                                                                                    effects not captured by the discretized PDE. We target the problem of reducing
                                                                                    numericalerrorsofiterativePDEsolversandcomparedifferentlearningapproaches
                                                                                    for ﬁnding complex correction functions. We ﬁnd that previously used learning
                                                                                    approaches are signiﬁcantly outperformed by methods that integrate the solver
                                                                                    into the training loop and thereby allow the model to interact with the PDE during
                                                                                    training. This provides the model with realistic input distributions that take previous
                                                                                    corrections into account, yielding improvements in accuracy with stable rollouts of
                                                                                    several hundred recurrent evaluation steps and surpassing even tailored supervised
                                                                                    variants. We highlight the performance of the differentiable physics networks
                                                                                    for a wide variety of PDEs, from non-linear advection-diffusion systems to three-
                                                                                    dimensional Navier-Stokes ﬂows.
                                                               1          Introduction
                                                               Numerical methods are prevalent in science to improve the understanding of our world, with applica-
                                                               tions ranging from climate modeling [55, 53] over simulating the efﬁciency of airplane wings [47] to
                                                               analyzing blood ﬂow in a human body [27]. These applications are extremely costly to compute due
                                                               34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.
                                                                                          t=0                                             t=75                                         t=140                                          t=200
                                                                 (a) Simulation 
                                                                        Only
                                                                                                                                                                                                                                                        MAE w.r.t. reference: 0.167
                                                                                          t=0                                             t=75                                         t=140                                          t=200
                                                                 (b) Simulation 
                                                                 With Learned 
                                                                    Correction
                                                                                                                                                                                                                                                        MAE w.r.t. reference: 0.130
                                                                                                                                                                                                                                                                                      0.8
                                                                                          t=0                                             t=75                                         t=140                                          t=200
                                                                 (c) Reference 
                                                                   Simulation                                                                                                                                                                                                         0.4
                                                                                                                                                                                                                                                                                      0.0
                                                               Figure 1: A 3D ﬂuid problem (shown in terms of vorticity) for which the regular simulation introduces
                                                               numerical errors that deteriorate the resolved dynamics (a). Combining the same solver with a learned
                                                               corrector trained via differentiable physics (b) signiﬁcantly reduces errors w.r.t. the reference (c).
