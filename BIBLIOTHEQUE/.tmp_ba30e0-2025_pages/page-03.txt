                                                                                                                                                              T
                            Training Set                            Test Set                                      there also exists a demo set D                   , and the pairs (x,y) in
                                                                                                                                                              demo
                             Task 1              Task 400
                                                                                         Task 400
                                                                     Task 1                                       DT       are given to the model at inference time. The model
                                                                                                                    demo
                                                                                                                  should make use of DT                  to infer the output of the given
                                                                                                                                                  demo
                                                                                                                  xinfer for this new task.
                                              ......                                 ......                           The presence of new (x,y) pairs in DT                          at inference
                                                                                                                                                                              demo
                                                                                                                  time allows to perform test-time training [49, 1, 9, 24],
                                                                                                                  which we adopt and will discuss.
                     Figure 3. The ARC problem definition. ARC is a collection of                                 3.2. Image-to-Image Translation
                     manydifferenttasks. Foreachtask,afew(e.g.,2-4)demonstration                                  Withthesedefinitions, we formulate reasoning on each task
                     pairs (x,y) are given, and the model is required to infer the output                         as an image-to-image translation problem. We frame the
                     fromx        . ThetrainingsetT            is a collection of 400 tasks, which
                              infer                       train                                                   problemasper-pixelclassification, analogous to the seman-
                     can be used for model training. The test set T                contains 400 new
                                                                               test
                     tasks: the demo pairs of a new task are given only at inference                              tic segmentation problem [38].
                     time, based on which the model performs inference on x                       .                   Formally, welearnaneuralnetworkf parameterizedby
                                                                                              infer                                                                        θ
                                                                                                                  θ. The network f takes an image x as input, conditioned
                                                                                                                                           θ                          i
                     able to satisfy the ARC protocol, whose essence lies pre-                                    on a task token associated with the task T. The task token
                     cisely in few-shot, cross-task generalization. Unlike [34],                                  is represented as a learnable embedding dependent on T.
                     our framework is designed to address the “few-shot, many-                                    The output of fθ is a grid where each position represents
                     task” nature of ARC.                                                                         a categorical distribution. The overall objective function is
                                                                                                                  simply the per-pixel cross-entropy loss [38]:
                     3. ARCasaVisionProblem                                                                                                                                     
                                                                                                                                    L(θ) = E           D(y , f (x | T)) .                         (1)
                                                                                                                                                  T,i        i    θ    i
                     3.1. ARC Problem Definition                                                                  Here, D denotes the per-pixel cross-entropy loss between
                     TheARCbenchmarkconsistsofseveral hundred very few-                                           the ground-truth y and the network output.
                     shot (e.g., 2 to 4-shot) reasoning tasks. Each task, denoted                                                          i
                     by T, involves a unique underlying transformation rule,                                      3.3. Visual Modeling
                     mapping from an input x to an output y. Here, x and y are                                    Previous methods on ARC generally operate in the space of
                     both 2D grids with maximum size 30×30, in which each                                         discrete-valued tokens, motivated by the design of language
                     location has one of C different color indexes (e.g., C=10).                                  models. In our formulation of image-to-image translation,
                     The ARC problem definition is illustrated in Fig. 3, which                                   weexplore native designs developed for vision.
                     wediscuss next.                                                                              Canvas. While it is straightforward to view the raw H×W
                     Atask. A “task” is the basic unit in ARC. Each task in-                                      grid as an H×W image, weproposemoreflexibletransfor-
                     cludes a few demonstration examples. For a demonstration                                     mationstorepresentitinamannersimilartonaturalimages.
                     pair (x,y), both x and y are known to the model. We denote
                     the demonstration set of task T as: DT                       =(x ,y )	m ,                       We define the concept of a “canvas”. A canvas has a
                                                                             demo          i   i    i=1           predefined and sufficiently large size, e.g., 64×64. The raw
                     where m is the number of pairs (e.g., m is 2 to 4). Each                                     input is transformed and placed onto this canvas. This for-
                     task T also contains a few inference examples, denoted as:
                                           	                                                                     mulationnaturallyaccommodatestranslationandscaleaug-
                     DT = (x ,y ) n                 (n is 1 or 2). At inference time, only
                        infer        i    i   i=1                                                                 mentations, which are common strategies for introducing
                     the demopairs DT               andoneinputx                ∈DT aregiven,
                                              demo                        infer       infer                       translation and scale invariance in vision, discussed next.
                     and the model is required to infer the desired output y                          .
                                                                                                  infer           Weset the background of the canvas to an additional back-
                     Training set. The training set consists of multiple tasks                                    ground color, i.e., the (C+1)-th color.
                     used to train the model offline (i.e., before a new task is                                      When applying a ViT model (discussed next), if we
                                                                                          k
                     given). Wedenotethetrainingsetas: T                         ={T }         , where               ¨
                                                                            train      i i=1                      naıvely treat each raw pixel as a token, there would be only
                     k is the number of tasks (400 in ARC-1). Following stan-                                     C distinct tokens. In contrast, our canvas formulation sup-
                     dard machine learning protocols, samples in DT                            for any            ports a much larger set of local, patch-level configurations.
                                                                                         demo
                     T ∈Ttrain can be used for training. The “inference” samples                                  For example, with a patch size of 2×2 (see Fig. 5), a single
                     in the training set, that is, DT              for any task T ∈ T              , are          patch can contain multiple colors and, in principle, has an
                                                              infer                            train
                     used for validating the training process only.                                               exponentially large cardinality, O(C2×2). This formulation
                     Test set. The test set is a collection of new tasks, which are                               is important for improving generalization performance.
                     not seen during offline training. We denote the test set as:                                 Translation and scale invariance. The “canvas” concept
                                    l
                     Ttest={Ti}          , with l different test tasks. Note that any test                        enables us to flexibly apply translation and scale augmen-
                                    i=1
                     task is a “complete” and new task: that is, for any T ∈ T                           ,        tations, which are critical in standard vision models. The-
                                                                                                     test
                                                                                                             3
