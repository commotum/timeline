                                                                                                                                                                                                                                                                                                                 Point Primitive Transformer                                                                                                       7
                                                                                                                            ure 4. On the lower level, short-term spatial-temporal features are extracted
                                                                                                                            through an intra-primitive point transformer. The intra-primitive point trans-
                                                                                                                            former restricts the communication of points within each primitive plane. This
                                                                                                                            design shares a similar flavor with GLOM [19] encouraging aligned features to
                                                                                                                            talk. Also due to the local spatial support, it is more friendly to optimization
                                                                                                                            compared with a global transformer. On the upper level, long-term spatial-
                                                                                                                            temporal features are extracted through a primitive transformer. This is done
                                                                                                                            by jointly analyzing short-term features from the lower level and a memory pool
                                                                                                                            storing pre-computed primitive features from a long video. Pre-computed primi-
                                                                                                                            tive features allow aggregating long-term spatial-temporal context ef√èciently and
                                                                                                                            effectively. PPTr is very flexible for both point-wise and sequence-wise inference
                                                                                                                            by simply changing the task head.
                                                                                                                                                                                                                 semanticlabels                                                                                                         class
                                                                                                                                                                                                                             MLP                                                                                                         MLP
                                                                                                                                                                               frameÌ†µ„åµ                               Concatenate                                                                                                    Max Pool
                                                                                                                                                                                                                                                                 Primitive Transformer
                                                                                                                                                                                                                                                                                                    ‚Ä¶                                                                                ‚Ä¶
                                                                                                                                                                                                                        Max Pool                                                                                                                                Memory Pool
                                                                                                                                                                                                                   Intra-Primitive                                                                                                   Max Pool
                                                                                                                                                                                                              Point Transformer                                                                                                  3DBackbone
                                                                                                                                                                                                                    4DBackbone
                                                                                                                                                                                                                 Primitive Fitting                                                                                            Primitive Fitting
                                                                                                                                                                                                            ‚Ä¶ Ì†µ„åµ‚àíÌ†µ„åµ             Ì†µ„åµ     Ì†µ„åµ + Ì†µ„åµ   ‚Ä¶                                                           ‚Ä¶                                                             ‚Ä¶
                                                                                                                                                                                                                 Short video clip                                       Online               Offline                Long-rangevideoframes
                                                                                                                            Fig.4. Pipeline. The backbone consists of two branches: online network and of√íine
                                                                                                                            pre-computation. 1.Online Branch. The input to network is a short video clip. After
                                                                                                                            primitive fitting, points are tagged with primitive label, then 4D Backbone is applied
                                                                                                                            and generates per-point features. In the intra-primitive point transformer, points fea-
                                                                                                                            tures are enhanced by adapatively adding information from other points inside prim-
                                                                                                                            itive. Then generate primitive-level representations by maxpooling. In the primitive
                                                                                                                            transformer, clip primitive embeddings(green) perform self-attention with long-term
                                                                                                                            embeddings(yellow) in the memory pool. For semantic segmentation, primitive fea-
                                                                                                                            tures are concatenated to corresponding point features then classified into semantic
                                                                                                                            labels. For action recognition, primitive features are merged by maxpooling to a global
                                                                                                                            feature then classified into actions. 2.Of√íine Branch. This branch essentially com-
                                                                                                                            putes primitive level representations of the long-range videos and maintains a memory
                                                                                                                            pool in an of√íine manner. After primitive fitting, points are fed to a pre-trained 3D
                                                                                                                            backbone. Then maxpool is applied to every primitive region generating primitive-level
                                                                                                                            embeddings in the memory pool.
