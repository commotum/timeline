                           This model performs signiﬁcantly better than the sequence-to-sequence model on the convex hull
                           problem, but it is not applicable to problems where the output dictionary size depends on the input.
                           Nevertheless, a very simple extension (or rather reduction) of the model allows us to do this easily.
                           2.3  Ptr-Net
                           We now describe a very simple modiﬁcation of the attention model that allows us to apply the
                           method to solve combinatorial optimization problems where the output dictionary size depends on
                           the number of elements in the input sequence.
                           Thesequence-to-sequencemodelofSection2.1usesasoftmaxdistributionoveraﬁxedsizedoutput
                           dictionarytocomputep(Ci|C1,...,Ci−1,P)inEquation1. Thusitcannotbeusedforourproblems
                           where the size of the output dictionary is equal to the length of the input sequence. To solve this
                           problem we model p(C |C ,...,C       , P) using the attention mechanism of Equation 3 as follows:
                                                 i  1        i−1
                                                             i        T
                                                            u    = v tanh(W e +W d ) j ∈(1,...,n)
                                                             j                  1 j      2 i
                                                                               i
                                        p(Ci|C1,...,Ci−1,P)      = softmax(u )
                                                                i
                           wheresoftmaxnormalizesthevectoru (oflengthn)tobeanoutputdistributionoverthedictionary
                           of inputs, and v, W , and W are learnable parameters of the output model. Here, we do not blend
                                             1        2
                                                                                                              i
                           the encoder state e to propagate extra information to the decoder, but instead, use u as pointers
                                             j                                                                j
                           to the input elements. In a similar way, to condition on Ci−1 as in Equation 1, we simply copy
                           the corresponding PCi−1 as the input. Both our method and the attention model can be seen as an
                           application of content-based attention mechanisms proposed in [6, 5, 2].
                           Wealso note that our approach speciﬁcally targets problems whose outputs are discrete and corre-
                           spondtopositions in the input. Such problems may be addressed artiﬁcially – for example we could
                           learn to output the coordinates of the target point directly using an RNN. However, at inference,
                           this solution does not respect the constraint that the outputs map back to the inputs exactly. With-
                           out the constraints, the predictions are bound to become blurry over longer sequences as shown in
                           sequence-to-sequence models for videos [12].
                           3   Motivation and Datasets Structure
                           In the following sections, we review each of the three problems we considered, as well as our data
                                              1
                           generation protocol.
                           In the training data, the inputs are planar point sets P = {P1,...,Pn} with n elements each, where
                           P =(x ,y )arethecartesiancoordinatesofthepointsoverwhichweﬁndtheconvexhull,theDe-
                            j      j  j
                           launay triangulation or the solution to the corresponding Travelling Salesman Problem. In all cases,
                           we sample from a uniform distribution in [0,1] × [0,1]. The outputs CP = {C1,...,Cm(P)} are
                           sequences representing the solution associated to the point set P. In Figure 2, we ﬁnd an illustration
                           of an input/output pair (P,CP) for the convex hull and the Delaunay problems.
                           3.1  ConvexHull
                           Weusedthisexampleasabaselinetodevelopourmodelsandtounderstandthedifﬁcultyofsolving
                           combinatorial problems with data driven approaches. Finding the convex hull of a ﬁnite number
                           of points is a well understood task in computational geometry, and there are several exact solutions
                           available (see [13, 14, 15]). In general, ﬁnding the (generally unique) solution has complexity
                           O(nlogn),wherenisthenumberofpointsconsidered.
                           The vectors P are uniformly sampled from [0,1] × [0,1]. The elements C are indices between 1
                                        j                                                           i
                           andncorrespondingtopositionsinthesequenceP,orspecialtokensrepresentingbeginningorend
                           of sequence. See Figure 2 (a) for an illustration. To represent the output as a sequence, we start
                           fromthepointwiththelowestindex,andgocounter-clockwise–thisisanarbitrarychoicebuthelps
                           reducing ambiguities during training.
                              1Werelease all the datasets at http://goo.gl/NDcOIG.
                                                                          4
