                              Model           No Aug. Scoring           Scoring with 8 augmentations
                                             Best 2    Similarity   Best    Worst Sum of      Sum of    Time
                                             Scores    Selection    Prob    Prob    Probs      logp    [mm:ss]
                              Llama-rearc    51.00       51.25     48.38    51.63    48.75     54.5     37:31
                              Llama-mix       51.5        57.0      57.0     62.0    57.5      63.5      9:50
                              Nemo-mix        60.5        66.0      66.0     65.5    65.0      72.5     17:05
                            Table 6: Comparison of different selection strategies using 8 augmentations for each can-
                            didate (full evaluation set for Llama-rearc, 100 split-off tasks otherwise). Selecting the
                            candidate with the highest summed log-prob (or alternatively product of probabilities)
                            results in an increase of around 25% over baseline, while only requiring and additional
                            10-17 minutes on an H100 per 100 tasks. We also compare some alternative aggregation
                            methods. The aggregations compared are: ’best prob’ (max(P)), worst prob (min(P)),
                                          P                          Q
                            sum of probs (   P) and sum of log prob (  P) which we use.
                            using no more than two guesses.
                            Recall that any (decoder-only) large language model M also provides us with
                            probabilities for each input token. Given a task C and a solution candidate
                            S , the model can calculate a probability PM(S |C), which represents how
                              k                                                   k
                            likely it is that the model would generate S          when provided with C us-
                                                                                k
                            ing standard sampling. At first glance, using this probability for selection
                            might seem redundant, as it appears that it would just result in selecting
                            the solution with the highest sampling probability – something that could
                            be achieved more directly by simply sampling.
                            Instead, we leverage our augmentation techniques.            As the network was
                            trained using augmentations, it stands to reason that a correct solution
                            should demonstrate greater stability in its sampling probability under aug-
                            mented conditions compared to an incorrect one.
                            Wetherefore calculate the augmented probabilities:
                                                      Paug(S ) = P (T (S )|T (C))
                                                       i      k      M i k i
                            for augmentations T ,...,T . Our results always use D symmetry aug-
                                                   1        n                                8
                            mentations and optionally color permutations and example shufÒing. Using
                            these 8 augmentations for scoring, we observed that taking the product of
                            the probabilities (or alternatively, summing the logsoftmax values) led to a
                            highly stable and effective selection strategy. Our selection strategy can be
                            summarized as:
                                                           argmaxYPaug(Sk)
                                                                         i
                                                               k     i
                                                                     14
