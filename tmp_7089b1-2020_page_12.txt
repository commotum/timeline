          A
          B
            arch(h)                pyramid(h)
          wall(w,h)               bridge(w,h)
          C                      D
       Figure 5: (A) 21 (out of 107) tower building tasks. The model writes a program controlling a ‘hand’
       that builds the target tower. (B) Four learned library routines. These components act like parametric
       options (31), giving human-understandable, higher-level building blocks that the system can use to
       plan. Dreams both before and after learning (C-D) show representative plans the system can imagine
       building. After 20 wake-sleep iterations (D) the model fantasizes complex structures it has not seen
       during waking, but that combine building motifs abstracted from solved tasks in order to provide
       training data for a robust neural recognition model. Dreams are selected from ﬁve different runs;
       Fig. S7 shows 150 random dreams at each stage.
                                12
